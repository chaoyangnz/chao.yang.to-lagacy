<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Richard Yang, Java Developer, Senior software engineer" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="Nothing seek, nothing find">
<meta property="og:type" content="website">
<meta property="og:title" content="Richard Yang">
<meta property="og:url" content="https://richyang.me/page/8/index.html">
<meta property="og:site_name" content="Richard Yang">
<meta property="og:description" content="Nothing seek, nothing find">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Richard Yang">
<meta name="twitter:description" content="Nothing seek, nothing find">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    },
    algolia: {
      applicationID: 'X0H1P7HDKY',
      apiKey: 'ddc0af00a6e07c9b1be9f4da4cf5b9d9',
      indexName: 'richyang.me',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>




  <title> Richard Yang </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <!--span class="logo-line-before"><i></i></span-->
      <span class="site-title">Richard Yang</span>
      <!--span class="logo-line-after"><i></i></span-->
    </a>
  </div>
  <p class="site-subtitle">Full-stack software engineer mainly focusing on Java-based technologies and web front-end</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            Home
          </a>
        </li>
        
      
        
        
        <li class="menu-item menu-item-books">
          <a href="https://www.gitbook.com/@richdyang" rel="section">
            
            Books
          </a>
        </li>
        
      
        
        
        <li class="menu-item menu-item-showcase">
          <a href="/showcase" rel="section">
            
            Showcase
          </a>
        </li>
        
      
        
        
        <li class="menu-item menu-item-resume">
          <a href="http://linkedin.com/in/richdyang" rel="section">
            
            Résumé
          </a>
        </li>
        
      
        
        
      
        
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
            About
          </a>
        </li>
        
      
        
        
      
        
        
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
            <i class="menu-item-icon fa fa-search fa-lg"></i>Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>

<div class="social-links" style="float: right; padding-left: 50px; margin-right: 10px">
      
        
          <span class="links-of-author-item">
            <a href="http://linkedin.com/in/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-linkedin"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://github.com/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-github-alt"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://bitbucket.org/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-bitbucket"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://stackoverflow.com/users/4344443/richard" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-stack-overflow"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://twitter.com/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-twitter"></i>
                </span>
                 
              
            </a>
          </span>
        
      
  </div>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/02/10/jpa-runtime/" itemprop="url">
                  JPA - runtime
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-02-10T03:51:29+08:00" content="2015-02-10">
              2015-02-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JPA/" itemprop="url" rel="index">
                    <span itemprop="name">JPA</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JPA/Transaction-Management/" itemprop="url" rel="index">
                    <span itemprop="name">Transaction Management</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/02/10/jpa-runtime/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/02/10/jpa-runtime/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Core-concepts"><a href="#Core-concepts" class="headerlink" title="Core concepts"></a>Core concepts</h3><table border="2" frame="hsides" rules="groups" cellspacing="0" cellpadding="6"><br><thead><br><tr><br><th class="left" scope="col">org.hibernate</th><br><th class="left" scope="col">javax.persistence</th><br><th class="left" scope="col">说明</th><br></tr><br></thead><br><tbody><br><tr><br><td class="left">cfg.Configuration</td><br><td class="left">PersistenceUnit</td><br><td class="left">读取配置信息</td><br></tr><br><tr><br><td class="left">SessionFactory</td><br><td class="left">EntityManagerFactory</td><br><td class="left">用于创建会话/实体管理器的工厂类</td><br></tr><br><tr><br><td class="left">Session</td><br><td class="left">EntityManager</td><br><td class="left">提供实体操作API，管理事务，创建查询</td><br></tr><br><tr><br><td class="left">Transaction</td><br><td class="left">EntityTransaction</td><br><td class="left">管理事务</td><br></tr><br><tr><br><td class="left">Query</td><br><td class="left">Query</td><br><td class="left">执行查询Here’s a quick cheat sheet of the JPA world:</td><br></tr><br></tbody><br></table>

<ul>
<li>A <strong>Cache</strong> is a <strong>copy of data</strong>, copy meaning pulled from but living outside the database.</li>
<li><strong>Flushing</strong> a Cache is the act of putting modified data back into the database.</li>
<li>A <strong>PersistenceContext</strong> is essentially a Cache. It also tends to have it’s own non-shared database connection.</li>
<li>An <strong>EntityManager</strong> represents a PersistenceContext (and therefore a Cache)</li>
<li>An <strong>EntityManagerFactory</strong> creates an EntityManager (and therefore a PersistenceContext/Cache)<blockquote>
<p><strong>Cache == PersistenceContext</strong></p>
</blockquote>
</li>
</ul>
<h3 id="Entity-Manager"><a href="#Entity-Manager" class="headerlink" title="Entity Manager"></a>Entity Manager</h3><p>A persistence unit is a named configuration of entity classes.</p>
<p>A persistence context is a  managed set of entity instances.</p>
<p>An <code>EntityManager</code> instance is associated with a persistence context.</p>
<p>Saying that an entity is <em>managed</em> meas that it’s contained within a persistence context and it can be acted upon by an entity manager.</p>
<ul>
<li>An <code>EntityManagerFactory</code> is an expensive-to-create, threadsafe object intended to be shared by all application threads.</li>
<li>An <code>EntityManager</code> is an inexpensive, non-threadsafe object that should be used once, for a single business process, a single unit of work, and then discarded</li>
</ul>
<h4 id="Container-managed-entity-manager"><a href="#Container-managed-entity-manager" class="headerlink" title="Container-managed entity manager"></a>Container-managed entity manager</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@PersistenceContext</span>(unitName=<span class="string">"EmployeeService"</span>)</div><div class="line"><span class="keyword">private</span> EntityManager em;</div></pre></td></tr></table></figure>
<p>It can be injected by using the @PersistenceContext, and you don’t create or manage the lifecycle of the entity manager. This type of entity manager is typically used in Java EE environment.</p>
<blockquote>
<p>NOTICE: if you use Spring-orm for JPA integration, this @PersistenceContext is also supported by Spring bean context.<br><a id="d0e129"></a>A container-managed entity manger requires the use of a JTA transaction.</p>
</blockquote>
<p>a. Transaction-scoped<br>It depends on JTA transaction, it use the transaction to trace persistence context.<br>Every time when an operation is invoked on entity manager, the proxy of the persitence manager checks to see whether a persistence is associated with the container JTA transaction. If yes, just use it. If not, it creates a new persistence context and associates it with the transaction. When the transaction ends, the persistence context goes away.</p>
<p>b. Extended<br>Specially designed for stateful bean, the persistence context of extended persistence manager lasts until the end of conversation instead of transaction.</p>
<h4 id="Application-managed-entity-manager"><a href="#Application-managed-entity-manager" class="headerlink" title="Application-managed entity manager"></a>Application-managed entity manager</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">EntityManagerFactory emf = Persistence.createEntityManagerFactory(<span class="string">"EmployeeService"</span>);</div><div class="line">EntityManager em = emf.createEntityManager();</div></pre></td></tr></table></figure>
<p>You can control the entity manager in your application, including its creating, closing, transaction etc. This type of entity manager is typically used in J2SE or some non-EJB Java EE environment.</p>
<p>The best way to create an entity manager is to use the @PersistenceUnit<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@PersistenceUnit</span>(unitName=<span class="string">"EmpoyeeService"</span>)</div><div class="line"><span class="keyword">private</span> EntityManagerFactory emf;</div></pre></td></tr></table></figure></p>
<p>When the application-managed entity manager is created, it creates its own private persistence context that lasts until the entity manager is closed.</p>
<p><a id="d0e134"></a> An application managed entity manager can be either involved in the current JTA transaction (a JTA entity manager), or the transaction may be controlled through the <code>EntityTransaction</code> API (a resource-local entity manager).</p>
<h3 id="Entity-states-and-operations"><a href="#Entity-states-and-operations" class="headerlink" title="Entity states and operations"></a>Entity states and operations</h3><p><img src="/media/entity-states.png" alt="entity states"></p>
<h3 id="Transaction-management"><a href="#Transaction-management" class="headerlink" title="Transaction management"></a>Transaction management</h3><p>two transaction management types:</p>
<p>1) <strong>resource-local</strong>: using the native transaction of the JDBC driver</p>
<p>2) <strong>JTA</strong>: Jave EE server, supporting multiple participating resources, transaction lifecycle management, and distributed XA transactions. Also know as global transaction.</p>
<h4 id="Query-Language"><a href="#Query-Language" class="headerlink" title="Query Language"></a>Query Language</h4><p>### </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/02/06/jpa-mapping/" itemprop="url">
                  JPA - mapping
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-02-06T02:52:11+08:00" content="2015-02-06">
              2015-02-06
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JPA/" itemprop="url" rel="index">
                    <span itemprop="name">JPA</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/02/06/jpa-mapping/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/02/06/jpa-mapping/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Table-mapping"><a href="#Table-mapping" class="headerlink" title="Table mapping"></a>Table mapping</h3><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@Entity</span></div><div class="line"><span class="meta">@Table</span>(name=<span class="string">"EMP"</span>, schema=<span class="string">"scott"</span>)</div></pre></td></tr></table></figure>
<h3 id="Basic-mapping"><a href="#Basic-mapping" class="headerlink" title="Basic mapping"></a>Basic mapping</h3><p><table border="1" cellspacing="0" cellpadding="0"></table></p>
<p><tbody></tbody></p>
<p><tr></tr></p>
<p><td>Java type</td></p>
<p><td>Database type</td><br></p>
<p><tr></tr></p>
<p><td>String (char, char[])</td></p>
<p><td>VARCHAR (CHAR, VARCHAR2, CLOB, TEXT)</td><br></p>
<p><tr></tr></p>
<p><td>Number (BigDecimal, BigInteger, Integer, Double, Long, Float, Short, Byte)</td></p>
<p><td>NUMERIC (NUMBER, INT, LONG, FLOAT, DOUBLE)</td><br></p>
<p><tr></tr></p>
<p><td>int, long, float, double, short, byte</td></p>
<p><td>NUMERIC (NUMBER, INT, LONG, FLOAT, DOUBLE)</td><br></p>
<p><tr></tr></p>
<p><td>byte[]</td></p>
<p><td>VARBINARY (BINARY, BLOB)</td><br></p>
<p><tr></tr></p>
<p><td>boolean (Boolean)</td></p>
<p><td>BOOLEAN (BIT, SMALLINT, INT, NUMBER)</td><br></p>
<p><tr></tr></p>
<p><td>java.util.Date</td></p>
<p><td>TIMESTAMP (DATE, DATETIME)</td><br></p>
<p><tr></tr></p>
<p><td>java.sql.Date</td></p>
<p><td>DATE (TIMESTAMP, DATETIME)</td><br></p>
<p><tr></tr></p>
<p><td>java.sql.Time</td></p>
<p><td>TIME (TIMESTAMP, DATETIME)</td><br></p>
<p><tr></tr></p>
<p><td>java.sql.Timestamp</td></p>
<p><td>TIMESTAMP (DATETIME, DATE)</td><br></p>
<p><tr></tr></p>
<p><td>java.util.Calendar</td></p>
<p><td>TIMESTAMP (DATETIME, DATE)</td><br></p>
<p><tr></tr></p>
<p><td>java.lang.Enum</td></p>
<p><td>NUMERIC (VARCHAR, CHAR)</td><br></p>
<p><tr></tr></p>
<p><td>java.util.Serializable</td></p>
<p><td>VARBINARY (BINARY, BLOB)</td><br><br><br><br><em><strong>@Basic</strong></em> annotation is optional.  Any attributes that have no other annotations and do not reference other entities will be automatically mapped as basic, and even serialized if not a basic type. This is auto-mapping.</p>
<p>customize the default mapping</p>
<h4 id="lazy-fetching"><a href="#lazy-fetching" class="headerlink" title="lazy fetching"></a>lazy fetching</h4><p>@Basic can specify the lazy fetching mode.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@Basic</span>(fetch=FetchType.LAZY)</div></pre></td></tr></table></figure></p>
<h4 id="specify-the-column-name-Column"><a href="#specify-the-column-name-Column" class="headerlink" title="specify the column name - @Column"></a>specify the column name - @Column</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@Column</span>(name=<span class="string">"ADDR"</span>)</div></pre></td></tr></table></figure>
<h4 id="large-object-Lob"><a href="#large-object-Lob" class="headerlink" title="large object - @Lob"></a>large object - @Lob</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@Lob</span></div></pre></td></tr></table></figure>
<h4 id="temporal-types-for-java-util-Date-and-java-util-Calendar-Temporal"><a href="#temporal-types-for-java-util-Date-and-java-util-Calendar-Temporal" class="headerlink" title="temporal types for java.util.Date and java.util.Calendar - @Temporal"></a>temporal types for java.util.Date and java.util.Calendar - @Temporal</h4><p>If you just want to map DATE, TIME, TIMESTAMP to java.sql.Date, java.sql.Time, java.sql.Timestamp, the basic mapping is just OK.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@Temporal</span>(TemporalType.DATE)</div><div class="line"><span class="keyword">private</span> Calendar dob;</div></pre></td></tr></table></figure></p>
<h4 id="transient-state-Transient"><a href="#transient-state-Transient" class="headerlink" title="transient state - @Transient"></a>transient state - @Transient</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">transit <span class="keyword">private</span> String s;</div><div class="line"></div><div class="line"><span class="meta">@Transient</span> <span class="keyword">private</span> String s;</div></pre></td></tr></table></figure>
<h4 id="enums-Enumerated"><a href="#enums-Enumerated" class="headerlink" title="enums - @Enumerated"></a>enums - @Enumerated</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@Basic</span></div><div class="line"><span class="meta">@Enumerated</span>(EnumType.STRING)</div><div class="line"><span class="keyword">private</span> Gender gender;</div></pre></td></tr></table></figure>
<h3 id="primary-Key"><a href="#primary-Key" class="headerlink" title="primary Key"></a>primary Key</h3><ul>
<li>primitive type: byte, int, short, long, char, (float, double)</li>
<li>wrapper classes of primitives: Byte, Integer, Short, Long, Character, (Float, Double)</li>
<li>string: String</li>
<li>large numeric type: java.math.BigInteger, (java.math.BigDecimal)</li>
<li>temporal type: java.sql.Date, java.util.Date<br><em>WARNING: using floating types for primary keys is risky endevour and is not recommended.</em></li>
</ul>
<p>there are 4 types of identity generation.</p>
<h4 id="Automatic"><a href="#Automatic" class="headerlink" title="Automatic"></a>Automatic</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@Id</span> <span class="meta">@GeneratedValue</span>(strategy=GenerationType.AUTO)</div><div class="line"><span class="keyword">private</span> <span class="keyword">long</span> id;</div></pre></td></tr></table></figure>
<p>The provider can choose table-based strategy or sequence-based strategy. This strategy may need schema generation and is a choice for development or prototyping. It’s not recommended for other cases. You should always specify the other three strategies.</p>
<h4 id="Table"><a href="#Table" class="headerlink" title="Table"></a>Table</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@Id</span> <span class="meta">@GeneratedValue</span>(stategy=GenerationType.TABLE)</div><div class="line"><span class="keyword">private</span> <span class="keyword">long</span> id;</div></pre></td></tr></table></figure>
<p>This will use the default table assumed by the provider. So it’s better to declare more detailed generator by giving the specified table.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@TableGenerator</span>(name=<span class="string">"Emp_Gen"</span>, table=<span class="string">"ID_GEN"</span>, pkColumnName=<span class="string">"GEN_NAME"</span>, valueColumnName=<span class="string">"GEN_VAL"</span>, pkColumnValue=<span class="string">"Emp_Gen"</span>, initialValue=<span class="number">1000</span>, allocationSize=<span class="number">100000</span>)</div><div class="line"><span class="meta">@Id</span> <span class="meta">@GeneratedValue</span>(generator=<span class="string">"Emp_Gen"</span>)</div><div class="line"><span class="keyword">private</span> <span class="keyword">long</span> id;</div></pre></td></tr></table></figure></p>
<h4 id="Sequence"><a href="#Sequence" class="headerlink" title="Sequence"></a>Sequence</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@Id</span> <span class="meta">@GeneratedValue</span>(strategy=GenerationType.SEQUENCE)</div><div class="line"><span class="keyword">private</span> <span class="keyword">long</span> id;</div></pre></td></tr></table></figure>
<p>This will also use the default sequence assumed by the provider. But a problem is that this default sequence will be shared by different entity.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@SequenceGenerator</span>(name=<span class="string">"Emp_Gen"</span>, sequenceName=<span class="string">"Emp_Seq"</span>, initialValue=<span class="number">1</span>, allocationSize=<span class="number">10000</span>)</div><div class="line"><span class="meta">@Id</span> <span class="meta">@GeneratedValue</span>(generator=<span class="string">"Emp_Gen"</span>)</div><div class="line"><span class="keyword">private</span> <span class="keyword">long</span> id;</div></pre></td></tr></table></figure></p>
<p>It depends on whether you enable the schema generation. If no, the sequence must already exist; If yes, the SQL to create the sequence is run by the provider.</p>
<h4 id="Identity"><a href="#Identity" class="headerlink" title="Identity"></a>Identity</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@Id</span> <span class="meta">@GeneratedValue</span>(strategy=GenerationType.IDENTITY)</div><div class="line"><span class="keyword">private</span> <span class="keyword">long</span> id;</div></pre></td></tr></table></figure>
<p>Identity column is supported by some databases. Using this mode means the identifier is not available until after commit time.</p>
<h3 id="Relationship"><a href="#Relationship" class="headerlink" title="Relationship"></a>Relationship</h3><p><table border="2" frame="hsides" rules="groups" cellspacing="0" cellpadding="6"></table></p>
<p><thead></thead></p>
<p><tr></tr></p>
<p><th class="left" scope="col">Relationship</th></p>
<p><th class="left" scope="col">Owning-Side</th></p>
<p><th class="left" scope="col">Inverse-Side</th><br><br></p>
<p><tbody></tbody></p>
<p><tr></tr></p>
<p><td class="left">one-to-one</td></p>
<p><td class="left">@OneToOne</td></p>
<p><td class="left">@OneToOne(mappedBy=”othersideName”)</td><br></p>
<p><tr></tr></p>
<p><td class="left">one-to-many / many-to-one</td></p>
<p><td class="left">@ManyToOne</td></p>
<p><td class="left">@OneToMany(mappedBy=”othersideName”)</td><br></p>
<p><tr></tr></p>
<p><td class="left">many-to-many</td></p>
<p><td class="left">@ManyToMany</td></p>
<p><td class="left">@ManyToMany(mappedBy =”xxx”)</td><br><br><br><br>For many-to-many mapping, you can using join table to declare the many-to-many relationship<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@ManyToMany</span></div><div class="line"><span class="meta">@JoinTable</span>(name = <span class="string">"BOOK_AUTHOR"</span>, </div><div class="line">joinColumns = &#123; <span class="meta">@JoinColumn</span>(name = <span class="string">"BOOK_ID"</span>, referencedColumnName = <span class="string">"id"</span>) &#125;, </div><div class="line">inverseJoinColumns = &#123; <span class="meta">@JoinColumn</span>(name = <span class="string">"AUTHORID"</span>, referencedColumnName = <span class="string">"id"</span>) &#125;)</div></pre></td></tr></table></figure></p>
<p>The three relationships can use <span style="text-decoration: underline;"><em>fetch=FetchType.LAZY</em></span>.</p>
<h3 id="Inheritance"><a href="#Inheritance" class="headerlink" title="Inheritance"></a>Inheritance</h3><p>JPA通过在父类增加@Inheritance(strategy=InheritanceType.xxx)来声明继承关系。A支持3种继承策略：</p>
<ol>
<li>单表继承（InheritanceType.SINGLE<sub>TABLE），所有继承树上的类共用一张表，在父类指定（</sub>@DiscriminatorColumn）声明并在每个类指定@DiscriminatorValue来区分类型。</li>
<li>类表继承（InheritanceType.JOINED），父子类共同的部分公用一张表，其余部分保存到各自的表，通过join进行关联。</li>
<li>具体表继承（InheritanceType.TABLE<sub>PER</sub><sub>CLASS</sub>)，每个具体类映射到自己的表。<br>其中1和2能够支持多态，但是1需要允许字段为NULL，2需要多个JOIN关系；3最适合关系数据库，对多态支持不好。具体应用时根据需要取舍。</li>
</ol>
<h3 id="Embeddables"><a href="#Embeddables" class="headerlink" title="Embeddables"></a>Embeddables</h3><h3 id="Advanced-mapping"><a href="#Advanced-mapping" class="headerlink" title="Advanced mapping"></a>Advanced mapping</h3><h4 id="element-collection"><a href="#element-collection" class="headerlink" title="element collection"></a>element collection</h4>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/02/04/oracle-a-short-jouney/" itemprop="url">
                  Get started with Oracle 11g
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-02-04T08:57:04+08:00" content="2015-02-04">
              2015-02-04
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Databases/" itemprop="url" rel="index">
                    <span itemprop="name">Databases</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/02/04/oracle-a-short-jouney/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/02/04/oracle-a-short-jouney/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/02/02/output-pre-increment-and-post-increment/" itemprop="url">
                  output - pre-increment and post-increment
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-02-02T09:05:24+08:00" content="2015-02-02">
              2015-02-02
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Basics/" itemprop="url" rel="index">
                    <span itemprop="name">Basics</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/02/02/output-pre-increment-and-post-increment/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/02/02/output-pre-increment-and-post-increment/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String [] args)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> x= <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> y= <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> z = <span class="number">0</span>; z &amp;lt; <span class="number">5</span>; z++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span> (( x++ &amp;gt; <span class="number">2</span> ) || (y++ &amp;gt; <span class="number">2</span>))</div><div class="line">        &#123;</div><div class="line">            x++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    System.out.println(x + &amp;quot; &amp;quot; + y);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Output is: 7 3</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String [] args)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> x= <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> y= <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> z = <span class="number">0</span>; z &amp;lt; <span class="number">5</span>; z++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span> (( ++x &gt; <span class="number">2</span> ) || (++y &gt; <span class="number">2</span>))</div><div class="line">        &#123;</div><div class="line">            x++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    System.out.println(x + <span class="string">" "</span> + y);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Output is: 8 2</p>
<p>Two things you should notice:<br>1) defference between pre-increment and post-increment<br>2) boolean expression:<br>a. for logic add, if the former condition is false, the following conditions won’t be evaluated<br>b. for logic or, if the former condition is true, the following conditions won’t be evaluated</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/02/02/javaee-scriptless-jsp-el-jstl-and-taglibs/" itemprop="url">
                  scriptless JSP - EL, JSTL and taglibs
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-02-02T06:11:56+08:00" content="2015-02-02">
              2015-02-02
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Servlet-JSP/" itemprop="url" rel="index">
                    <span itemprop="name">Servlet / JSP</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/02/02/javaee-scriptless-jsp-el-jstl-and-taglibs/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/02/02/javaee-scriptless-jsp-el-jstl-and-taglibs/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="EL-Expression-Language-for-non-Java-programmer-or-designers"><a href="#EL-Expression-Language-for-non-Java-programmer-or-designers" class="headerlink" title="EL (Expression Language) for non-Java programmer or designers"></a>EL (Expression Language) for non-Java programmer or designers</h4><p>email: &lt;%= application.getAttribute(“email”) %&gt;</p>
<p>email: ${applicationScope.email}</p>
<h5 id="Implicit-objects-in-EL"><a href="#Implicit-objects-in-EL" class="headerlink" title="Implicit objects in EL:"></a>Implicit objects in EL:</h5><ul>
<li><code>pageContext</code>: The context for the JSP page.<br>NOTE: you cannot directly get the objects: application, session, request, response, page, but you can get them through pageContext.</li>
</ul>
<p>In addition, several implicit objects are available that allow easy access to the following objects:</p>
<ul>
<li><code>param</code>: Maps a request parameter name to a single value</li>
<li><code>paramValues</code>: Maps a request parameter name to an array of values</li>
<li><code>header</code>: Maps a request header name to a single value</li>
<li><code>headerValues</code>: Maps a request header name to an array of values</li>
<li><code>cookie</code>: Maps a cookie name to a single cookie</li>
<li><p><code>initParam</code>: Maps a context initialization parameter name to a single value<br>Finally, there are objects that allow access to the various scoped variables.</p>
</li>
<li><p><code>pageScope</code>: Maps page-scoped variable names to their values</p>
</li>
<li><code>requestScope</code>: Maps request-scoped variable names to their values</li>
<li><code>sessionScope</code>: Maps session-scoped variable names to their values</li>
<li><code>applicationScope</code>: Maps application-scoped variable names to their values</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/02/02/jsp-basics/" itemprop="url">
                  JSP basics
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-02-02T04:03:45+08:00" content="2015-02-02">
              2015-02-02
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Servlet-JSP/" itemprop="url" rel="index">
                    <span itemprop="name">Servlet / JSP</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/02/02/jsp-basics/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/02/02/jsp-basics/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="How-JSP-work"><a href="#How-JSP-work" class="headerlink" title="How JSP work"></a>How JSP work</h3><p><img src="/media/jsp.png" alt="jsp"></p>
<h3 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h3><h4 id="scriptlet"><a href="#scriptlet" class="headerlink" title="scriptlet"></a>scriptlet</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;% <span class="keyword">int</span> count=<span class="number">0</span>; out.println(<span class="string">"This is a scriptlet"</span>); %&amp;gt;</div></pre></td></tr></table></figure>
<p>This block is placed in the body of method _jspService(request, response)</p>
<h4 id="derective"><a href="#derective" class="headerlink" title="derective"></a>derective</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;%@ page <span class="keyword">import</span>=<span class="string">"java.util.*,java.xml.*"</span> %&amp;gt;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;%@ include file=<span class="string">"xxx"</span> %&amp;gt;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;%@ taglib tagdir=<span class="string">"/WEB-INF/tags/xxx"</span> prefix=<span class="string">"xxx"</span> %&amp;gt;</div></pre></td></tr></table></figure>
<h4 id="expression"><a href="#expression" class="headerlink" title="expression"></a>expression</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;%= <span class="string">"This is a expression argument"</span> %&amp;gt;</div></pre></td></tr></table></figure>
<h4 id="declaration"><a href="#declaration" class="headerlink" title="declaration"></a>declaration</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;%! <span class="keyword">int</span> count=<span class="number">0</span> %&amp;gt;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;%! <span class="function"><span class="keyword">int</span> <span class="title">doubleCount</span><span class="params">()</span> </span>&#123; count = count*<span class="number">2</span>; <span class="keyword">return</span> count; &#125; %&amp;gt;</div></pre></td></tr></table></figure>
<p>This is equivlant with the member field and member method of the generated servlet.</p>
<h4 id="comment"><a href="#comment" class="headerlink" title="comment"></a>comment</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;!-- HTML Comments --&amp;gt;</div><div class="line">&amp;lt;%-- JSP Comments --%&amp;gt;</div></pre></td></tr></table></figure>
<p>The first is called <span style="text-decoration: underline;"><em>output comments</em></span>, while the second is called <em><span style="text-decoration: underline;">hidden comments</span></em>.</p>
<h3 id="implicit-Objects-in-scriptlets-and-expressions"><a href="#implicit-Objects-in-scriptlets-and-expressions" class="headerlink" title="implicit Objects in scriptlets and expressions"></a>implicit Objects in scriptlets and expressions</h3><table style="height: 272px;" border="1" width="349"><br><tbody><br><tr><br><td>Type</td><br><td>implicit variable</td><br></tr><br><tr><br><td>JspWriter</td><br><td>out</td><br></tr><br><tr><br><td>HttpServletRequest</td><br><td>request</td><br></tr><br><tr><br><td>HttpServletResponse</td><br><td>response</td><br></tr><br><tr><br><td>HttpSession</td><br><td>session</td><br></tr><br><tr><br><td>ServletContext</td><br><td>application</td><br></tr><br><tr><br><td>ServletConfig</td><br><td>config</td><br></tr><br><tr><br><td>Throwable</td><br><td>exception</td><br></tr><br><tr><br><td>PageContext</td><br><td>pageContext</td><br></tr><br><tr><br><td>HttpJspPage</td><br><td>page</td><br></tr><br></tbody><br></table>

<h3 id="about-the-generated-servlet"><a href="#about-the-generated-servlet" class="headerlink" title="about the generated servlet"></a>about the generated servlet</h3><p>it’s a subclass of HttpJspPage, which inherited JspPage</p>
<p>In JSP, you can get its reference by a implicit object named <em><strong>page.</strong></em></p>
<p><img src="/media/jsppage.png" alt="jsppage"></p>
<p>The methods of <em><strong>JspPage</strong></em>:<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">jspInit()</div><div class="line">jspDestroy()</div></pre></td></tr></table></figure></p>
<p>The methods of <em><strong>HttpJspPage</strong></em><br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">_jspService()</div></pre></td></tr></table></figure></p>
<p>You can override the jspInit() and jspDestroy() methods, but not for _jspService() method.</p>
<h3 id="about-the-PageContext"><a href="#about-the-PageContext" class="headerlink" title="about the PageContext"></a>about the PageContext</h3><p>PageContext is a subclass of JspContext.<br><img src="/media/jspContext.png" alt="jspContext"><img src="/media/pageContext.png" alt="pageContext"></p>
<h3 id="about-the-configuration"><a href="#about-the-configuration" class="headerlink" title="about the configuration"></a>about the configuration</h3><p>1. config jsp for global in deployment descriptor<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;web-app ...&amp;gt;</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">&amp;lt;jsp-config&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;jsp-property-group&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;url-pattern&amp;gt;*.jsp&amp;lt;/url-pattern&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;el-ignored&amp;gt;<span class="keyword">true</span>&amp;lt;/el-ignored&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;scripting-invalid&amp;gt;<span class="keyword">true</span>&amp;lt;/scripting-invalid&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;/jsp-property-group&amp;gt;</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">&amp;lt;/web-app&amp;gt;</div></pre></td></tr></table></figure></p>
<p>2. config jsp in the page directive<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;%@ page isELIgnored=<span class="string">"true"</span> isScriptingEnabled=<span class="string">"false"</span> .... %&amp;gt;</div></pre></td></tr></table></figure></p>
<p>&nbsp;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/01/21/java-memory-model-atomicity-visibility-and-reordering/" itemprop="url">
                  JMM, Atomicity,  Visibility and Reordering
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-01-21T09:36:18+08:00" content="2015-01-21">
              2015-01-21
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Concurrency/" itemprop="url" rel="index">
                    <span itemprop="name">Concurrency</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Concurrency/Multithreading/" itemprop="url" rel="index">
                    <span itemprop="name">Multithreading</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/01/21/java-memory-model-atomicity-visibility-and-reordering/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/01/21/java-memory-model-atomicity-visibility-and-reordering/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Memory that can be shared between threads is called <em>shared memory</em> or <em>heap memory</em>. The term <em>variable</em> as used in this section refers to both fields and array elements. Variables that are shared between threads are referred to as shared variables. All instance fields, <code>static</code> fields, and array elements are shared variables and are stored in heap memory. Local variables, formal method parameters, and exception handler parameters are never shared between threads and are unaffected by the memory model.</p>
<p>In modern shared-memory multiprocessor architectures, each processor has one or more levels of cache that are periodically reconciled with main memory as shown in the following figure:</p>
<p><img src="https://www.securecoding.cert.org/confluence/download/attachments/65340568/cache.jpg?version=1&amp;modificationDate=1305747075000&amp;api=v2" alt=""></p>
<h4 id="Visibility"><a href="#Visibility" class="headerlink" title="Visibility"></a>Visibility</h4><p>The visibility of writes to shared variables can be problematic because the value of a shared variable may be cached; writing its value to main memory may be delayed. Consequently, another thread may read a stale value of the variable.</p>
<p>Cause:</p>
<ul>
<li>memory caching</li>
<li>compiler optimizations<br>&nbsp;</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/01/20/thread-synchronization/" itemprop="url">
                  Thread Synchronization
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-01-20T02:16:57+08:00" content="2015-01-20">
              2015-01-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Concurrency/" itemprop="url" rel="index">
                    <span itemprop="name">Concurrency</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Concurrency/Multithreading/" itemprop="url" rel="index">
                    <span itemprop="name">Multithreading</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/01/20/thread-synchronization/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/01/20/thread-synchronization/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Two-questions-about-synchronized"><a href="#Two-questions-about-synchronized" class="headerlink" title="Two questions about synchronized"></a>Two questions about synchronized</h4><ol>
<li>mutual exclusion - shared data access among multiple threads -</li>
<li>coordinating activities<br>Some of the Java virtual machine’s runtime data areas are shared by all threads, others are private to individual threads.</li>
</ol>
<ul>
<li><p>The heap and method area are shared by all threads, Java programs need to coordinate multi-threaded access to two kinds of data:</p>
</li>
<li><p>b. class variables, which are stored in the method area</p>
</li>
<li><p>a. instance variables, which are stored on the heap</p>
</li>
<li><p>Programs never need to coordinate access to local variables, which reside on Java stacks, because data on the Java stack is private to the thread to which the Java stack belongs.</p>
</li>
</ul>
<h4 id="Monitors"><a href="#Monitors" class="headerlink" title="Monitors"></a>Monitors</h4><p>The mechanism that Java uses to support synchronization is the monitor, which supports two kinds of thread synchronization: mutual exclusion and cooperation.</p>
<p>Mutual exclusion, which is supported in the Java virtual machine via object locks, enables multiple threads to independently work on shared data without interfering with each other.<br>Cooperation, which is supported in the Java virtual machine via the wait and notify methods of class Object, enables threads to work together towards a common goal.</p>
<p>A monitor is like a building that contains one special room that can be occupied by only one thread at a time. The room usually contains some data. From the time a thread enters this room to the time it leaves, it has exclusive access to any data in the room. Entering the monitor building is called “entering the monitor.” Entering the special room inside the building is called “acquiring the monitor.” Occupying the room is called “owning the monitor,” and leaving the room is called “releasing the monitor.” Leaving the entire building is called “exiting the monitor.”</p>
<p>In addition to being associated with a bit of data, a monitor is associated with one or more bits of code, which in this book will be called <strong><em>monitor regions</em></strong>.</p>
<p><img src="/media/fig20-1.gif" alt="fig20-1"><br><a href="http://www.artima.com/insidejvm/ed2/threadsynch.html" target="_blank" rel="external">http://www.artima.com/insidejvm/ed2/threadsynch.html</a></p>
<p>In this figure, number 2 and number 4 acquiring monitor is unpredictable, which is scheduled by JVM and implementation-dependent. Number 3 releasing monitor can be done by invoking wait() method.</p>
<p>Because sleep() have no change with the monitor, so this can explain why sleep is the class method of Thread instead of Object.</p>
<p>How to understand?</p>
<p>An object has a monitor to protect its data (instance variables or class variables).</p>
<p>When applying <code>sychronized</code>, it basically declare two things.</p>
<ul>
<li>specify the lock associated with the synchronized object using as privilege</li>
<li>mark the code (aka. monitor region) to be monitored by that monitor associated with the synchronized object</li>
</ul>
<h4 id="Object-locking-by-intrinsic-lock-or-monitor-lock"><a href="#Object-locking-by-intrinsic-lock-or-monitor-lock" class="headerlink" title="Object locking by _intrinsic lock or monitor lock_"></a>Object locking by _intrinsic lock <em>or</em> monitor lock_</h4><p>(The API specification often refers to this lock entity simply as a “monitor.”)</p>
<p>In the Java virtual machine, <em><span style="background-color: #cccccc;">every object and class is logically associated with a monitor</span></em>. For objects, the associated monitor protects the object’s instance variables. For classes, the monitor protects the class’s class variables. If an object has no instance variables, or a class has no class variables, the associated monitor protects no data.</p>
<p>To implement the mutual exclusion capability of monitors, the Java virtual machine associates a lock (sometimes called a mutex) with each object and class. A lock is like a privilege that only one thread can “own” at any one time. Threads need not obtain a lock to access instance or class variables. If a thread does obtain a lock, however, no other thread can obtain a lock on the same data until the thread that owns the lock releases it. (To “lock an object” is to acquire the monitor associated with that object.)</p>
<p>Note that as a Java programmer, you never explicitly lock an object. Object locks are internal to the Java virtual machine. In your Java programs, you identify the monitor regions of your program by writing synchronized statements and methods. As the Java virtual machine runs your program, it automatically locks an object or class every time it encounters a monitor region.</p>
<h5 id="Reentrant"><a href="#Reentrant" class="headerlink" title="Reentrant"></a>Reentrant</h5><p>A single thread is allowed to lock the same object multiple times. For each object, the Java virtual machine maintains a count of the number of times the object has been locked. An unlocked object has a count of zero. When a thread acquires the lock for the first time, the count is again incremented to one. Each time the thread acquires a lock on the same object, the count is again incremented. (Only the thread that already owns an object’s lock is allowed to lock it again. As mentioned previously, no other thread can lock the object until the owning thread releases the lock.) Each time the thread releases the lock, the count is decremented. When the count reaches zero, the lock is released and made available to other threads.</p>
<h5 id="volatile"><a href="#volatile" class="headerlink" title="volatile "></a><em>volatile </em></h5><p>//TODO</p>
<h4 id="“Wait-and-Notify”-monitor-aka-“Signal-and-Continue”-monitor"><a href="#“Wait-and-Notify”-monitor-aka-“Signal-and-Continue”-monitor" class="headerlink" title="“Wait and Notify” monitor (aka. “Signal and Continue” monitor)"></a>“Wait and Notify” monitor (aka. “Signal and Continue” monitor)</h4><p>In this kind of monitor, a thread that currently owns the monitor can suspend itself inside the monitor by executing a <em>wait command</em>. When a thread executes a wait, it releases the monitor and enters a <em>wait set</em>. The thread will stay suspended in the wait set until some time after another thread executes a <em>notify command</em> inside the monitor. When a thread executes a notify, it continues to own the monitor until it releases the monitor of its own accord, either by executing a wait or by completing the monitor region. After the notifying thread has released the monitor, the waiting thread will be resurrected and will reacquire the monitor.</p>
<p>a. When a thread has acquired the monitor and invoke wait() on this object, this thread release its acquired monitors, and enter the waiting set.<br>b. When another thread has acquired the monitor and invoke notify() or notifyAll() on the same object, then the waiting state of one thread or all threads in the waiting area ends and the thread starts attempting to regain all the monitors. At one time there may be several threads trying to regain (or maybe gain for the first time) their monitors. If more than one threads attempt to acquire the monitor of a particular object then only one thread (selected by the JVM scheduler) is granted the monitor and all other threads are put into BLOCKED state.</p>
<p>The following pictures demonstrate the lock and wait/notify mechanism:</p>
<blockquote>
<p>Legend: Blue - BLOCKED     Green - RUNNABLE (running)       White - WAITING</p>
<p>Threads in waiting state can be interrupted, but cannot in blocked state.<br>[caption id=”attachment_209” align=”alignleft” width=”235”]<img src="/media/11.gif" alt="11"> Thread 1 acquires the lock and starts running; other threads cannot acquire the lock, so they are BLOCKED[/caption]</p>
</blockquote>
<p>[caption id=”attachment_202” align=”alignleft” width=”235”]<img src="/media/12.gif" alt="12"> Thread 1 invokes wait(), releases the lock and gets await; thread 4 acquires the lock and starts running[/caption]</p>
<p>[caption id=”attachment_203” align=”alignleft” width=”235”]<img src="/media/13.gif" alt="13"> Thread 4 also invokes wait() ; thread 3 acquire the released lock and starts running[/caption]</p>
<p>[caption id=”attachment_204” align=”alignleft” width=”235”]<img src="/media/14.gif" alt="14"> Thread 4 exits; thread 2 acquires the lock and starts running[/caption]</p>
<p>[caption id=”attachment_206” align=”alignleft” width=”235”]<img src="/media/16.gif" alt="16"> Thread 2 exits; thread 4 reacquires the lock and gets running[/caption]</p>
<p>[caption id=”attachment_207” align=”alignleft” width=”235”]<img src="/media/17.gif" alt="17"> Thread 4 exits; thread 1 reacquires the lock and goes running once again.[/caption]</p>
<h5 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h5><p>1. A typical scenario is that there is a customer account which can be deposited and fetched at the same time.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ATM</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">final</span> <span class="keyword">static</span> CyclicBarrier cyclicBarrier = <span class="keyword">new</span> CyclicBarrier(<span class="number">4</span>);</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</div><div class="line">        <span class="keyword">final</span> Account account = <span class="keyword">new</span> Account();</div><div class="line"></div><div class="line">        ThreadGroup group = <span class="keyword">new</span> ThreadGroup(<span class="string">"group"</span>);</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">11</span>; i &amp;lt; <span class="number">13</span>; ++i) &#123;</div><div class="line">            <span class="keyword">new</span> Thread(<span class="string">"D #"</span> + i) &#123;</div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                    <span class="keyword">try</span> &#123;</div><div class="line">                        cyclicBarrier.await();</div><div class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">                        e.printStackTrace();</div><div class="line">                    &#125; <span class="keyword">catch</span> (BrokenBarrierException e) &#123;</div><div class="line">                        e.printStackTrace();</div><div class="line">                    &#125;</div><div class="line">                    account.deposit(amount());</div><div class="line">                &#125;</div><div class="line">            &#125;.start();</div><div class="line"></div><div class="line">            <span class="keyword">new</span> Thread(<span class="string">"W #"</span> + i) &#123;</div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                    <span class="keyword">try</span> &#123;</div><div class="line">                        cyclicBarrier.await();</div><div class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">                        e.printStackTrace();</div><div class="line">                    &#125; <span class="keyword">catch</span> (BrokenBarrierException e) &#123;</div><div class="line">                        e.printStackTrace();</div><div class="line">                    &#125;</div><div class="line">                    account.withdraw(amount());</div><div class="line">                &#125;</div><div class="line">            &#125;.start();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">amount</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)(Math.random() * <span class="number">100</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Account</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String id;</div><div class="line">    <span class="keyword">private</span> String customerName;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> balance = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">deposit</span><span class="params">(<span class="keyword">int</span> amount)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> oldBalance = balance;</div><div class="line">        balance += amount;</div><div class="line">        print(<span class="string">"Balance: ￥%d + ￥%d =&amp;gt; ￥%d"</span>, oldBalance, amount, balance);</div><div class="line">        notifyAll();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">withdraw</span><span class="params">(<span class="keyword">int</span> amount)</span> </span>&#123;</div><div class="line">        <span class="keyword">while</span>(balance &amp;lt; amount) &#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                print(<span class="string">"Balance: ￥%d - ￥%d =&amp;gt; FAIL"</span>, balance, amount);</div><div class="line">                wait();</div><div class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> oldBalance = balance;</div><div class="line">        balance -= amount;</div><div class="line">        print(<span class="string">"Balance: ￥%d - ￥%d =&amp;gt; ￥%d"</span>, oldBalance, amount, balance);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(String message, Object...args)</span> </span>&#123;</div><div class="line">        PrintStream ps = System.out;</div><div class="line">        ps.format(<span class="string">"%s: "</span>, Thread.currentThread().getName());</div><div class="line">        ps.format(message, args);</div><div class="line">        ps.println();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>One output is:<br>W #11: Balance: ￥0 - ￥5 =&gt; FAIL<br>W #12: Balance: ￥0 - ￥23 =&gt; FAIL<br>D #12: Balance: ￥0 + ￥30 =&gt; ￥30<br>D #11: Balance: ￥30 + ￥90 =&gt; ￥120<br>W #12: Balance: ￥120 - ￥23 =&gt; ￥97<br>W #11: Balance: ￥97 - ￥5 =&gt; ￥92</p>
<p>Another output which will be await always:<br>W #11: Balance: ￥0 - ￥54 =&gt; FAIL<br>W #12: Balance: ￥0 - ￥93 =&gt; FAIL<br>D #12: Balance: ￥0 + ￥89 =&gt; ￥89<br>D #11: Balance: ￥89 + ￥28 =&gt; ￥117<br>W #12: Balance: ￥117 - ￥93 =&gt; ￥24<br>W #11: Balance: ￥24 - ￥54 =&gt; FAIL<br>..(waiting here)..</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/01/19/topic-serial-threads/" itemprop="url">
                  Java Thread Management
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-01-19T07:30:46+08:00" content="2015-01-19">
              2015-01-19
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Multithreading/" itemprop="url" rel="index">
                    <span itemprop="name">Multithreading</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/01/19/topic-serial-threads/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/01/19/topic-serial-threads/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>About thread:</p>
<h3 id="1-Single-thread-and-multi-thread"><a href="#1-Single-thread-and-multi-thread" class="headerlink" title="1. Single-thread and multi-thread"></a>1. Single-thread and multi-thread</h3><p>A single-thread program has a single entry point (the main() method) and a single exit point. A multi-thread program has an initial entry point (the main() method), followed by many entry and exit points, which are run concurrently with the main().<br><img src="/media/Multithread.gif" alt="Multithread"></p>
<h3 id="2-Lifecycle"><a href="#2-Lifecycle" class="headerlink" title="2. Lifecycle"></a>2. Lifecycle</h3><p><img src="/media/Multithread_ThreadLifeCycle.png" alt="Multithread_ThreadLifeCycle"></p>
<p>In Java, there are only 6 states when invoking<em> <strong>getState()</strong></em>:<br>NEW<br>RUNNABLE<br>BLOCKED<br>WAITING<br>TIMED_WAITING<br>TERMINATED</p>
<p>In reality, we cannot differentiate the running or runnable but not running.</p>
<p>a. A thread is <em>alive</em> when it is started but has not died. We can check it by <strong><em>isAlive()</em></strong><br>b. A daemon thread or a user thread mark is useful when JVM determine if it should exit. JVM exits when the only threads running are all daemon threads.</p>
<h3 id="3-Control-through-the-lifecycle"><a href="#3-Control-through-the-lifecycle" class="headerlink" title="3. Control through the lifecycle"></a>3. Control through the lifecycle</h3><p>In the following writing, I will use “control thread” as the source thread which instantiate, operate the new produced thread, and the latter is “target thread”.</p>
<h4 id="1-create-a-thread-in-control-thread-execution-context"><a href="#1-create-a-thread-in-control-thread-execution-context" class="headerlink" title="1) create a thread in control thread (execution context)"></a>1) create a thread in control thread (execution context)</h4><p>We create a thread instance (a real thread representation in Java) by using <em>new</em> keyword.<br><a href="/media/2129351.png"><img src="/media/2129351.png" alt=""></a></p>
<p>So some properties can be provided in constructors:<br>a. ThreadGroup<br>b. Runnable target (define what will be run)<br>c. thread name<br>d. stack size</p>
<p>Apart from these, there are the following perperties:<br>e. daemon thread or user thread?<br>f. priority<br>g. id</p>
<p>Other important things:</p>
<p>a. stack trace (TODO)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line">getStackTrace()</div><div class="line">dumpStack()</div><div class="line">Thread.getAllStackTraces()</div></pre></td></tr></table></figure>
<p>b. uncaught exception handler (TODO)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line">getUncaughtExceptionHandler()</div><div class="line">setUncaughtExceptionHandler(UncaughtExceptionHandler)</div><div class="line">Thread.getDefaultUncaughtExceptionHandler()</div><div class="line">Thread.setDefaultUncaughtExceptionHandler(UncaughtExceptionHandler)</div></pre></td></tr></table></figure>
<p>c.context class loader (TODO)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line">getContextClassLoader()</div><div class="line">setContextClassLoader(ClassLoader)</div></pre></td></tr></table></figure>
<h4 id="2-start-a-thread-in-control-thread"><a href="#2-start-a-thread-in-control-thread" class="headerlink" title="2) start a thread in control thread"></a>2) start a thread in control thread</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span></span></div></pre></td></tr></table></figure>
<p>Other methods like:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">(Throwable obj)</span></span>;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span>;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">suspend</span><span class="params">()</span></span>;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">resume</span><span class="params">()</span></span>;</div></pre></td></tr></table></figure>
<p>are all deprecated, as as they are inherently deadlock-prone.</p>
<h4 id="3-interrupt"><a href="#3-interrupt" class="headerlink" title="3) interrupt"></a>3) interrupt</h4><p>When we need to interrupt a target thread?<br>a. the target thread is waiting in an invocation of method which can response the interruption by throwing an InterruptedException; these methods include wait(), notify(), notifyAll(), Thread.sleep()<br>b. you don’t wish the target thread to execute continually (may be a infinite loop or need spending too much time)</p>
<p>When control thread invokes a interrupt in the target thread instance, the target thread has two ways to response, if possible for interruption:<br>a. catch the InterruptedException<br>b. check the interrupted status by interrupted() method (once invoked, the interrupted status is cleared)</p>
<p>The following scenarios can produce the InterruptedException:<br>a. sleep(long)<br>b. wait(), wait(long), wait(long, int)<br>c. join(), join(long), join(long, wait)<br>d. interruption channel and selector</p>
<blockquote>
<p><span style="color: #ff0000;">NOTICE: current thread cannot interrupt itself.</span></p>
</blockquote>
<figure class="highlight"><table><tr><td class="code"><pre><div class="line"></div><div class="line">Thread thread = new Thread(new Runnable() &#123;</div><div class="line">    @Override</div><div class="line">    public void run() &#123;</div><div class="line">        while(true) &#123;</div><div class="line">            System.out.println(&amp;amp;quot;I'm running&amp;amp;quot;);</div><div class="line">            int a = 1;</div><div class="line">            try &#123;</div><div class="line">                Thread.sleep(10);</div><div class="line">            &#125; catch (InterruptedException e) &#123;</div><div class="line">                System.out.println(&amp;amp;quot;Interruption received, now I exit&amp;amp;quot;);</div><div class="line">                break;</div><div class="line">            &#125;</div><div class="line">            a = a + 2;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">thread.start();</div><div class="line">doHardWork();</div><div class="line">thread.interrupt();</div></pre></td></tr></table></figure>
<p>If we don’t interrupt it, the thread will be running forever.</p>
<figure class="highlight"><table><tr><td class="code"><pre><div class="line"></div><div class="line">Thread thread = new Thread(new Runnable() &#123;</div><div class="line">    @Override</div><div class="line">    public void run() &#123;</div><div class="line"></div><div class="line">        while(true) &#123;</div><div class="line">            if(Thread.interrupted()) &#123;</div><div class="line">                System.out.println(&amp;quot;Interruption received, now I exit&amp;quot;);</div><div class="line">                break;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            System.out.println(&amp;quot;I'm running&amp;quot;);</div><div class="line">            double d = 0.0;</div><div class="line">            for (int i = 0; i &amp;lt; 900000; i++) &#123;</div><div class="line">                d = d + (Math.PI + Math.E) / d;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">thread.start();</div><div class="line">doHardWork();</div><div class="line">System.out.println(&amp;quot;prepare to interrupt&amp;quot;);</div><div class="line">thread.interrupt();</div></pre></td></tr></table></figure>
<p>By using interrupted(), we don’t depend on InterruptedException to notify interruption, we check it by my own proactively.</p>
<h4 id="4-join"><a href="#4-join" class="headerlink" title="4) join"></a>4) join</h4><p>Sometimes, the control thread does something strictly after the target thread died. If the target thread has not terminated, the control thread must be blocked.</p>
<blockquote>
<p><span style="color: #ff0000;">NOTICE: current thread can join itself, but it makes no sense because it will wait forever.</span></p>
</blockquote>
<figure class="highlight"><table><tr><td class="code"><pre><div class="line"></div><div class="line">Thread thread = new Thread(new Runnable() &#123;</div><div class="line">    @Override</div><div class="line">    public void run() &#123;</div><div class="line">        for(int i=0; i &amp;lt; 10; ++i) &#123;</div><div class="line">            System.out.println(&amp;quot;I'm running&amp;quot;);</div><div class="line">            double d = 0.0;</div><div class="line">            for (int j = 0; j &amp;lt; 900000; j++) &#123;</div><div class="line">                d = d + (Math.PI + Math.E) / d;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">thread.start();</div><div class="line">doHardWork();</div><div class="line"></div><div class="line">System.out.println(&amp;quot;do my work&amp;quot;);</div><div class="line">System.in.read(); //just make the main thread not exit</div></pre></td></tr></table></figure>
<p>In this example, the “do my work” happens in uninsured point, like this in one run:<br>I’m running<br>I’m running<br>I’m running<br>I’m running<br>I’m running<br>I’m running<br>I’m running<br>I’m running<br>do my work<br>I’m running<br>I’m running</p>
<p>Now, we use join() and see the result:</p>
<figure class="highlight"><table><tr><td class="code"><pre><div class="line"></div><div class="line">Thread thread = new Thread(new Runnable() &#123;</div><div class="line">    @Override</div><div class="line">    public void run() &#123;</div><div class="line">        for(int i=0; i &amp;lt; 10; ++i) &#123;</div><div class="line">            System.out.println(&amp;quot;I'm running&amp;quot;);</div><div class="line">            double d = 0.0;</div><div class="line">            for (int j = 0; j &amp;lt; 900000; j++) &#123;</div><div class="line">                d = d + (Math.PI + Math.E) / d;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">thread.start();</div><div class="line">doHardWork();</div><div class="line">thread.join();</div><div class="line">System.out.println(&amp;quot;do my work&amp;quot;);</div><div class="line">System.in.read(); //just make the main thread not exit</div></pre></td></tr></table></figure>
<p>Now, the output is definitely:</p>
<p>I’m running<br>I’m running<br>I’m running<br>I’m running<br>I’m running<br>I’m running<br>I’m running<br>I’m running<br>I’m running<br>I’m running<br>do my work</p>
<p>It can ensure that the code behind the join() must be executed after the target thread died.</p>
<blockquote>
<p><span style="color: #ff00ff;">WARNING: All the above examples, don’t use JUnit for testing, becaust JUnit terminate the program once the main thread terminate, regardless of the running/waiting spawn threads.</span></p>
</blockquote>
<h5 id="5-Operations-on-current-thread"><a href="#5-Operations-on-current-thread" class="headerlink" title="5) Operations on current thread"></a>5) Operations on current thread</h5><p>When code is executed in a thread context, it always knows the current thread object which represents the current execution thread context.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line">Thread.currentThread();</div><div class="line">Thread.sleep(<span class="keyword">long</span>);  Thread.sleep(<span class="keyword">long</span>, <span class="keyword">int</span>);</div><div class="line">Thread.yield();</div><div class="line">Thread.interrupted();  <span class="comment">// Please differentiate Thread.interrupted() and thread.isInterrupted()</span></div><div class="line">Thread.holdsLock()</div></pre></td></tr></table></figure>
<p>Some convenient methods from ThreadGroup:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line">Thread.activeCount()</div><div class="line">Thread.enumurate()</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/01/19/topic-serial-exceptions/" itemprop="url">
                  Java Exceptions
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-01-19T02:00:33+08:00" content="2015-01-19">
              2015-01-19
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Coding-amp-Debuging/" itemprop="url" rel="index">
                    <span itemprop="name">Coding &amp; Debuging</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Coding-amp-Debuging/Exception/" itemprop="url" rel="index">
                    <span itemprop="name">Exception</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Coding-amp-Debuging/Exception/Exception-Handling/" itemprop="url" rel="index">
                    <span itemprop="name">Exception Handling</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/01/19/topic-serial-exceptions/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/01/19/topic-serial-exceptions/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>An exception is said to be <span class="emphasis"><em>thrown</em></span> from the point where it occurred and is said to be <span class="emphasis"><em>caught</em></span> at the point to which control is transferred.</p>
<h3 id="exception-family-tree"><a href="#exception-family-tree" class="headerlink" title="exception family tree"></a>exception family tree</h3><p><a href="/media/IMG_2690.png"><img src="/media/IMG_2690.png" alt="IMG_2690"></a></p>
<p>All exceptions are inherited from Throwable.</p>
<p>All run-time exception classes and error classes are unchecked exception classes, and the rest are checked exception classes.</p>
<p>That is, the checked exception classes are all subclasses of <code>Throwable</code> other than <code>RuntimeException</code> and its subclasses and <code>Error</code> and its subclasses.</p>
<h3 id="play-with-finally-block"><a href="#play-with-finally-block" class="headerlink" title="play with finally block"></a>play with finally block</h3><p>If you put a finally block after a try and its associated catch blocks, then once execution enters the try block, the code in that finally block will definitely be executed except in the following circumstances:</p>
<ol>
<li>An exception arising in the finally block itself.</li>
<li>The death of the thread.</li>
<li>The use of <em>System.exit()</em></li>
<li>Turning off the power to the CPU.<br>finally block is always executed <em>before</em> the try-catch blocks exit, including:</li>
</ol>
<p>1) return<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125; <span class="keyword">finally</span> &#123;</div><div class="line">        System.out.println(<span class="string">"finally executed"</span>); <span class="comment">// execute before return</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>2) no exception, execute sequentially<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        <span class="comment">// some code</span></div><div class="line">    &#125; <span class="keyword">finally</span> &#123;</div><div class="line">        System.out.println(<span class="string">"finally executed"</span>); <span class="comment">// execute before try block ends</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>3) has exception, but no catch<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"11"</span>);</div><div class="line">        <span class="comment">// some code</span></div><div class="line">    &#125; <span class="keyword">finally</span> &#123;</div><div class="line">        System.out.println(<span class="string">"finally executed"</span>); <span class="comment">// execute before throwing the exception</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>4) has exception, but caught successfully<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"11"</span>);</div><div class="line">        <span class="comment">// some code</span></div><div class="line">    &#125; <span class="keyword">catch</span>(Exception e) &#123;</div><div class="line">        <span class="comment">// some code</span></div><div class="line">    &#125; <span class="keyword">finally</span> &#123;</div><div class="line">        System.out.println(<span class="string">"finally executed"</span>); <span class="comment">// execute before the catch block ends</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>5) has exception, try to catch but failed<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"11"</span>);</div><div class="line">        <span class="comment">// some code</span></div><div class="line">    &#125; <span class="keyword">catch</span>(RuntimeException e) &#123;</div><div class="line">        <span class="comment">// some code</span></div><div class="line">    &#125; <span class="keyword">finally</span> &#123;</div><div class="line">        System.out.println(<span class="string">"finally executed"</span>); <span class="comment">// execute before throwing the exception</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>For more details about finally behavior, please refer to <a href="http://richdyang.com/finally-execution-in-try-catch-finnally-blocks" target="_blank" rel="external">finally execution in try-catch-finnally blocks</a></p>
<h3 id="exception-catch-order"><a href="#exception-catch-order" class="headerlink" title="exception catch order"></a>exception catch order</h3><p>If class BaseException is the super class of class DerivedException, and you write the catch clause of BaseException ahead of DerivedException, then a compilation error will show.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">try</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> x = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> y = <span class="number">5</span> / x;</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span> (Exception e)</div><div class="line">&#123;</div><div class="line">    System.out.println(<span class="string">"Exception"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span> (ArithmeticException ae) <span class="comment">// compiler error: Exception "java.lang.ArithmeticException" has already been caught</span></div><div class="line">&#123;</div><div class="line">    System.out.println(<span class="string">" Arithmetic Exception"</span>);</div><div class="line">&#125;</div><div class="line">System.out.println(<span class="string">"finished"</span>);</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/01/16/override/" itemprop="url">
                  Override - some requirements
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-01-16T06:35:35+08:00" content="2015-01-16">
              2015-01-16
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/OOP/" itemprop="url" rel="index">
                    <span itemprop="name">OOP</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/01/16/override/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/01/16/override/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-Override-methods-must-have-the-identical-method-signature-as-the-methods-overridden"><a href="#1-Override-methods-must-have-the-identical-method-signature-as-the-methods-overridden" class="headerlink" title="1. Override methods must have the identical method signature as the methods overridden"></a>1. Override methods must have the identical method signature as the methods overridden</h4><p>Return type doesn’t belong to the method signature, but Java supports covariant return type for overriding.</p>
<p>Identical signature means:<br>1) the number of formal arguments must be equal.<br>2) the type of relevant argument must be the same. The subtype of the methond argument cannot be considered as identical.</p>
<h4 id="2-Override-methods-can-less-restricted-in-access-control"><a href="#2-Override-methods-can-less-restricted-in-access-control" class="headerlink" title="2. Override methods can less restricted in access control"></a>2. Override methods can less restricted in access control</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AA</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BB</span> <span class="keyword">extends</span> <span class="title">AA</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span>  </span>&#123;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>We make the foo() method accessible from weaker privilege “protected” to less restricted specifier “public”.</p>
<h4 id="3-Override-methods-and-throw-clause"><a href="#3-Override-methods-and-throw-clause" class="headerlink" title="3. Override methods and throw clause"></a>3. Override methods and throw clause</h4><p>More precisely, suppose that B is a class or interface, and A is a superclass or superinterface of B, and a method declaration n in B overrides or hides a method declaration m in A. Then:</p>
<p>If n has a throws clause that mentions any checked exception types, then m must have a throws clause, or a compile-time error occurs.</p>
<p>For every checked exception type listed in the throws clause of n, that same exception class or one of its supertypes must occur in the erasure (§4.6) of the throws clause of m; otherwise, a compile-time error occurs.</p>
<p><img src="/media/IMG_2690.png" alt="IMG_2690"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AA</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BB</span> <span class="keyword">extends</span> <span class="title">AA</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">//This is naturally OK</span></div><div class="line"><span class="comment">//    @Override</span></div><div class="line"><span class="comment">//    public void foo() throws IOException &#123;</span></div><div class="line"><span class="comment">//    &#125;</span></div><div class="line"></div><div class="line">    <span class="comment">//This is also OK, since EOFException is a subtype of IOException</span></div><div class="line"><span class="comment">//    @Override</span></div><div class="line"><span class="comment">//    public void foo() throws EOFException &#123;</span></div><div class="line"><span class="comment">//    &#125;</span></div><div class="line"></div><div class="line">    <span class="comment">//This is also OK, since we don't increase new checked Exception</span></div><div class="line"><span class="comment">//    @Override</span></div><div class="line"><span class="comment">//    public void foo() &#123;</span></div><div class="line"><span class="comment">//    &#125;</span></div><div class="line"></div><div class="line">    <span class="comment">//This is OK, since RuntimeException is unchecked exception, which is not requested</span></div><div class="line"><span class="comment">//    @Override</span></div><div class="line"><span class="comment">//    public void foo() throws RuntimeException &#123;</span></div><div class="line"><span class="comment">//    &#125;</span></div><div class="line"></div><div class="line">    <span class="comment">//This is OK, since IllegalArgumentException is a subtype of RuntimeException</span></div><div class="line"><span class="comment">//    @Override</span></div><div class="line"><span class="comment">//    public void foo() throws IllegalArgumentException &#123;</span></div><div class="line"><span class="comment">//    &#125;</span></div><div class="line"></div><div class="line">    <span class="comment">//This is OK, since Error is unchecked exception, which is not requested</span></div><div class="line"><span class="comment">//    @Override</span></div><div class="line"><span class="comment">//    public void foo() throws Error &#123;</span></div><div class="line"><span class="comment">//    &#125;</span></div><div class="line"></div><div class="line">    <span class="comment">//This is OK, since AssertionError is a subtype of Error</span></div><div class="line"><span class="comment">//    @Override</span></div><div class="line"><span class="comment">//    public void foo() throws AssertionError &#123;</span></div><div class="line"><span class="comment">//    &#125;</span></div><div class="line"></div><div class="line">    <span class="comment">// Compile error: class AA don't have AccessControlException declaration</span></div><div class="line"><span class="comment">//    public void foo() throws AccessControlException &#123;</span></div><div class="line"><span class="comment">//    &#125;</span></div><div class="line"></div><div class="line">    <span class="comment">// Compile error: Throwable is also a checked exception class AA don't have Throwable declaration</span></div><div class="line"><span class="comment">//    public void foo() throws Throwable &#123;</span></div><div class="line"><span class="comment">//    &#125;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/01/16/unreachable-statements/" itemprop="url">
                  unreachable statements
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-01-16T04:42:49+08:00" content="2015-01-16">
              2015-01-16
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Language-Compiler/" itemprop="url" rel="index">
                    <span itemprop="name">Language, Compiler</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/01/16/unreachable-statements/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/01/16/unreachable-statements/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Sometimes, we will meet this compiler error: unreachable statements.</p>
<p>See the following examples:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">javapapers</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.println(&amp;quot;java&amp;quot;);</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">    System.out.println(&amp;quot;papers&amp;quot;); <span class="comment">// compile error</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">javapapers</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.println(&amp;quot;java&amp;quot;);</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">true</span>) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    System.out.println(&amp;quot;papers&amp;quot;);</div><div class="line">&#125;</div><div class="line"><span class="comment">//This code compiled successfully</span></div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">javapapers</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.println(&amp;quot;java&amp;quot;);</div><div class="line">    <span class="keyword">while</span>(<span class="keyword">true</span>) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    System.out.println(&amp;quot;papers&amp;quot;); <span class="comment">// compile error</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Wait, but what is strange here?</p>
<p>From Java Language Specification:</p>
<p><div class="titlepage"></div></p>
<p><div></div></p>
<p><div></div></p>
<blockquote>
<h2 id="14-21-Unreachable-Statements"><a href="#14-21-Unreachable-Statements" class="headerlink" title="14.21. Unreachable Statements"></a>14.21. Unreachable Statements</h2><p><br><br><br><a name="jls-14.21-100"></a>It is a compile-time error if a statement cannot be executed because it is <span class="emphasis"><em>unreachable</em></span>.</p>
<p>This section is devoted to a precise explanation of the word “reachable.” The idea is that there must be some possible execution path from the beginning of the constructor, method, instance initializer, or static initializer that contains the statement to the statement itself. The analysis takes into account the structure of statements. Except for the special treatment of <code>while</code>, <code>do</code>, and <code>for</code> statements whose condition expression has the constant value <code>true</code>, the values of expressions are not taken into account in the flow analysis.</p>
<div class="informalexample"><br><br><br>For example, a Java compiler will accept the code:<br><br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&#123;</div><div class="line">&gt; </div><div class="line">&gt;     <span class="keyword">int</span> n = <span class="number">5</span>;</div><div class="line">&gt; </div><div class="line">&gt;     <span class="keyword">while</span> (n &amp;gt; <span class="number">7</span>) k = <span class="number">2</span>;</div><div class="line">&gt; </div><div class="line">&gt; &#125;</div><div class="line">&gt; </div><div class="line">&gt;</div></pre></td></tr></table></figure><br><br><br><br>even though the value of <code>n</code> is known at compile time and in principle it can be known at compile time that the assignment to <code>k</code> can never be executed.<br><br></div>


<p><a name="jls-14.21-200"></a>The rules in this section define two technical terms:</p>
<div class="norm"><br><br><br><em>   <a name="jls-14.21-200-A"></a>whether a statement is <span class="emphasis"><em>reachable</em></span>

</em>   <a name="jls-14.21-200-B"></a>whether a statement <span class="emphasis"><em>can complete normally</em></span><br><br></div>


<p><a name="jls-14.21-210"></a>The definitions here allow a statement to complete normally only if it is reachable.</p>
<p><a name="jls-14.21-220"></a>To shorten the description of the rules, the customary abbreviation “iff” is used to mean “if and only if.”</p>
<p><a name="jls-14.21-230"></a>A reachable <code>break</code> statement <span class="emphasis"><em>exits a statement</em></span> if, within the break target, either there are no <code>try</code> statements whose <code>try</code> blocks contain the<code>break</code> statement, or there are <code>try</code> statements whose <code>try</code> blocks contain the <code>break</code> statement and all <code>finally</code> clauses of those <code>try</code>statements can complete normally.</p>
<p>This definition is based on the logic around “attempts to transfer control” in <a href="http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.15" title="14.15. The break Statement" target="_blank" rel="external">§14.15</a>.</p>
<p><a name="jls-14.21-240"></a>A <code>continue</code> statement <span class="emphasis"><em>continues a <code>do</code> statement</em></span> if, within the <code>do</code> statement, either there are no <code>try</code> statements whose <code>try</code> blocks contain the<code>continue</code> statement, or there are <code>try</code> statements whose <code>try</code> blocks contain the <code>continue</code> statement and all <code>finally</code> clauses of those <code>try</code>statements can complete normally.</p>
<p><a name="jls-14.21-300"></a>The rules are as follows:</p>
<div class="norm"><br><br><br><em>   <a name="jls-14.21-300-A"></a>The block that is the body of a constructor, method, instance initializer, or static initializer is reachable.

</em>   <a name="jls-14.21-300-B"></a>An empty block that is not a switch block can complete normally iff it is reachable.<br><br><a name="jls-14.21-300-B.1"></a>A non-empty block that is not a switch block can complete normally iff the last statement in it can complete normally.<br><br><a name="jls-14.21-300-B.2"></a>The first statement in a non-empty block that is not a switch block is reachable iff the block is reachable.<br><br><a name="jls-14.21-300-B.3"></a>Every other statement <code>S</code> in a non-empty block that is not a switch block is reachable iff the statement preceding <code>S</code> can complete normally.<br><br><em>   <a name="jls-14.21-300-C"></a>A local class declaration statement can complete normally iff it is reachable.

</em>   <a name="jls-14.21-300-D"></a>A local variable declaration statement can complete normally iff it is reachable.<br><br><em>   <a name="jls-14.21-300-E"></a>An empty statement can complete normally iff it is reachable.

</em>   <a name="jls-14.21-300-F"></a>A labeled statement can complete normally if at least one of the following is true:<br><br><div class="norm"><br><br><br>    <em>   <a name="jls-14.21-300-F-1"></a>The contained statement can complete normally.

        </em>   <a name="jls-14.21-300-F-2"></a>There is a reachable <code>break</code> statement that exits the labeled statement.<br><br></div>


<p><a name="jls-14.21-300-F.1"></a>The contained statement is reachable iff the labeled statement is reachable.</p>
<ul>
<li><p><a name="jls-14.21-300-G"></a>An expression statement can complete normally iff it is reachable.</p>
</li>
<li><p><a name="jls-14.21-300-H-1"></a>An <code>if-then</code> statement can complete normally iff it is reachable.</p>
</li>
</ul>
<p><a name="jls-14.21-300-H-2"></a>The <code>then</code>-statement is reachable iff the <code>if-then</code> statement is reachable.</p>
<p><a name="jls-14.21-300-H-3"></a>An <code>if-then-else</code> statement can complete normally iff the <code>then</code>-statement can complete normally or the <code>else</code>-statement can complete normally.</p>
<p><a name="jls-14.21-300-H-4"></a>The <code>then</code>-statement is reachable iff the <code>if-then-else</code> statement is reachable.</p>
<p><a name="jls-14.21-300-H-5"></a>The <code>else</code>-statement is reachable iff the <code>if-then-else</code> statement is reachable.</p>
<p>This handling of an <code>if</code> statement, whether or not it has an <code>else</code> part, is rather unusual. The rationale is given at the end of this section.</p>
<ul>
<li><p><a name="jls-14.21-300-I"></a>An <code>assert</code> statement can complete normally iff it is reachable.</p>
</li>
<li><p><a name="jls-14.21-300-J"></a>A <code>switch</code> statement can complete normally iff at least one of the following is true:</p>
</li>
</ul>
<div class="norm"><br><br><br>    <em>   <a name="jls-14.21-300-J-1"></a>The switch block is empty or contains only switch labels.

        </em>   <a name="jls-14.21-300-J-2"></a>The last statement in the switch block can complete normally.<br><br>        <em>   <a name="jls-14.21-300-J-3"></a>There is at least one switch label after the last switch block statement group.

        </em>   <a name="jls-14.21-300-J-4"></a>The switch block does not contain a <code>default</code> label.<br><br>        <em>   <a name="jls-14.21-300-J-5"></a>There is a reachable <code>break</code> statement that exits the <code>switch</code> statement.<br><br></em></div>
   <a name="jls-14.21-300-K"></a>A switch block is reachable iff its <code>switch</code> statement is reachable.<br><br><em>   <a name="jls-14.21-300-L"></a>A statement in a switch block is reachable iff its <code>switch</code> statement is reachable and at least one of the following is true:<br><br><div class="norm">


    </div></em>   <a name="jls-14.21-300-L-1"></a>It bears a <code>case</code> or <code>default</code> label.<br><br>        <em>   <a name="jls-14.21-300-L-2"></a>There is a statement preceding it in the switch block and that preceding statement can complete normally.<br><br></em></div>
   <a name="jls-14.21-300-M"></a>A <code>while</code> statement can complete normally iff at least one of the following is true:<br><br><div class="norm"><br><br><br>    <em>   <a name="jls-14.21-300-M-1"></a>The <code>while</code> statement is reachable and the condition expression is not a constant expression (<a href="http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.28" title="15.28. Constant Expressions" target="_blank" rel="external">§15.28</a>) with value <code>true</code>.

        </em>   <a name="jls-14.21-300-M-2"></a>There is a reachable <code>break</code> statement that exits the <code>while</code> statement.<br><br></div>


<p><a name="jls-14.21-300-M.1"></a>The contained statement is reachable iff the <code>while</code> statement is reachable and the condition expression is not a constant expression whose value is <code>false</code>.</p>
<ul>
<li><a name="jls-14.21-300-N"></a>A <code>do</code> statement can complete normally iff at least one of the following is true:</li>
</ul>
<div class="norm"><br><br><br>    <em>   <a name="jls-14.21-300-N-1"></a>The contained statement can complete normally and the condition expression is not a constant expression (<a href="http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.28" title="15.28. Constant Expressions" target="_blank" rel="external">§15.28</a>) with value<code>true</code>.

        </em>   <a name="jls-14.21-300-N-2"></a>The <code>do</code> statement contains a reachable <code>continue</code> statement with no label, and the <code>do</code> statement is the innermost <code>while</code>, <code>do</code>, or <code>for</code>statement that contains that <code>continue</code> statement, and the <code>continue</code> statement continues that <code>do</code> statement, and the condition expression is not a constant expression with value <code>true</code>.<br><br>        <em>   <a name="jls-14.21-300-N-3"></a>The <code>do</code> statement contains a reachable <code>continue</code> statement with a label <code>L</code>, and the <code>do</code> statement has label <code>L</code>, and the <code>continue</code>statement continues that <code>do</code> statement, and the condition expression is not a constant expression with value <code>true</code>.

        </em>   <a name="jls-14.21-300-N-4"></a>There is a reachable <code>break</code> statement that exits the <code>do</code> statement.<br><br></div>


<p><a name="jls-14.21-300-N.1"></a>The contained statement is reachable iff the <code>do</code> statement is reachable.</p>
<ul>
<li><a name="jls-14.21-300-O"></a>A basic <code>for</code> statement can complete normally iff at least one of the following is true:</li>
</ul>
<div class="norm"><br><br><br>    <em>   <a name="jls-14.21-300-O-1"></a>The <code>for</code> statement is reachable, there is a condition expression, and the condition expression is not a constant expression (<a href="http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.28" title="15.28. Constant Expressions" target="_blank" rel="external">§15.28</a>) with value <code>true</code>.

        </em>   <a name="jls-14.21-300-O-2"></a>There is a reachable <code>break</code> statement that exits the <code>for</code> statement.<br><br></div>


<p><a name="jls-14.21-300-O.1"></a>The contained statement is reachable iff the <code>for</code> statement is reachable and the condition expression is not a constant expression whose value is <code>false</code>.</p>
<ul>
<li><p><a name="jls-14.21-300-P"></a>An enhanced <code>for</code> statement can complete normally iff it is reachable.</p>
</li>
<li><p><a name="jls-14.21-300-Q"></a>A <code>break</code>, <code>continue</code>, <code>return</code>, or <code>throw</code> statement cannot complete normally.</p>
</li>
<li><p><a name="jls-14.21-300-R"></a>A <code>synchronized</code> statement can complete normally iff the contained statement can complete normally.</p>
</li>
</ul>
<p><a name="jls-14.21-300-R.1"></a>The contained statement is reachable iff the <code>synchronized</code> statement is reachable.</p>
<ul>
<li><a name="jls-14.21-300-S"></a>A <code>try</code> statement can complete normally iff both of the following are true:</li>
</ul>
<div class="norm"><br><br><br>    <em>   <a name="jls-14.21-300-S-1"></a>The <code>try</code> block can complete normally or any <code>catch</code> block can complete normally.

        </em>   <a name="jls-14.21-300-S-2"></a>If the <code>try</code> statement has a <code>finally</code> block, then the <code>finally</code> block can complete normally.<br><br></div><br><em>   <a name="jls-14.21-300-T"></a>The <code>try</code> block is reachable iff the <code>try</code> statement is reachable.

</em>   <a name="jls-14.21-300-U"></a>A <code>catch</code> block <code>C</code> is reachable iff both of the following are true:<br><br><div class="norm"><br><br><br>    <em>   <a name="jls-14.21-300-U-1"></a>Either the type of <code>C</code>‘s parameter is an unchecked exception type or <code>Throwable</code>; or some expression or <code>throw</code> statement in the <code>try</code>block is reachable and can throw a checked exception whose type is assignable to the parameter of the <code>catch</code> clause <code>C</code>.<br><br>    <a name="jls-14.21-300-U-1.1"></a>An expression is reachable iff the innermost statement containing it is reachable.<br><br>    See <a href="http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.6" title="15.6. Normal and Abrupt Completion of Evaluation" target="_blank" rel="external">§15.6</a> for normal and abrupt completion of expressions.

        </em>   <a name="jls-14.21-300-U-2"></a>There is no earlier <code>catch</code> block <code>A</code> in the <code>try</code> statement such that the type of <code>C</code>‘s parameter is the same as or a subclass of the type of<code>A</code>‘s parameter.<br><br></div><br><em>   <a name="jls-14.21-300-V"></a>The <span class="emphasis"><em>Block</em></span> of a <code>catch</code> block is reachable iff the <code>catch</code> block is reachable.

</em>   <a name="jls-14.21-300-W"></a>If a <code>finally</code> block is present, it is reachable iff the <code>try</code> statement is reachable.<br><br>


<p>One <span class="emphasis"><em>might expect</em></span> the <code>if</code> statement to be handled in the following manner:</p>
<div class="note"><br><br><br><em>   An <code>if-then</code> statement can complete normally iff at least one of the following is true:<br><br><div class="note">


    </div></em>   The <code>if-then</code> statement is reachable and the condition expression is not a constant expression whose value is <code>true</code>.<br><br>        *   The <code>then</code>-statement can complete normally.<br><br></div>


<p>The <code>then</code>-statement is reachable iff the <code>if-then</code> statement is reachable and the condition expression is not a constant expression whose value is <code>false</code>.</p>
<ul>
<li>An <code>if-then-else</code> statement can complete normally iff the <code>then</code>-statement can complete normally or the <code>else</code>-statement can complete normally.</li>
</ul>
<p>The <code>then</code>-statement is reachable iff the <code>if-then-else</code> statement is reachable and the condition expression is not a constant expression whose value is<code>false</code>.</p>
<p>The <code>else</code>-statement is reachable iff the <code>if-then-else</code> statement is reachable and the condition expression is not a constant expression whose value is <code>true</code>.</p>
<p></p>
<p>This approach would be consistent with the treatment of other control structures. However, in order to allow the if statement to be used conveniently for “conditional compilation” purposes, the actual rules differ.</p>
<p>As an example, the following statement results in a compile-time error:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">while</span> (<span class="keyword">false</span>) &#123; x=<span class="number">3</span>; &#125;</div><div class="line">&gt; </div><div class="line">&gt;</div></pre></td></tr></table></figure>
<p>because the statement <code>x=3;</code> is not reachable; but the superficially similar case:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="keyword">false</span>) &#123; x=<span class="number">3</span>; &#125;</div><div class="line">&gt; </div><div class="line">&gt;</div></pre></td></tr></table></figure>
<p>does not result in a compile-time error. An optimizing compiler may realize that the statement <code>x=3;</code> will never be executed and may choose to omit the code for that statement from the generated <code>class</code> file, but the statement <code>x=3;</code> is not regarded as “unreachable” in the technical sense specified here.</p>
<p>The rationale for this differing treatment is to allow programmers to define “flag variables” such as:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">boolean</span> DEBUG = <span class="keyword">false</span>;</div><div class="line">&gt; </div><div class="line">&gt;</div></pre></td></tr></table></figure>
<p>and then write code such as:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">if</span> (DEBUG) &#123; x=<span class="number">3</span>; &#125;</div><div class="line">&gt; </div><div class="line">&gt;</div></pre></td></tr></table></figure>
<p>The idea is that it should be possible to change the value of <code>DEBUG</code> from <code>false</code> to <code>true</code> or from <code>true</code> to <code>false</code> and then compile the code correctly with no other changes to the program text.</p>
<p>This ability to “conditionally compile” has a significant impact on, and relationship to, binary compatibility (<a href="http://docs.oracle.com/javase/specs/jls/se7/html/jls-13.html" title="Chapter 13. Binary Compatibility" target="_blank" rel="external">§13</a>). If a set of classes that use such a “flag” variable are compiled and conditional code is omitted, it does not suffice later to distribute just a new version of the class or interface that contains the definition of the flag. A change to the value of a flag is, therefore, not binary compatible with pre-existing binaries (<a href="http://docs.oracle.com/javase/specs/jls/se7/html/jls-13.html#jls-13.4.9" title="13.4.9. final Fields and Constants" target="_blank" rel="external">§13.4.9</a>). (There are other reasons for such incompatibility as well, such as the use of constants in <code>case</code> labels in <code>switch</code> statements; see <a href="http://docs.oracle.com/javase/specs/jls/se7/html/jls-13.html#jls-13.4.9" title="13.4.9. final Fields and Constants" target="_blank" rel="external">§13.4.9</a>.)</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/01/16/assertion/" itemprop="url">
                  Assertion
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-01-16T01:28:54+08:00" content="2015-01-16">
              2015-01-16
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Basics/" itemprop="url" rel="index">
                    <span itemprop="name">Basics</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/01/16/assertion/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/01/16/assertion/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Java have an “assert” keyword since java 1.4</p>
<h4 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h4><p>There are two kinds of syntax:</p>
<p>1) assert expression1</p>
<p>2) assert expression1 : expression2</p>
<p>expression1 must be evaluated as boolean ( true or false) while expression2 can be primitive, object, or array.</p>
<p>expression2 is passed into the constructor of AssertionError as an argument.</p>
<p><a href="/media/44b0b3e9.png"><img src="/media/44b0b3e9.png" alt="44b0b3e9"></a></p>
<p>So if expression2 is evaluated as void, it’s not allowed.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="keyword">assert</span> <span class="keyword">true</span> : foo(); <span class="comment">// cannot be compiled</span></div></pre></td></tr></table></figure></p>
<h4 id="How-to-enable-or-disable-assertion"><a href="#How-to-enable-or-disable-assertion" class="headerlink" title="How to enable or disable assertion"></a>How to enable or disable assertion</h4><p>Assert statements will be evaluated only if assertion is enabled.</p>
<p>1) through command options (aka. VM options)</p>
<p><table id="table3" border="1" width="60%"></table></p>
<p><tbody></tbody></p>
<p><tr></tr></p>
<p><td>Options</td></p>
<p><td>Example</td></p>
<p><td>Description</td><br></p>
<p><tr></tr></p>
<p><td>-ea</td></p>
<p><td>java -ea</td></p>
<p><td>open assertion in all user classes</td><br></p>
<p><tr></tr></p>
<p><td>-da</td></p>
<p><td>java -da</td></p>
<p><td>close assertion in all user classes</td><br></p>
<p><tr></tr></p>
<p><td>-ea:&lt;classname&gt;</td></p>
<p><td>java -ea:MyClass1</td></p>
<p><td>open assertion in class MyClass1</td><br></p>
<p><tr></tr></p>
<p><td>-da:&lt;classname&gt;</td></p>
<p><td>java -da: MyClass1</td></p>
<p><td>close assertion in class MyClass1</td><br></p>
<p><tr></tr></p>
<p><td>-ea:&lt;packagename&gt;</td></p>
<p><td>java -ea:pkg1</td></p>
<p><td>open assertion in package pkg1</td><br></p>
<p><tr></tr></p>
<p><td>-da:&lt;packagename&gt;</td></p>
<p><td>java -da:pkg1</td></p>
<p><td>close assertion in package pkg1</td><br></p>
<p><tr></tr></p>
<p><td>-ea:…</td></p>
<p><td>java -ea:…</td></p>
<p><td>open assertion in default(no name) package</td><br></p>
<p><tr></tr></p>
<p><td>-da:…</td></p>
<p><td>java -da:…</td></p>
<p><td>close assertion in default(no name) package</td><br></p>
<p><tr></tr></p>
<p><td>-ea:&lt;packagename&gt;…</td></p>
<p><td>java -ea:pkg1…</td></p>
<p><td>open assertion in package pkg1 and its subpackage</td><br></p>
<p><tr></tr></p>
<p><td>-da:&lt;packagename&gt;…</td></p>
<p><td>java -da:pkg1…</td></p>
<p><td>close assertion in package pkg1 and its subpackage</td><br></p>
<p><tr></tr></p>
<p><td>-esa</td></p>
<p><td>java -esa</td></p>
<p><td>open assertion in system classes</td><br></p>
<p><tr></tr></p>
<p><td>-dsa</td></p>
<p><td>java -dsa</td></p>
<p><td>close assertion in system classes</td><br></p>
<p><tr></tr></p>
<p><td>use class and package together</td></p>
<p><td>java -da:MyClass1:pkg1</td></p>
<p><td>close assertion in class MyClass1 and package pkg1</td><br></p>
<p><tr></tr></p>
<p><td>use -ea and -da together</td></p>
<p><td>java -da:MyClass1 -ea:MyClass</td></p>
<p><td>java interprets its options from left to right</td><br><br><br><br>2) through ClassLoader at runtime</p>
<p>ClassLoader class has some methods related to assertion setting:<br><a href="/media/f918c7a0.bmp"><img src="/media/f918c7a0.bmp" alt="f918c7a0"></a></p>
<h4 id="Some-restrictions-and-pitfalls"><a href="#Some-restrictions-and-pitfalls" class="headerlink" title="Some restrictions and pitfalls"></a>Some restrictions and pitfalls</h4><p>1) assertion and inheritance</p>
<p>The following is an example:<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> <span class="keyword">extends</span> <span class="title">Base</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">derivedMethod</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">assert</span> <span class="keyword">false</span> : <span class="string">"Assertion failed:This is derive"</span>;<span class="comment">//assertion always fails</span></div><div class="line">        System.out.println(<span class="string">"Derived Method"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            Derived derived = <span class="keyword">new</span> Derived();</div><div class="line">            derived.baseMethod();</div><div class="line">            derived.derivedMethod();</div><div class="line">        &#125; <span class="keyword">catch</span> (AssertionError ae) &#123;</div><div class="line">            System.out.println(ae);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Now we use all kinds of command options and see the output results:</p>
<p><table id="table4" style="height: 326px;" border="1" width="745"></table></p>
<p><tbody></tbody></p>
<p><tr></tr></p>
<p><td>Command options</td></p>
<p><td>Description</td></p>
<p><td>Output</td><br></p>
<p><tr></tr></p>
<p><td>Java Derived</td></p>
<p><td>close all assertions(default)</td></p>
<p><td>Base Method<br>Derived Method</td><br></p>
<p><tr></tr></p>
<p><td>Java -ea Derived</td></p>
<p><td>open all assertions</td></p>
<p><td>Java.lang.AssertionError:Assertion Failed:This is base</td><br></p>
<p><tr></tr></p>
<p><td>Java -da Derived</td></p>
<p><td>close all assertions</td></p>
<p><td>Base Method<br>Derived Method</td><br></p>
<p><tr></tr></p>
<p><td>Java -ea:Base Derived</td></p>
<p><td>open the assertion in Base class</td></p>
<p><td>Java.lang.AssertionError:Assertion Failed:This is base</td><br></p>
<p><tr></tr></p>
<p><td>Java -ea:Derived Derived</td></p>
<p><td>close the assertion in Derived class</td></p>
<p><td>Base Method<br>Java.lang.AssertionError:Assertion Failed:This is derived</td><br><br><br><br><span style="text-decoration: underline;">Conclusion: assertion setting cannot be inherited. Just enabling the assertion of derived class will not necessarily take effect for the assertions in the inherited methods and other methods of its base class.</span></p>
<h4 id="Best-bad-usage-scenarios"><a href="#Best-bad-usage-scenarios" class="headerlink" title="Best/bad usage scenarios"></a>Best/bad usage scenarios</h4><p>1) it’s preferable to assert the arguments of private method.</p>
<p>You should not use assertions to check arguments in public methods because it would otherwise throw runtime exceptions: IllegalArgumentException, NullPointerException, and so forth.</p>
<p>2) it’s BAD flavour that assertion has some side effects<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> a = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">foo</span><span class="params">()</span> </span>&#123;</div><div class="line">    a = <span class="number">4</span>;</div><div class="line">    <span class="keyword">return</span> <span class="string">"sss"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">assertSomething</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">assert</span> <span class="keyword">false</span> : a++; <span class="comment">// This has a side effect</span></div><div class="line">    <span class="keyword">assert</span> <span class="keyword">false</span>: foo(); <span class="comment">// This also has a side effect</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>As assertion can be disabled, so there will be something strange to happen if you do something depending on assertion fails.</p>
<p>In the above example, if assertion is disabled, then the variable will be unchanged.</p>
<p>3) in if-then-else and swith-case flow-control statements, you can add “assert false;” in unexpected branch of control.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">switch</span>(x) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="number">1</span>: …;</div><div class="line">    <span class="keyword">case</span> <span class="number">2</span>: …;</div><div class="line">    <span class="keyword">case</span> <span class="number">3</span>: …</div><div class="line">    <span class="keyword">default</span>: <span class="keyword">assert</span> <span class="keyword">false</span> : <span class="string">"x value is invalid: "</span> + x;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(a==<span class="number">1</span>) &#123;</div><div class="line">    <span class="comment">// some codes here</span></div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> &#123;</div><div class="line">    <span class="comment">// some codes here</span></div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">assert</span> <span class="keyword">false</span> : <span class="string">"Normally, it cannot be here"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>This is a defensive technology when you do some test. We can generalize this good style into other similar cases, for example, when you think some place in your code will never be reached. In these cases, the assertion is very useful, because once the assertion fails, there will be something critical logic errors or some programming faults.</p>
<p>4) You should not use assertions to validate your business logic and avoid using assertions to check or validate method arguments.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/01/14/inner-classes/" itemprop="url">
                  Inner Classes
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-01-14T10:53:54+08:00" content="2015-01-14">
              2015-01-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Basics/" itemprop="url" rel="index">
                    <span itemprop="name">Basics</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/01/14/inner-classes/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/01/14/inner-classes/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>There are 4 kinds of inner classes:</p>
<ul>
<li>Member classes (non-static inner classes)</li>
<li>Local classes</li>
<li>Anonymous classes</li>
<li>Nested top-level classes and interfaces (static inner classes)<br>The former three kinds are called <em><strong>inner classes</strong></em>.</li>
</ul>
<p>The last kind is called <em><strong>nested class</strong></em>.</p>
<p>&nbsp;</p>
<p>Member interface is implicitly static, so it’s never considered as inner class.</p>
<h4 id="Member-classes"><a href="#Member-classes" class="headerlink" title="Member classes"></a>Member classes</h4><p><span style="color: #ff0000;"><strong>What is a member class?</strong></span></p>
<p>A <em>member class</em> is a class that is defined inside the definition of another class, <em>(without the use of the static modifier as is the case with a nested top-level class).
</em></p>
<p>An object of the member class must be internally linked to an object of the enclosing class, <em>(which is not the case with a nested top-level class).</em></p>
<p>Thus, a member class is truly an inner class.  <em>(An object of the member class cannot exist in the absence of an object of the enclosing class.)</em></p>
<p><span style="color: #ff0000;"><strong>What about a member interface?</strong></span></p>
<p>Interfaces defined within classes are implicitly static.  This means that they are always <em>top-level.</em>  There is no such thing as a member interface, a local interface, or an anonymous interface.</p>
<p>不存在member interface！！</p>
<p><span style="color: #ff0000;"><strong>Why use member classes?</strong></span></p>
<p>Probably the most important benefit of member classes has to do with accessing the other members of enclosing classes.  The methods of a member class have direct access to all the members of the enclosing classes, including private members.  Thus the use of member classes can eliminate the requirement to connect objects together via constructor parameters.</p>
<p>This is particularly useful in those cases where there is no reason for an object of a member class to exist in the absence of an object of the enclosing class, and where the methods of the object of the member class need access to members of the object of the enclosing class.</p>
<hr>
<blockquote>
<p>_</p>
<p>“A class defined as a member (non-static) of another.  Each instance has an enclosing instance, and can use its members.  New syntax for <strong>this</strong>, <strong>new</strong>, and <strong>super</strong>.  Cannot have <strong>static </strong>members.  Cannot have same name as containing class.”_<br>The main features of member classes are:</p>
</blockquote>
<ul>
<li>Every instance of a member class is internally associated with an instance of the class that defines or contains the member class.</li>
<li>The methods of a member class can implicitly refer to the fields defined within the member class, as well as those defined by any enclosing class, including <strong>private </strong>fields of the enclosing class.<br>1) Because the object of that inner class has a reference to the object of the enclosing object, so it can access the members of the enclosing object.<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sequence</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Object[] items;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> next = <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Sequence</span><span class="params">(<span class="keyword">int</span> size)</span> </span>&#123; items = <span class="keyword">new</span> Object[size]; &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Object x)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(next &amp;lt; items.length)</div><div class="line">            items[next++] = x;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">SequenceSelector</span> <span class="keyword">implements</span> <span class="title">Selector</span> </span>&#123;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">end</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> i == items.length; &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> Object <span class="title">current</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> items[i]; &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">next</span><span class="params">()</span> </span>&#123; <span class="keyword">if</span>(i &amp;lt; items.length) i++; &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> Selector <span class="title">selector</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SequenceSelector();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Sequence sequence = <span class="keyword">new</span> Sequence(<span class="number">10</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &amp;lt; <span class="number">10</span>; i++)</div><div class="line">            sequence.add(Integer.toString(i));</div><div class="line">        Selector selector = sequence.selector();</div><div class="line">        <span class="keyword">while</span>(!selector.end()) &#123;</div><div class="line">            System.out.print(selector.current() + <span class="string">" "</span>);</div><div class="line">            selector.next();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>2) To construct a object of the inner class, you should use the <span style="text-decoration: underline;"><strong>.new</strong></span> syntax<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AAA</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BBB</span> </span>&#123;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CCC</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        AAA aaa = <span class="keyword">new</span> AAA();</div><div class="line">        AAA.BBB bbb = aaa.new BBB();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>3) To get the reference of the out-class object, you should use the <strong><span style="text-decoration: underline;">.this</span></strong> syntax<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DotThis</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123; System.out.println(<span class="string">"DotThis.f()"</span>); &#125;</div><div class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Inner</span> </span>&#123;</div><div class="line">        <span class="function"><span class="keyword">public</span> DotThis <span class="title">outer</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> DotThis.<span class="keyword">this</span>;</div><div class="line">            <span class="comment">// A plain "this" would be Inner’s "this"</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> Inner <span class="title">inner</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="keyword">new</span> Inner(); &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        DotThis dt = <span class="keyword">new</span> DotThis();</div><div class="line">        DotThis.Inner dti = dt.inner();</div><div class="line">        dti.outer().f();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>4) Member classes can be private or protected (also public, package), but non-inner (top level) classes can be only public or package. So if you expose some inner class types to client programmer, they may have no access to these type.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">DogTail</span> </span>&#123;&#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> DogTail <span class="title">showYourTail</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DogTail();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClientProgrammer</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Dog dog = <span class="keyword">new</span> Dog();</div><div class="line">        <span class="comment">// compiler error: Dog.DogTail has private access in "Dog"</span></div><div class="line">        <span class="comment">// Dog.DogTail dogTail = dog.showYourTail();</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Although the definition of Dog class can be compiled normally, the user of this class cannot be compiled when they want to get the return type of showYourTail() method.</p>
<p>In this case, a good fixture is to upcast the inner class to a public base class/interface like the following code:<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tail</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">DogTail</span> <span class="keyword">extends</span> <span class="title">Tail</span> </span>&#123;&#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Tail <span class="title">showYourTail</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DogTail();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClientProgrammer</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Dog dog = <span class="keyword">new</span> Dog();</div><div class="line">        Tail dogTail = dog.showYourTail();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>5) Member classes cannot have <strong>static</strong> members<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;pre&amp;gt;<span class="class"><span class="keyword">class</span> <span class="title">AAAAA</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BBBBB</span> </span>&#123;</div><div class="line">        <span class="comment">//static int a =1; // Cannot compile</span></div><div class="line">        <span class="comment">//static void foo() &#123;&#125; // Cannot compile</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>5) Member classes cannot have the same name as its enclosing class<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AAAAA</span> </span>&#123;</div><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">AAAAA</span> </span>&#123; <span class="comment">// Cannot compile: Duplicate class</span></div><div class="line"></div><div class="line"> &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><span style="color: #ff0000;"><strong>What does compiler do?</strong></span></p>
<p>Every class definition in a Java program, including nested top-level classes, member classes, local classes, and anonymous classes, produces a class file when the program is compiled.  According to Flanagan,</p>
<blockquote>
<p><em>“The Java Virtual Machine knows nothing about nested top-level classes and interfaces or the various types of inner classes.  Therefore, the Java compiler must convert these new types into standard non-nested class files that the Java interpreter can understand.  This is done through source code transformations that insert <span style="color: #0000ff;">$</span> characters into nested class names.   These source code transformations may also insert hidden fields, methods, and constructor arguments into the affected classes.”</em><br><span style="color: #000000;"><strong>A reference to the containing object</strong></span></p>
</blockquote>
<p>For example, the compiler automatically inserts a <span style="text-decoration: underline;">private instance variable</span> in the member class to hold a reference to the containing object.  It also inserts a hidden argument in all constructors for the member class, and passes the containing object’s reference to the constructor for the member class.  The modified constructor saves that reference in the private instance variable of the object of the member class.  Thus each object instantiated from the member class contains a private reference to the containing object.</p>
<p><span style="color: #000000;"><strong>Accessing private members</strong></span></p>
<p>In those cases where it is necessary for an object of the member class to access private members of the containing object, the compiler automatically creates and uses accessor methods that make such access possible.</p>
<p><a href="http://www.developer.com/java/other/article.php/3085271/The-Essence-of-OOP-using-Java-Member-Classes.htm#Complete_program_listing" target="_blank" rel="external">http://www.developer.com/java/other/article.php/3085271/The-Essence-of-OOP-using-Java-Member-Classes.htm#Complete_program_listing</a></p>
<h4 id="Local-classes"><a href="#Local-classes" class="headerlink" title="Local classes"></a>Local classes</h4><p><span style="color: #ff0000;"><strong>What is a local class?</strong></span></p>
<p>A <em>local class</em> is a class that is defined within a block of Java code.  While local classes are probably most frequently defined within methods and constructors, they can also be defined inside static initializer blocks and instance initializers.</p>
<p>As is the case for an object of a member class <em>(discussed in the previous lesson),</em> an object of a local class must be internally linked to an object of the enclosing class.  I will often refer to that object as the containing object, and make comments about the containment hierarchy.</p>
<p>Thus, a local class is truly an inner class, because an object of the local class cannot exist in the absence of an object of the enclosing class.</p>
<p><span style="color: #ff0000;"><strong>What about a local interface?</strong></span></p>
<p>Interfaces defined within classes are implicitly static.  This means that they are always <em>top-level.</em>  <span style="text-decoration: underline; color: #800000;">There is no such thing as a member interface, a local interface, or an anonymous interface.</span></p>
<p><span style="color: #ff0000;"><strong>Why use local classes?</strong></span></p>
<p>Objects instantiated from local classes share many of the characteristics of objects instantiated from member classes.  However, in some cases, a local class can be defined closer to its point of use than would be possible with a member class, leading to improved code readability.</p>
<p>Probably the most important benefit of local classes has to do with accessing the members of enclosing classes.  Just like with member classes, methods of a local class have direct access to all the members of the enclosing classes, including private members.  Thus the use of local classes can sometimes eliminate the requirement to connect objects together via constructor parameters.</p>
<p><span style="color: #000000;"><strong>Can be particularly useful when …</strong></span></p>
<p>A local class can be particularly useful in those cases where</p>
<ul>
<li>There is no reason for an object of the local class to exist in the absence of an object of the enclosing class</li>
<li>There is no reason for an object of the local class to exist outside a method of the enclosing class</li>
<li>Methods of the object of the local class need access to members of the object of the enclosing class</li>
<li>Methods of the object of the local class need access to final local variables and method parameters belonging to the method in which the local class is defined<br><strong><span style="color: #ff0000;">Local classes versus member classes</span></strong></li>
</ul>
<p>A local class has approximately the same relationship to a member class that a local variable in a method has to an instance variable of the class containing the method.</p>
<p><span style="color: #ff0000;"><strong>The scope of a local class</strong></span></p>
<p>As is the case with local variables, the name of a local class is visible and usable only within the block of code in which it is defined <em>(and blocks nested within that block).</em>  Further, the name of the local class is visible and usable only to code following the class definition within that block.</p>
<p>The methods of a local class can use any <em><strong>final</strong></em> local variables or method parameters that are visible from the scope in which the local class is defined.</p>
<p><span style="color: #ff0000;"><strong>Similar to member classes</strong></span></p>
<p>As mentioned earlier, local classes have many characteristics in common with member classes.  This includes access to private fields and methods in the containing class.  The thing that separates local classes from member classes is the fact that local classes have access to local variables in the scope in which the local class is defined.</p>
<p><span style="color: #ff0000;"><strong>A big restriction</strong></span></p>
<p>There is a big restriction, however, on the ability of methods of the local class to access local variables and method parameters.  The methods in a local class can access local variables and method parameters only if they are declared <strong>final</strong>.</p>
<hr>
<blockquote>
<p>“ the methods in a local class don’t really have access to local variables and method parameters.  Rather, when an object of the local class is instantiated, copies of the <strong>final</strong> local variables and method parameters referred to by the object’s methods are stored as <span style="text-decoration: underline;">instance variables</span> in the object.  The methods in the object of the local class really access those hidden instance variables. “<br>Thus, the local variables and method parameters accessed by the methods of the local class must be declared <strong>final</strong> to prevent their values from changing after the object is instantiated.</p>
</blockquote>
<p><span style="color: #000000;"><strong>Restrictions on local classes</strong></span></p>
<p>As with member classes, local classes cannot contain <strong>static</strong> members.</p>
<p>As with local variables, local classes cannot be declared <strong>public</strong>,<strong> protected</strong>,<strong> private</strong>,<strong> </strong>or <strong>static</strong>.</p>
<p>A local class cannot have the same name as any of its enclosing classes.</p>
<p><span style="color: #ff0000;"><strong>What does compiler do?</strong></span></p>
<blockquote>
<p><em>“The Java Virtual Machine knows nothing about nested top-level classes and interfaces or the various types of inner classes.  Therefore, the Java compiler must convert these new types into standard non-nested class files that the Java interpreter can understand.  This is done through source code transformations that insert $ characters into nested class names.  These source code transformations may also insert hidden fields, methods, and constructor arguments into the affected classes.”</em><br><strong><span style="color: #000000;">A reference to the containing object</span></strong></p>
</blockquote>
<p>For example, the compiler automatically inserts a private instance variable in the local class to hold a reference to the containing object.  It also inserts a hidden argument in all constructors for the local class, and passes the containing object’s reference to the constructor for the local class.  The modified constructor saves that reference in the private instance variable of the object of the local class.  Thus each object instantiated from the local class contains a private reference to the containing object.</p>
<p><span style="color: #000000;"><strong>Accessing private members</strong></span></p>
<p>In those cases where it is necessary for an object of the local class to access private members of the containing object, the compiler automatically creates and uses accessor methods that make such access possible.</p>
<p>1) A class defined within a method<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tail</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Tail <span class="title">showYourTail</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="class"><span class="keyword">class</span> <span class="title">DogTail</span> <span class="keyword">extends</span> <span class="title">Tail</span> </span>&#123;&#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DogTail();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Because DogTail is defined in method showYourTail(), it cannot be accessed outside of showYourTail(). Any specifier is not allowed, like public/private/protected, static etc.</p>
<p>2) A class defined within a scope inside a method<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tail</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Tail <span class="title">showYourTail</span><span class="params">(<span class="keyword">boolean</span> flag)</span> </span>&#123;</div><div class="line">        Tail tail = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">if</span>(flag) &#123;</div><div class="line">            <span class="class"><span class="keyword">class</span> <span class="title">DogTail</span> <span class="keyword">extends</span> <span class="title">Tail</span> </span>&#123;&#125;</div><div class="line">            tail = <span class="keyword">new</span> DogTail();</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// Can’t use it here! Out of scope:</span></div><div class="line">        <span class="comment">// DogTail dt = new DogTail();</span></div><div class="line">        <span class="keyword">return</span> tail;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><a href="http://www.developer.com/java/other/article.php/3107181/The-Essence-of-OOP-using-Java-Local-Classes.htm" target="_blank" rel="external">http://www.developer.com/java/other/article.php/3107181/The-Essence-of-OOP-using-Java-Local-Classes.htm</a></p>
<p>&nbsp;</p>
<h4 id="Anonymous-classes"><a href="#Anonymous-classes" class="headerlink" title="Anonymous classes"></a>Anonymous classes</h4><p><span style="color: #ff0000;"><strong>What is an anonymous class?</strong></span></p>
<p>I’m going to begin my discussion with a quotation from one of my favorite authors, David Flanagan, author of <span style="text-decoration: underline;">Java in a Nutshell</span>.</p>
<blockquote>
<p><em>“An anonymous class is essentially a local class without a name.”</em><br>If you have read the previous lesson, you should know quite a lot about local classes at this point in time.  Continuing with Flanagan’s words,<br><em>“Instead of defining a local class and then instantiating it, you can often use an anonymous class to combine these two steps…  an anonymous class is defined by a Java expression, not a Java statement.  This means that an anonymous class definition can be included within a larger Java expression…”</em><br>As you will see from the sample program in this lesson, anonymous class definitions are often included as arguments to method calls.</p>
</blockquote>
<p>As is the case for an object of a member class or a local class <em>(discussed in previous lessons),</em> an object of an anonymous class must be internally linked to an object of the enclosing class.</p>
<p>Thus, an anonymous class is truly an inner class, because an object of the anonymous class cannot exist in the absence of an object of the enclosing class.</p>
<p><span style="color: #ff0000;"><strong>What about an anonymous interface?</strong></span></p>
<p>Interfaces defined within classes are implicitly static.  This means that they are always <em>top-level.</em>  There is no such thing as a member interface, a local interface, or an anonymous interface.</p>
<p><span style="color: #ff0000;"><strong>Why use anonymous classes?</strong></span></p>
<p>As with local classes, objects instantiated from anonymous classes share many of the characteristics of objects instantiated from member classes.  However, in some cases, an anonymous class can be defined closer to its point of use than would be possible with a member class or a local class.  Once you become accustomed to the somewhat cryptic syntax used with anonymous classes, this can often lead to improved code readability.</p>
<p>Probably the most important benefit of anonymous classes has to do with accessing the members of enclosing classes.  Just like with member classes and local classes, methods of an anonymous class have direct access to all the members of the enclosing classes, including private members.  Thus the use of anonymous classes can often eliminate the requirement to connect objects together via constructor parameters.</p>
<p>In addition, although not demonstrated in this lesson, as with local classes, objects of anonymous classes have access to <strong>final</strong> local variables that are declared within the scope of the anonymous class.</p>
<p><span style="color: #000000;"><strong>Can be particularly useful when …</strong></span></p>
<p>An anonymous class can be particularly useful in those cases where</p>
<ul>
<li>There is no reason for an object of the anonymous class to exist in the absence of an object of the enclosing class.</li>
<li>There is no reason for an object of the anonymous class to exist outside a method of the enclosing class.</li>
<li>Methods of the object of the anonymous class need access to members of the object of the enclosing class.</li>
<li>Methods of the object of the anonymous class need access to <strong>final </strong>local variables and method parameters belonging to the method in which the anonymous class is defined.</li>
<li>Only one instance of the anonymous class is needed.</li>
<li>There is no need for the class to have a name that is accessible elsewhere in the program.<br><strong><span style="color: #ff0000;">Anonymous classes versus local classes</span></strong><blockquote>
<p><em>“…an anonymous class behaves just like a local class, and is distinguished from a local class merely in the syntax used to define and instantiate it.”</em><br>Unlike a local class, however, an anonymous class cannot define a constructor.  An anonymous class can define an instance initializer, which can provide some of the benefits of a constructor.</p>
</blockquote>
</li>
</ul>
<p><span style="color: #ff0000;"><strong>Restrictions on the use of anonymous classes</strong></span></p>
<p>Because an anonymous class has no name, and the definition and instantiation of the class appear in a single expression, only one instance of each anonymous class can be created.  If you need more than one instance of the class, you should probably use a local class, a member class, or a top-level class instead.</p>
<p>As mentioned above, it is not possible to define constructors for anonymous classes.  If you need to use a constructor when you instantiate the class, you should probably use a local class, a member class, or a top-level class instead.</p>
<p>As with member classes and local classes, anonymous classes cannot contain <strong>static</strong> members.</p>
<p>As with local variables and local classes, anonymous classes cannot be declared <strong>public</strong>,<strong> protected</strong>,<strong>private</strong>,<strong> </strong>or <strong>static</strong>.  In fact, no modifiers can be specified in the definition of an anonymous class.</p>
<p><span style="color: #ff0000;"><strong>What does compiler do?</strong></span></p>
<p>The methods in an anonymous class don’t really have access to local variables and method parameters.  Rather, when an object of the anonymous class is instantiated, copies of the <strong>final</strong> local variables and method parameters referred to by the object’s methods are stored as instance variables in the object.  The methods in the object of the anonymous class really access those hidden instance variables.</p>
<p>Thus, the local variables and method parameters accessed by the methods of the local class must be declared <strong>final</strong> to prevent their values from changing after the object is instantiated.</p>
<p>Generally speaking, this involves the automatic generation of code to cause things to behave as they do.  The good news is that you don’t have to write that extra code, and you don’t have to maintain it.  The extra code is written for you, and if you modify your class structure, the extra code is automatically modified accordingly.</p>
<p>1) An anonymous class extending a class that has a default constructor<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tail</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Tail <span class="title">showYourTail</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Tail() &#123;</div><div class="line">            <span class="comment">// blabla</span></div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>2) An anonymous class extending a class that has a non-default constructor<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tail</span> </span>&#123;</div><div class="line">    Tail(<span class="keyword">int</span> x) &#123;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Tail <span class="title">showYourTail</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Tail(x) &#123;</div><div class="line">            <span class="comment">// blabla</span></div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>3) An anonymous class that performs field initialization<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Tail <span class="title">showYourTail</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">final</span> String dest = <span class="string">"1"</span>;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Tail() &#123;</div><div class="line">            <span class="keyword">private</span> String label = dest;</div><div class="line">            <span class="comment">// blabla</span></div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>In this example, the dest must be “final”, but why?</p>
<p>// TODO</p>
<p>4) An anonymous class that performs construction using instance initialization (anonymous inner classes cannot have constructors)</p>
<p>If simply assigning a field is not enough, how can you perform some constructor activity?<br>You can’t have a named constructor in an anonymous class (since there’s no name!), but with instance initialization, you can, in effect, create a constructor for an anonymous inner class, like this:<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Tail <span class="title">showYourTail</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">final</span> String dest = <span class="string">"1"</span>;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Tail() &#123;</div><div class="line">            <span class="keyword">private</span> String label = dest;</div><div class="line">            <span class="keyword">private</span> <span class="keyword">boolean</span> flag;</div><div class="line">            &#123;</div><div class="line">              <span class="keyword">if</span>(<span class="string">"1"</span>.equals(label)) flag = <span class="keyword">false</span>;</div><div class="line">              System.out.println(<span class="string">"instance initialisation"</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// blabla</span></div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="Nested-top-level-classes-and-interfaces-static-inner-classes"><a href="#Nested-top-level-classes-and-interfaces-static-inner-classes" class="headerlink" title="Nested top-level classes and interfaces (static inner classes)"></a>Nested top-level classes and interfaces (static inner classes)</h4><p><span style="color: #ff0000;"><strong>What is a nested top-level class or interface?</strong></span></p>
<blockquote>
<p><em>“A nested top-level class or interface is defined as a static member of an enclosing top-level class or interface.  The definition of a nested top-level class uses the static modifier …  Nested interfaces are implicitly static …  and so are always top-level.  A nested top-level class or interface behaves just like a ‘normal’ class or interface …  The difference is that the name of a nested top-level class or interface includes the name of the class in which it is defined.”</em><br><span style="color: #ff0000;"><strong>Why use nested top-level classes or interfaces?</strong></span><br><em>“Nested top-level classes and interfaces are typically used as a convenient way to group related classes.”</em><br><span style="color: #000000;"><strong>Can be particularly useful when …</strong></span></p>
</blockquote>
<p>A particularly useful implementation of top-level classes occurs when the nested classes extend the enclosing class and override methods that are declared or defined in the enclosing class.  This makes it very convenient to construct a hierarchical API, which exhibits very useful polymorphic behavior, and which cannot easily be expanded.</p>
<p><span style="color: #ff0000;"><strong>What does compiler do?</strong></span></p>
<p><em>“The Java Virtual Machine knows nothing about nested top-level classes and interfaces or the various types of inner classes.  Therefore, the Java compiler must convert these new types into standard non-nested class files that the Java interpreter can understand.  This is done through source code transformations that insert $ characters into nested class names.  These source code transformations may also insert hidden fields, methods, and constructor arguments into the affected classes.”</em></p>
<p><a href="http://www.developer.com/java/other/article.php/3358491/The-Essence-of-OOP-using-Java-Nested-Top-Level-Classes.htm" target="_blank" rel="external">http://www.developer.com/java/other/article.php/3358491/The-Essence-of-OOP-using-Java-Nested-Top-Level-Classes.htm</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/01/14/interfaces/" itemprop="url">
                  interfaces
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-01-14T10:48:18+08:00" content="2015-01-14">
              2015-01-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/OOP/" itemprop="url" rel="index">
                    <span itemprop="name">OOP</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/01/14/interfaces/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/01/14/interfaces/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Before Java 8, interfaces are not allowed to have static method.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">SS</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bar</span><span class="params">()</span></span>; <span class="comment">// Cannot be compiled</span></div><div class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;&#125; <span class="comment">// Cannot be compiled</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The compiler complains: <strong>Extension methods</strong> are not supported at this language level.</p>
<p>But what are Extension methods? That’s a term defined in Java 8.</p>
<p>&nbsp;</p>
<p>As for interfaces, all elements in its definition body are public:</p>
<p>1) all fields are <span style="text-decoration: underline;">public</span>, <span style="text-decoration: underline;">final</span> and <span style="text-decoration: underline;">static</span> implicitly.</p>
<p>2) all methods are <span style="text-decoration: underline;">public</span> and <span style="text-decoration: underline;">abstract</span> implicitly.</p>
<p>3) all nested classes, interfaces are <span style="text-decoration: underline;">public</span> and static implicitly, cannot be private!<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Intfa</span></span>&#123;</div><div class="line">    <span class="comment">// this is public and static nested class implicitly</span></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">nestedClass</span> </span>&#123;&#125;</div><div class="line">    <span class="comment">// this is public and static nested interface implicitly</span></div><div class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">nestedInterface</span> </span>&#123;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>4) static methods are not allowed. member classes or interfaces are not allowed (and has no way to declare).</p>
<p>An appropriate guideline is to <strong><em>prefer classes to interfaces</em></strong>. Start with classes, and if it becomes clear that interfaces are necessary, then refactor.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://qph.is.quoracdn.net/main-thumb-27403014-200-azcnfpakpayhgojvmueqcfjeyufbjpcx.jpeg"
               alt="Richard Yang" />
          <p class="site-author-name" itemprop="name">Richard Yang</p>
          <p class="site-description motion-element" itemprop="description">Nothing seek, nothing find</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">133</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">48</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="http://linkedin.com/in/richdyang" target="_blank" title="Linkedin">
                  
                    <i class="fa fa-fw fa-linkedin"></i>
                  
                  Linkedin
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://github.com/richdyang" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-github-alt"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://bitbucket.org/richdyang" target="_blank" title="Bitbucket">
                  
                    <i class="fa fa-fw fa-bitbucket"></i>
                  
                  Bitbucket
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://stackoverflow.com/users/4344443/richard" target="_blank" title="Stackoverflow">
                  
                    <i class="fa fa-fw fa-stack-overflow"></i>
                  
                  Stackoverflow
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://twitter.com/richdyang" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2013 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Richard Yang</span>
</div>

<!--div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div-->

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'richyang';
      var disqus_identifier = 'page/8/index.html';
      var disqus_title = '';

      function run_disqus_script(disqus_script) {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');

      

    </script>
  




  
  

  

  

  
  

  
  
  
  <link rel="stylesheet" href="/vendors/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/vendors/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.0"></script>



</body>
</html>
