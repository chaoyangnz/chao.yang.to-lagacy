<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Richard Yang, Java Developer, Senior software engineer" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="Nothing seek, nothing find">
<meta property="og:type" content="website">
<meta property="og:title" content="Richard Yang">
<meta property="og:url" content="https://richyang.me/page/4/index.html">
<meta property="og:site_name" content="Richard Yang">
<meta property="og:description" content="Nothing seek, nothing find">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Richard Yang">
<meta name="twitter:description" content="Nothing seek, nothing find">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    },
    algolia: {
      applicationID: 'X0H1P7HDKY',
      apiKey: 'ddc0af00a6e07c9b1be9f4da4cf5b9d9',
      indexName: 'richyang.me',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>




  <title> Richard Yang </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <!--span class="logo-line-before"><i></i></span-->
      <span class="site-title">Richard Yang</span>
      <!--span class="logo-line-after"><i></i></span-->
    </a>
  </div>
  <p class="site-subtitle">Full-stack software engineer mainly focusing on Java-based technologies and web front-end</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            Home
          </a>
        </li>
        
      
        
        
        <li class="menu-item menu-item-books">
          <a href="https://www.gitbook.com/@richdyang" rel="section">
            
            Books
          </a>
        </li>
        
      
        
        
        <li class="menu-item menu-item-showcase">
          <a href="/showcase" rel="section">
            
            Showcase
          </a>
        </li>
        
      
        
        
        <li class="menu-item menu-item-resume">
          <a href="http://linkedin.com/in/richdyang" rel="section">
            
            Résumé
          </a>
        </li>
        
      
        
        
      
        
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
            About
          </a>
        </li>
        
      
        
        
      
        
        
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
            <i class="menu-item-icon fa fa-search fa-lg"></i>Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>

<div class="social-links" style="float: right; padding-left: 50px; margin-right: 10px">
      
        
          <span class="links-of-author-item">
            <a href="http://linkedin.com/in/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-linkedin"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://github.com/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-github-alt"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://bitbucket.org/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-bitbucket"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://stackoverflow.com/users/4344443/richard" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-stack-overflow"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://twitter.com/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-twitter"></i>
                </span>
                 
              
            </a>
          </span>
        
      
  </div>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/05/25/book-notes-practical-unit-test-with-junit-and-mockito/" itemprop="url">
                  Book notes - Practical Unit Test with JUnit and Mockito
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-05-25T14:46:18+08:00" content="2015-05-25">
              2015-05-25
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Building-Testing-amp-CI/" itemprop="url" rel="index">
                    <span itemprop="name">Building, Testing &amp; CI</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/05/25/book-notes-practical-unit-test-with-junit-and-mockito/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/05/25/book-notes-practical-unit-test-with-junit-and-mockito/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Developers’-Tests"><a href="#Developers’-Tests" class="headerlink" title="Developers’ Tests"></a>Developers’ Tests</h1><h2 id="On-Tests-and-Tools"><a href="#On-Tests-and-Tools" class="headerlink" title="On Tests and Tools"></a>On Tests and Tools</h2><p><strong>SUT</strong> (aka. System Under Test) – test target being tested</p>
<p><strong>DOC</strong> (aka. Dependency of Components) – collaborators and dependencies when testing</p>
<h3 id="Types-of-Developers’-Tests"><a href="#Types-of-Developers’-Tests" class="headerlink" title="Types of Developers’ Tests"></a>Types of Developers’ Tests</h3><ul>
<li>Unit Test</li>
<li>Integration Test</li>
<li>End-to-End Test<br>Every type of test has different scope. Basically, unit test is in class level, integration test is in module level and end-to-end test is in application level.</li>
</ul>
<p>Other types of tests:</p>
<ul>
<li><strong>System Integration Test</strong> – test with external systems/applications, services etc</li>
<li><strong>User Acceptation Test</strong> – final user verification test</li>
<li><strong>Load Test</strong> – verify system performance under pressure / load</li>
</ul>
<table border="1" width="635"><br><tbody><br><tr><br><td><strong>type of test</strong></td><br><td><strong>SUT example</strong></td><br><td><strong>DOC example</strong></td><br></tr><br><tr><br><td rowspan="3">unit test</td><br><td>UserService</td><br><td>UserDAO</td><br></tr><br><tr><br><td>Invoice</td><br><td>Product</td><br></tr><br><tr><br><td>Client</td><br><td>Account</td><br></tr><br><tr><br><td rowspan="3">integration test</td><br><td>DAO layer (ORM based)</td><br><td>Hibernate</td><br></tr><br><tr><br><td>DAO layer (JDBC based)</td><br><td>MySQL 5</td><br></tr><br><tr><br><td>FullTextIndexer module</td><br><td>FileStorage module</td><br></tr><br><tr><br><td>end-to-end test</td><br><td>Whole application</td><br><td>LDAP repository</td><br></tr><br></tbody><br></table>

<h3 id="Should-Developers-Test-Their-Own-Code"><a href="#Should-Developers-Test-Their-Own-Code" class="headerlink" title="Should Developers Test Their Own Code?"></a>Should Developers Test Their Own Code?</h3><p>Yes!</p>
<h2 id="Unit-Tests"><a href="#Unit-Tests" class="headerlink" title="Unit Tests"></a>Unit Tests</h2><h3 id="what-is-a-Unit-Test"><a href="#what-is-a-Unit-Test" class="headerlink" title="what is a Unit Test?"></a>what is a Unit Test?</h3><p>It’s to make sure the class you are working on right now works correctly.</p>
<p>You should test your classes<strong> in isolation</strong>. When writing unit tests it’s important to test a single class and nothing more. Forget about databases, Spring configuration files, and external web services.</p>
<p>Concentrate on the logic of your class!</p>
<h3 id="Interactions-in-Unit-Tests"><a href="#Interactions-in-Unit-Tests" class="headerlink" title="Interactions in Unit Tests"></a>Interactions in Unit Tests</h3><p>Types of collaboration with an SUT</p>
<p><img src="/media/collaboration-of-SUT.png" alt="collaboration-of-SUT"></p>
<p>Test class has direct operations with SUT, but its collaborations have indirect operations on the SUT state.</p>
<p>We use direct inputs and indirect <strong>inputs</strong> (SUT receiveing some message) to set the SUT in a required state and to invoke its methods.</p>
<p>The direct and indirect outputs (SUT sending a message) of the SUT are expressions of the SUT’s behaviours; we use them to verify whether the SUT is working properly.</p>
<table border="1"><br><tbody><br><tr><br><td><strong>type of interaction</strong></td><br><td><strong>involved parties</strong></td><br><td><strong>description</strong></td><br></tr><br><tr><br><td>direct input</td><br><td rowspan="2">Test class &amp; SUT</td><br><td>calls the SUT methods</td><br></tr><br><tr><br><td>direct output</td><br><td>values returned by the SUT to the test class after calling some SUT method</td><br></tr><br><tr><br><td>indirect output</td><br><td rowspan="2">SUT &amp; DOCs</td><br><td>arguments passed by the SUT to a method of one of its collaborators</td><br></tr><br><tr><br><td>indirect input</td><br><td>value returned (or an exception thrown) to the SUT by collaborators, after it called some methods of its collaborators</td><br></tr><br></tbody><br></table>

<h3 id="State-Testing-vs-Interaction-Testing"><a href="#State-Testing-vs-Interaction-Testing" class="headerlink" title="State Testing vs. Interaction Testing"></a>State Testing vs. Interaction Testing</h3><ul>
<li>State Testing - uses direct inputs and outputs for what the results of actions.</li>
<li>Interaction Testing - concentrates on how messages are passed between collaborators<br>With State Testing, the SUT is a black box. Interaction testing looks inside the SUT and verifies its internal parts.</li>
</ul>
<h1 id="Writing-Unit-Testing"><a href="#Writing-Unit-Testing" class="headerlink" title="Writing Unit Testing"></a>Writing Unit Testing</h1><h2 id="Unit-tests-with-no-collaborator"><a href="#Unit-tests-with-no-collaborator" class="headerlink" title="Unit tests with no collaborator"></a>Unit tests with no collaborator</h2><h3 id="parameterized"><a href="#parameterized" class="headerlink" title="parameterized"></a>parameterized</h3><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Money</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> amount;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String currency;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Money</span><span class="params">(<span class="keyword">int</span> amount, String currency)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.amount = amount;</div><div class="line">        <span class="keyword">this</span>.currency = currency;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAmount</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> amount;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCurrency</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> currency;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object anObject)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (anObject <span class="keyword">instanceof</span> Money) &#123;</div><div class="line">            Money money = (Money) anObject;</div><div class="line">            <span class="keyword">return</span> money.getCurrency().equals(getCurrency())</div><div class="line">                    &amp;amp;&amp;amp; getAmount() == money.getAmount();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</div><div class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</div><div class="line"><span class="keyword">import</span> org.junit.runners.Parameterized;</div><div class="line"></div><div class="line"><span class="meta">@RunWith</span>(Parameterized.class)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MoneyParameterizedTest</span> </span>&#123;</div><div class="line">    <span class="meta">@Parameterized</span>.Parameters(name = <span class="string">"&#123;index&#125;: money(&#123;0&#125;, &#123;1&#125;)"</span>)</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] data() &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Object[] &#123;</div><div class="line">                <span class="keyword">new</span> Object[] &#123;<span class="number">10</span>, <span class="string">"USD"</span>&#125;,</div><div class="line">                <span class="keyword">new</span> Object[] &#123;<span class="number">20</span>, <span class="string">"EUR"</span>&#125;</div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Parameterized</span>.Parameter(value = <span class="number">0</span>) <span class="comment">// first data value (0) is default</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span> amount;</div><div class="line"></div><div class="line">    <span class="meta">@Parameterized</span>.Parameter(value = <span class="number">1</span>) <span class="comment">// value is the index in parameter tuple</span></div><div class="line">    <span class="keyword">public</span> String currency;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">constructorShouldSetAmountAndCurrency</span><span class="params">()</span> </span>&#123;</div><div class="line">        Money money = <span class="keyword">new</span> Money(amount, currency);</div><div class="line">        assertEquals(amount, money.getAmount());</div><div class="line">        assertEquals(currency, money.getCurrency());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="test-fixture"><a href="#test-fixture" class="headerlink" title="test fixture"></a>test fixture</h3><p>A <strong>test fixture</strong> is a fixed state of a set of objects used as a baseline for running tests. The purpose of a test fixture is to ensure that there is a well known and fixed environment in which tests are run so that results are repeatable. Examples of fixtures:</p>
<ul>
<li>Preparation of input data and setup/creation of fake or mock objects</li>
<li>Loading a database with a specific, known set of data</li>
<li>Copying a specific known set of files creating a test fixture will create a set of objects initialized to certain states.</li>
<li>JUnit supports test fixture by using:</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@BeforeClass</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setUpClass</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="meta">@AfterClass</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">tearDownClass</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="meta">@Before</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="meta">@After</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tearDown</span><span class="params">()</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>
<h3 id="Phases-of-a-unit-test"><a href="#Phases-of-a-unit-test" class="headerlink" title="Phases of a unit test"></a>Phases of a unit test</h3><p><table border="1"><colgroup> <col> <col> </colgroup></table></p>
<p><tbody></tbody></p>
<p><tr></tr></p>
<p><td></td></p>
<p><div class="layoutArea"></div></p>
<div class="column">

<p><strong>phase</strong></p>
<p></p></div><br><p></p>
<p><td></td></p>
<p><div class="layoutArea"></div></p>
<div class="column">

<p><strong>explanation</strong></p>
<p></p></div><br><br><p></p>
<p><tr></tr></p>
<p><td colspan="1" rowspan="2"></td></p>
<p><div class="layoutArea"></div></p>
<div class="column">

<p>arrange</p>
<p></p></div><br><p></p>
<p><td></td></p>
<p><div class="layoutArea"></div></p>
<div class="column">

<p>creation of all objects (except for the SUT) that are necessary for test execution</p>
<p></p></div><br><br><p></p>
<p><tr></tr></p>
<p><td></td></p>
<p><div class="layoutArea"></div></p>
<div class="column">

<p>creation of the object whose functionality will be tested, and setting it in some initial state</p>
<p></p></div><br><br><p></p>
<p><tr></tr></p>
<p><td></td></p>
<p><div class="layoutArea"></div></p>
<div class="column">

<p>act</p>
<p></p></div><br><p></p>
<p><td></td></p>
<p><div class="layoutArea"></div></p>
<div class="column">

<p>execution of SUT methods to be tested</p>
<p></p></div><br><br><p></p>
<p><tr></tr></p>
<p><td></td></p>
<p><div class="layoutArea"></div></p>
<div class="column">

<p>assert</p>
<p></p></div><br><p></p>
<p><td></td></p>
<p><div class="layoutArea"></div></p>
<div class="column">

<p>verification of the test results</p>
<p></p></div><br><br><br><br><br><br>The first phase relates to the preparation of a test fixture.<p></p>
<h2 id="TDD-Test-Driven-Development"><a href="#TDD-Test-Driven-Development" class="headerlink" title="TDD (Test-Driven Development)"></a>TDD (Test-Driven Development)</h2><p>when to write test?</p>
<ul>
<li>Test Last (aka. Code First) development</li>
<li>Test First development</li>
</ul>
<p>How TDD do?</p>
<ul>
<li>write a test that fails ( <span style="background-color: #ff0000;">     </span> )</li>
<li>make the code work ( <span style="background-color: #00ff00;">     </span> )</li>
<li>eliminate redundancy ( <span style="background-color: #0000ff;">     </span> )</li>
</ul>
<p><img src="/media/tdd.png" alt="tdd"></p>
<p>Note: refractor can be done for classes to test or the test code.</p>
<p>TDD should be applied to every level: unit test, integration test, end-to-end test.<br><img src="/media/tdd-on-different-levels.png" alt="tdd-on-different-levels"></p>
<h1 id="test-double-stub-test-spy-mock"><a href="#test-double-stub-test-spy-mock" class="headerlink" title="test double (stub, test spy, mock)"></a>test double (stub, test spy, mock)</h1><p><table border="1" width="644"><caption>Types of test doubles</caption></table></p>
<p><tbody></tbody></p>
<p><tr></tr></p>
<p><td>test double type</td></p>
<p><td>also known as (aka.)</td></p>
<p><td>description</td><br></p>
<p><tr></tr></p>
<p><td>dummy object</td></p>
<p><td>dummy</td></p>
<p><td>needs to exist, no real collaboration needed</td><br></p>
<p><tr></tr></p>
<p><td>test stub</td></p>
<p><td>stub</td></p>
<p><td>used for passing some values to the SUT (“indirect inputs”)</td><br></p>
<p><tr></tr></p>
<p><td>test spy</td></p>
<p><td>spy</td></p>
<p><td rowspan="2">used to verify if the SUT calls specific method of the collaborator (“indirect outputs”)</td><br></p>
<p><tr></tr></p>
<p><td>mock object</td></p>
<p><td>mock</td><br></p>
<p><tr></tr></p>
<p><td>fake</td></p>
<p><td>fake</td></p>
<p><td></td><br><br><br><br><img src="/media/test-doubles.png" alt="test-doubles"></p>
<ul>
<li>Dummies and stubs are used to prepare the environment for testing (test-fixture setting). They are not used for verification.</li>
<li>Test spies and mocks are to verify the correctness of the communication between the SUT and DOCs.  Bothe can also participate in test-fixture setting.<br><strong>Fake</strong><br>For the sake of completeness, let us describe another type of test double: a fake. Fake works almost as good as the real collaborator, but is somehow simpler and/or weaker (which makes it not suitable for production use). It is also usually “cheaper” in use (i.e. faster or simpler to set up), which makes it suited to tests (which should run as fast as possible). A typical example is an in-memory database that is used instead of a full-blown database server. It can be used for some tests, as it serves SQL requests pretty well; however, you would not want to use it in a production environment. In tests, fake plays a similar role to dummy and stub: it is a part of the environment (test fixture), not an object of verification. Fakes are used in integration tests rather than in unit tests, so we will not be discussing them any further.</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">package</span> messenger;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by Richard on 24/05/15.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Messenger</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> TemplateEngine templateEngine;</div><div class="line">    <span class="keyword">private</span> MailServer mailServer;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Messenger</span><span class="params">(MailServer mailServer, TemplateEngine templateEngine)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.mailServer = mailServer;</div><div class="line">        <span class="keyword">this</span>.templateEngine = templateEngine;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessage</span><span class="params">(Client client, Template template)</span> </span>&#123;</div><div class="line">        String msgContent = templateEngine.prepareMessage(template, client);</div><div class="line">        mailServer.send(client.getEmail(), msgContent);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">MailServer</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">send</span><span class="params">(Object email, String msgContent)</span></span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Template</span> </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">TemplateEngine</span> </span>&#123;</div><div class="line">    <span class="function">String <span class="title">prepareMessage</span><span class="params">(Template template, Client client)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">package</span> messenger;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.junit.Before;</div><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.mockito.Mockito.*;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by Richard on 24/05/15.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessengerTest</span> </span>&#123;</div><div class="line">    <span class="comment">// SUT</span></div><div class="line">    Messenger messenger;</div><div class="line"></div><div class="line">    <span class="comment">// dummy</span></div><div class="line">    Client client;</div><div class="line">    Template template;</div><div class="line"></div><div class="line">    <span class="comment">// stub</span></div><div class="line">    TemplateEngine templateEngine;</div><div class="line"></div><div class="line">    <span class="comment">// spy</span></div><div class="line">    MailServer mailServer;</div><div class="line"></div><div class="line">    <span class="keyword">final</span> String CLIENT_EMAIL = <span class="string">"some@email.com"</span>;</div><div class="line">    <span class="keyword">final</span> String MSG_CONTENT = <span class="string">"Dear John! You are fired."</span>;</div><div class="line"></div><div class="line">    <span class="meta">@Before</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">// dummy</span></div><div class="line">        template = mock(Template.class);</div><div class="line"></div><div class="line">        <span class="comment">// stubs</span></div><div class="line">        client = mock(Client.class);</div><div class="line">        when(client.getEmail()).thenReturn(CLIENT_EMAIL);</div><div class="line"></div><div class="line">        templateEngine = mock(TemplateEngine.class);</div><div class="line">        when(templateEngine.prepareMessage(template, client)).thenReturn(MSG_CONTENT);</div><div class="line"></div><div class="line">        <span class="comment">// spy</span></div><div class="line">        mailServer = mock(MailServer.class);</div><div class="line"></div><div class="line">        <span class="comment">// SUT</span></div><div class="line">        messenger = <span class="keyword">new</span> Messenger(mailServer, templateEngine);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> </span>&#123;</div><div class="line">        messenger.sendMessage(client, template);</div><div class="line"></div><div class="line">        <span class="comment">// verify interaction</span></div><div class="line">        verify(mailServer).send(CLIENT_EMAIL, MSG_CONTENT);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/05/20/scea-architect/" itemprop="url">
                  SCEA architect
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-05-20T15:22:13+08:00" content="2015-05-20">
              2015-05-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Uncategorized/" itemprop="url" rel="index">
                    <span itemprop="name">Uncategorized</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/05/20/scea-architect/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/05/20/scea-architect/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Understanding-Architecture"><a href="#Understanding-Architecture" class="headerlink" title="Understanding Architecture"></a>Understanding Architecture</h3><p>focus on structure to support the business and service-level requirements</p>
<p>You can define the structure of a system as the mechanisms that the system employs to solve the common problems of the system, such as persistence, distribution, communication, transaction management, and security</p>
<ul>
<li>difficult <strong>decisions</strong> must be made about <strong>trade-offs</strong> in the system<br>&nbsp;</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/05/19/get-started-with-angularjs/" itemprop="url">
                  Get started with AngularJS
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-05-18T23:32:13+08:00" content="2015-05-18">
              2015-05-18
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Javascript/" itemprop="url" rel="index">
                    <span itemprop="name">Javascript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/05/19/get-started-with-angularjs/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/05/19/get-started-with-angularjs/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="AngularJS-concepts"><a href="#AngularJS-concepts" class="headerlink" title="AngularJS concepts"></a>AngularJS concepts</h3><p><img src="/media/angularjs-conception.png" alt="angularjs-conception"></p>
<p>Core concepts:</p>
<ul>
<li>2-way data binding</li>
<li>directive</li>
<li>expression &amp; filter</li>
<li>view / template</li>
<li>controller</li>
</ul>
<h4 id="2-way-data-binding"><a href="#2-way-data-binding" class="headerlink" title="2-way data binding"></a>2-way data binding</h4><p><img src="/media/jogjajs-single-page-application-nganggo-angularjs-17-638.jpg" alt="jogjajs-single-page-application-nganggo-angularjs-17-638"></p>
<h4 id="directives"><a href="#directives" class="headerlink" title="directives"></a>directives</h4><ul>
<li>manipulate DOM: DOM manipulation should only happen in directive implementations</li>
<li>manipulate data<br>Elements: &lt;<span style="color: #000000; background-color: #ffff00;">ng-xx</span>&gt; &lt;/ng-xx&gt;</li>
</ul>
<p>Attributes: &lt;span <span style="background-color: #ffff00;">ng-xx=”exp”</span>&gt;&lt;/span&gt;</p>
<p>Comments: &lt;!– directive: <span style="background-color: #ffff00;">ng-xx exp</span> –&gt;</p>
<p>Classes: &lt;span class=”<span style="background-color: #ffff00;">ng-xx: exp</span>“&gt;&lt;/span&gt;</p>
<h4 id="Scope"><a href="#Scope" class="headerlink" title="Scope"></a>Scope</h4><p>Scope is a glue between controller, template and model. It keeps models and views separate, but in sync.</p>
<h4 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h4><p>Controller is for UI logic</p>
<h3 id="Injector"><a href="#Injector" class="headerlink" title="Injector"></a>Injector</h3><p>The injector uses recipes to create two types of objects, <strong>services</strong> and <strong>specialized objects</strong>.</p>
<ul>
<li>Services are objects whose API is defined by the developer writing the service.</li>
<li>Specialized objects conform to a specific Angular framework API. These objects extend the framework as plugins and therefore must implement interfaces specified by Angular. These interfaces are Controller, Directive, Filter and Animation.</li>
</ul>
<h4 id="Recipes"><a href="#Recipes" class="headerlink" title="Recipes"></a>Recipes</h4><p>There are five recipe types that define how to create objects: Value, Constant, Factory, Service and Provider.</p>
<p>Value, Constant, Factory and Service are the synaptic sugar of Provider.</p>
<ul>
<li>Value recipe<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">myApp.value(<span class="string">'clientId'</span>, <span class="string">'a12345654321x'</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
<p>&nbsp;</p>
<ul>
<li><p>Constant recipe</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">myApp.constant(<span class="string">'planetName'</span>, <span class="string">'Greasy Giant'</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>Factory recipe</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">myApp.factory(<span class="string">'clientId'</span>, <span class="function">function <span class="title">clientIdFactory</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="string">'a12345654321x'</span>;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>Service recipe</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function">function <span class="title">UnicornLauncher</span><span class="params">(apiToken)</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">this</span>.launchedCount = <span class="number">0</span>;</div><div class="line">  <span class="keyword">this</span>.launch = function() &#123;</div><div class="line">    <span class="comment">// Make a request to the remote API and include the apiToken</span></div><div class="line">    ...</div><div class="line">    <span class="keyword">this</span>.launchedCount++;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//myApp.factory('unicornLauncher', ["apiToken", function(apiToken) &#123;</span></div><div class="line"><span class="comment">//  return new UnicornLauncher(apiToken);</span></div><div class="line"><span class="comment">//&#125;]);</span></div><div class="line"></div><div class="line">myApp.service(<span class="string">'unicornLauncher'</span>, [<span class="string">"apiToken"</span>, UnicornLauncher]);</div></pre></td></tr></table></figure>
</li>
<li><p>provider recipe</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">myApp.provider(<span class="string">'unicornLauncher'</span>, <span class="function">function <span class="title">UnicornLauncherProvider</span><span class="params">()</span> </span>&#123;</div><div class="line">  var useTinfoilShielding = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">  <span class="keyword">this</span>.useTinfoilShielding = function(value) &#123;</div><div class="line">    useTinfoilShielding = !!value;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">this</span>.$get = [<span class="string">"apiToken"</span>, <span class="function">function <span class="title">unicornLauncherFactory</span><span class="params">(apiToken)</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">// let's assume that the UnicornLauncher constructor was also changed to</span></div><div class="line">    <span class="comment">// accept and use the useTinfoilShielding argument</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> UnicornLauncher(apiToken, useTinfoilShielding);</div><div class="line">  &#125;];</div><div class="line">&#125;);</div><div class="line"></div><div class="line">myApp.config([<span class="string">"unicornLauncherProvider"</span>, function(unicornLauncherProvider) &#123;</div><div class="line">  unicornLauncherProvider.useTinfoilShielding(<span class="keyword">true</span>);</div><div class="line">&#125;]);</div></pre></td></tr></table></figure>
</li>
</ul>
<table class="table table-bordered code-table ng-scope" border="1"><br><thead><br><tr><br><th>Features / Recipe type</th><br><th>Factory</th><br><th>Service</th><br><th>Value</th><br><th>Constant</th><br><th>Provider</th><br></tr><br></thead><br><tbody><br><tr><br><td>can have dependencies</td><br><td class="success">yes</td><br><td class="success">yes</td><br><td class="error">no</td><br><td class="error">no</td><br><td class="success">yes</td><br></tr><br><tr><br><td>uses type friendly injection</td><br><td class="error">no</td><br><td class="success">yes</td><br><td class="success">yes<em></em></td><br><td class="success">yes</td><br><td class="error">no</td><br></tr><br><tr><br><td>object available in config phase</td><br><td class="error">no</td><br><td class="error">no</td><br><td class="error"><span style="background-color: #99cc00;">no</span></td><br><td class="success"><span style="background-color: #99cc00;">yes</span></td><br><td class="success">yes**</td><br></tr><br><tr><br><td>can create functions</td><br><td class="success">yes</td><br><td class="success">yes</td><br><td class="success">yes</td><br><td class="success">yes</td><br><td class="success">yes</td><br></tr><br><tr><br><td>can create primitives</td><br><td class="success">yes</td><br><td class="error">no</td><br><td class="success">yes</td><br><td class="success">yes</td><br><td class="success">yes</td><br></tr><br></tbody><br></table>

<h4 id="Specialized-object"><a href="#Specialized-object" class="headerlink" title="Specialized object"></a>Specialized object</h4><p>The instructions for the injector to create these special objects (with the exception of the Controller objects) use the Factory recipe behind the scenes.</p>
<p>Since the directives are registered via the Factory recipe, we can use the same syntax as with factories.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">myApp.directive(<span class="string">'myPlanet'</span>, [<span class="string">'planetName'</span>, <span class="function">function <span class="title">myPlanetDirectiveFactory</span><span class="params">(planetName)</span> </span>&#123;</div><div class="line">  <span class="comment">// directive definition object</span></div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    restrict: <span class="string">'E'</span>,</div><div class="line">    scope: &#123;&#125;,</div><div class="line">    link: function($scope, $element) &#123; $element.text(<span class="string">'Planet: '</span> + planetName); &#125;</div><div class="line">  &#125;</div><div class="line">&#125;]);</div></pre></td></tr></table></figure>
<p>Using Factory recipes, you can also define Angular’s filters and animations, but the controllers are a bit special.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">myApp.controller(<span class="string">'DemoController'</span>, [<span class="string">'clientId'</span>, <span class="function">function <span class="title">DemoController</span><span class="params">(clientId)</span> </span>&#123;</div><div class="line">  <span class="keyword">this</span>.clientId = clientId;</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<p>Unlike services, controllers are not singletons.</p>
<p>&nbsp;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/05/12/javascript-scope-and-context/" itemprop="url">
                  JavaScript scopes and context
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-05-12T17:06:39+08:00" content="2015-05-12">
              2015-05-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Javascript/" itemprop="url" rel="index">
                    <span itemprop="name">Javascript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/05/12/javascript-scope-and-context/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/05/12/javascript-scope-and-context/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="scope-vs-context"><a href="#scope-vs-context" class="headerlink" title="scope vs. context"></a>scope vs. context</h3><p>Both two terms are related to function.</p>
<p>Every function invocation has both a scope and a context associated with it. Functions can be adopted for various contexts and scope can be encapsulated and preserved.</p>
<p>Fundamentally, scope is <strong>function-based</strong> while context is <strong>object-based</strong>.</p>
<ul>
<li>Scope pertains to the variable access of a function when it is invoked and is unique to each invocation.</li>
<li>Context is always the value of the <code>this</code> keyword which is a reference to the object that “owns” the currently executing code.<iframe width="560" height="315" src="https://www.youtube.com/embed/hDT3IbvH-9I" frameborder="0" allowfullscreen="allowfullscreen"></iframe>

</li>
</ul>
<h3 id="scope"><a href="#scope" class="headerlink" title="scope"></a>scope</h3><p>A variable can be defined in either local or global scope, which establishes the variables’ accessibility from different scopes during runtime.</p>
<p>Javascript has no <del><strong>block scope</strong></del>.</p>
<p>All scopes in JavaScript are created with <code>function Scope</code> <em>only</em>, they aren’t created by <code>for</code> or <code>while</code> loops or expression statements like <code>if</code> or <code>switch</code>.</p>
<h4 id="global-scope"><a href="#global-scope" class="headerlink" title="global scope"></a>global scope</h4><p>This is the top level scope. Any variable declared outside of a function body will live throughout runtime and can be accessed and altered in any scope.</p>
<h4 id="local-scope"><a href="#local-scope" class="headerlink" title="local scope"></a>local scope</h4><p>New functions = new local scope - that’s the rule.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="comment">// Scope A - global</span></div><div class="line"><span class="keyword">var</span> myFunction = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// Scope B - local</span></div><div class="line">  <span class="keyword">var</span> myOtherFunction = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// Scope C - local</span></div><div class="line">  &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h4 id="scope-chain"><a href="#scope-chain" class="headerlink" title="scope chain"></a>scope chain</h4><p>Each function defined has its own nested scope, and any function defined within another function has a local scope which is linked to the outer function.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">first</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    second();</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">second</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        third();</div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">third</span>(<span class="params"></span>)</span>&#123;</div><div class="line">            fourth();</div><div class="line">            <span class="function"><span class="keyword">function</span> <span class="title">fourth</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                <span class="comment">// do something</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;   </div><div class="line">&#125;</div><div class="line">first();</div></pre></td></tr></table></figure>
<h3 id="quot-this-quot-context"><a href="#quot-this-quot-context" class="headerlink" title="&quot;this&quot; context"></a><code>&quot;this&quot;</code> context</h3><p>Context is most often determined by how a function is invoked. When a function is called as a method of an object, <code>this</code> is set to the object the method is called on.</p>
<p>invoke no-bound function</p>
<ul>
<li>bind <code>this</code> to <code>window</code> (by default) by invoking unbound function</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dog</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>);</div><div class="line">  <span class="keyword">var</span> that = <span class="keyword">this</span>;</div><div class="line">  <span class="keyword">var</span> bar = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span> == that);</div><div class="line">  &#125;;</div><div class="line">  bar();</div><div class="line"></div><div class="line">  <span class="keyword">this</span>.bar = bar;</div><div class="line">  <span class="keyword">this</span>.bar();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> dog = <span class="keyword">new</span> Dog();</div></pre></td></tr></table></figure>
<ul>
<li>bind <code>this</code> by <code>new</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Cat</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.drink = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">       <span class="built_in">console</span>.log(<span class="keyword">this</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Cat(); <span class="comment">// this -&gt; window</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> cat = <span class="keyword">new</span> Cat();</div><div class="line">cat.drink(); <span class="comment">// this -&gt; cat</span></div></pre></td></tr></table></figure>
<ul>
<li>bind <code>this</code> by specifying function to object property</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">    foo: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        alert(<span class="keyword">this</span> === obj);    </div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">obj.foo(); <span class="comment">// true</span></div></pre></td></tr></table></figure>
<ul>
<li>Changing scope with <code>.call()</code>, <code>.apply()</code> and <code>.bind()</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">name, age</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = name;</div><div class="line">  <span class="keyword">this</span>.age = age;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> john = &#123;</div><div class="line">  dept: <span class="string">'dev'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">foo.apply(john, [<span class="string">'John'</span>, <span class="number">32</span>]);</div><div class="line"><span class="comment">//foo.call(obj, 'Richard', 32);</span></div><div class="line"><span class="built_in">console</span>.log(john); <span class="comment">// -&amp;gt; Object &#123;dept: "dev", name: "John", age: 32&#125;</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> tom = &#123;</div><div class="line">  dept: <span class="string">'test'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> bar = foo.bind(tom, <span class="string">'Tom'</span>, <span class="number">28</span>); <span class="comment">// just bind, not call</span></div><div class="line"><span class="built_in">console</span>.log(tom); <span class="comment">// Object &#123;dept: "test"&#125;</span></div><div class="line"><span class="comment">// do something else</span></div><div class="line"><span class="comment">// ...</span></div><div class="line">bar();</div><div class="line"><span class="built_in">console</span>.log(tom); <span class="comment">// Object &#123;dept: "test", name: "Tom", age: 28&#125;</span></div></pre></td></tr></table></figure>
<h3 id="Execution-Context"><a href="#Execution-Context" class="headerlink" title="Execution Context"></a>Execution Context</h3><p>This terminology is defined by ECMA specification. Don’t confuse it with the “<code>this</code>“ context.</p>
<p>JavaScript is a single threaded language, meaning only one task can be executed at a time. When the JavaScript interpreter initially executes code, it first enters into a global execution context by default. Each invocation of a function from this point on will result in the creation of a new execution context.</p>
<p>Each time a new execution context is created it is appended to the top of the <strong><em>execution stack</em></strong>.</p>
<p>An execution context can be divided into a creation and execution phase. In the creation phase, the interpreter will first create a <em>variable object</em> (also called an <em>activation object</em>) that is composed of all the variables, function declarations, and arguments defined inside the execution context. From there the <em>scope chain</em> is initialized next, and the value of <code>this</code> is determined last. Then in the execution phase, code is interpreted and executed.</p>
<h3 id="closure"><a href="#closure" class="headerlink" title="closure"></a>closure</h3><p>Accessing variables outside of the immediate lexical scope creates a closure.</p>
<p>It says, a closure is formed when a nested function is defined inside of another function, allowing access to the outer functions variables.</p>
<p>A simple illustration:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">aa</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> bb = <span class="string">'hello '</span>;</div><div class="line">    <span class="keyword">var</span> cc = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> bb + <span class="string">"world"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>cc</code> as a function accesses its immediate outer scope. That creates a closure.</p>
<hr>
<p>Returning the nested function allows you to maintain access to the local variables, arguments, and inner function declarations of its outer function. This encapsulation allows us to hide and preserve the execution context from outside scopes while exposing a public interface and thus is subject to further manipulation.</p>
<p>A more practical example:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> sayHello = <span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> text = <span class="string">'Hello, '</span> + name;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(text);</div><div class="line">  &#125;;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">sayHello(<span class="string">"Richard"</span>)();</div></pre></td></tr></table></figure>
<p>One of the most popular types of closures is what is widely known as the <em>module pattern</em>; it allows you to emulate public, private, and privileged members:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> Module = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> privateProperty = <span class="string">'foo'</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">privateMethod</span>(<span class="params">args</span>)</span>&#123;</div><div class="line">        <span class="comment">// do something</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line"></div><div class="line">        publicProperty: <span class="string">''</span>,</div><div class="line"></div><div class="line">        publicMethod: <span class="function"><span class="keyword">function</span>(<span class="params">args</span>)</span>&#123;</div><div class="line">            <span class="comment">// do something</span></div><div class="line">        &#125;,</div><div class="line"></div><div class="line">        privilegedMethod: <span class="function"><span class="keyword">function</span>(<span class="params">args</span>)</span>&#123;</div><div class="line">            <span class="keyword">return</span> privateMethod(args);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">&#125;)();</div></pre></td></tr></table></figure>
<p>References:</p>
<ol>
<li><a href="http://ryanmorr.com/understanding-scope-and-context-in-javascript/" target="_blank" rel="external">http://ryanmorr.com/understanding-scope-and-context-in-javascript/</a></li>
<li><a href="http://toddmotto.com/everything-you-wanted-to-know-about-javascript-scope/" target="_blank" rel="external">http://toddmotto.com/everything-you-wanted-to-know-about-javascript-scope/</a></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/05/12/javascript-prototype-proto-vs-prototype/" itemprop="url">
                  JavaScript prototype: __proto__ vs. prototype
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-05-12T15:35:15+08:00" content="2015-05-12">
              2015-05-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Javascript/" itemprop="url" rel="index">
                    <span itemprop="name">Javascript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/05/12/javascript-prototype-proto-vs-prototype/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/05/12/javascript-prototype-proto-vs-prototype/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Javascript is a prototype-based language. It resolve property using prototype chains.</p>
<h3 id="Prototype-chains-aka-prototype-inheritance"><a href="#Prototype-chains-aka-prototype-inheritance" class="headerlink" title="Prototype chains (aka prototype inheritance)"></a>Prototype chains (aka prototype inheritance)</h3><p><img src="/media/prototype-chains.png" alt="prototype-chains"></p>
<h3 id="The-proto-property"><a href="#The-proto-property" class="headerlink" title="The proto property"></a>The <strong>proto</strong> property</h3><p><strong>proto</strong> is the internal property of an object, it points to the prototype object of the object and is used for property look-up. Every object has a <strong>proto</strong> perperty and its relevant prototype object. But it maybe null, which means the object has no prototype object.</p>
<h3 id="function-as-constructor"><a href="#function-as-constructor" class="headerlink" title="function as constructor"></a>function as constructor</h3><p>In JavaScript you create an instance of a function like this:<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function">function <span class="title">Foo</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="keyword">this</span>.kind = ‘foo’</div><div class="line">&#125;</div><div class="line"></div><div class="line">var foo = <span class="keyword">new</span> Foo(); </div><div class="line">foo.kind <span class="comment">//=&amp;gt; ‘foo’</span></div></pre></td></tr></table></figure></p>
<p>Behind this scenes it is like doing something like this:<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function">function <span class="title">Foo</span><span class="params">()</span> </span>&#123;</div><div class="line">  var <span class="keyword">this</span> = &#123;&#125;; <span class="comment">// this is not valid, just for illustration</span></div><div class="line">  <span class="keyword">this</span>.__proto__ = Foo.prototype;</div><div class="line"></div><div class="line">  <span class="keyword">this</span>.kind = ‘foo’</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>But keep in mind that the implicit ‘<strong>this</strong>’ is only assigned to a new object when using ‘<strong>new</strong>’. If you forget ‘<strong>new</strong>’ keyword then ‘<strong>this</strong>’ will be the global object.</p>
<h3 id="the-‘function-prototype’"><a href="#the-‘function-prototype’" class="headerlink" title="the ‘function prototype’"></a>the ‘function prototype’</h3><p>Every function in JavaScript has a special property called ‘<strong>prototype</strong>’. To avoid confusion, we call it “function prototype”.</p>
<p>Basically, this object is provided at run-time by Javascript engine. This object has a property called “constructor” which points to the function itself.</p>
<p>It is used to<strong> build <code>__proto__</code></strong> when you create an object with <code>new</code> keyword.</p>
<h3 id="Javascript-object-model"><a href="#Javascript-object-model" class="headerlink" title="Javascript object model"></a>Javascript object model</h3><p>Now we illustrate the complete relations for prototype:</p>
<p><img src="/media/js-prototype.png" alt="js-prototype"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/05/09/web-vulnerability-issues-xss-csrf-sql-injection/" itemprop="url">
                  web vulnerability issues: XSS, CSRF, SQL Injection
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-05-08T20:25:02+08:00" content="2015-05-08">
              2015-05-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Security/" itemprop="url" rel="index">
                    <span itemprop="name">Security</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/05/09/web-vulnerability-issues-xss-csrf-sql-injection/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/05/09/web-vulnerability-issues-xss-csrf-sql-injection/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="XSS-Cross-Site-Scripting"><a href="#XSS-Cross-Site-Scripting" class="headerlink" title="XSS (Cross Site Scripting)"></a>XSS (Cross Site Scripting)</h3><p>XSS enables attackers to <strong>inject client-side script</strong> into Web pages viewed by other users.</p>
<p><img src="/media/Diagram-Describing-Blind-XSS-Attack.gif" alt="Diagram-Describing-Blind-XSS-Attack"></p>
<p>Simple solution: escape all users’ input data, include HTML, Javascript</p>
<h3 id="CSRF-Cross-Site-Request-Forgery"><a href="#CSRF-Cross-Site-Request-Forgery" class="headerlink" title="CSRF (Cross Site Request Forgery)"></a>CSRF (Cross Site Request Forgery)</h3><p>CSRF is an attack which forces an end user to execute unwanted actions on a web application in which he/she is currently authenticated.</p>
<p><img src="/media/csrf.png" alt="csrf"></p>
<p>Simple solution:</p>
<ol>
<li>insert hidden field for csrf_token, and verify every form post.</li>
<li>insert CSRF token in the response header, and need users to send back it with the post data.</li>
<li>always verify the referer header<br><img src="/media/web-security-owasp-project-csrf-threat-and-solutions-31-638.jpg" alt="web-security-owasp-project-csrf-threat-and-solutions-31-638"></li>
</ol>
<h3 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h3>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/05/08/websphere-sso-how-to/" itemprop="url">
                  WebSphere SSO how-to
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-05-08T13:19:49+08:00" content="2015-05-08">
              2015-05-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/SSO/" itemprop="url" rel="index">
                    <span itemprop="name">SSO</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/05/08/websphere-sso-how-to/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/05/08/websphere-sso-how-to/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="SSO定义"><a href="#SSO定义" class="headerlink" title="SSO定义"></a><strong>SSO定义</strong></h3><p>单点登录的英文名称为Single Sign-On，简写为SSO。在用户有权限访问的多个系统间，只要用户在其中一个系统做过认证(Authentication)后，就不用再次做认证即可以访问其他系统。</p>
<p>IBM对SSO有一个形象的解释：“单点登录、全网漫游”。</p>
<h4 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a><strong>实现原理</strong></h4><p>目前主流SSO的实现方案中实现机制不尽相同，大体分为Cookie机制和Session机制两大类。</p>
<h5 id="基于Session的机制"><a href="#基于Session的机制" class="headerlink" title="基于Session的机制"></a><strong>基于Session的机制</strong></h5><p>WebLogic通过Session共享认证信息。Session是一种服务器端机制，当客户端访问服务器时，服务器为客户端创建一个唯一的SessionID，以使在整个交互过程中始终保持状态，而交互的信息则可由应用自行指定，因此用Session方式实现SSO，不能在多个浏览器之间实现单点登录，但却可以跨域。</p>
<h5 id="基于Cookie的机制"><a href="#基于Cookie的机制" class="headerlink" title="基于Cookie的机制"></a><strong>基于Cookie的机制</strong></h5><p>WebSphere通过Cookie记录认证信息。Cookie是一种客户端机制，它存储的内容主要包括: 名字、值、过期时间、路径和域，路径与域合在一起就构成了Cookie的作用范围，因此用Cookie方式可实现SSO，但域名必须相同。目前大部分SSO产品采用的是Cookie机制，WAS、CAS也是如此。</p>
<p>注意，这种Cookie机制要求实现单点登录的应用，其域名必须是相同的。例如：a.bankcomm.com, b.bankcomm.com就可以经过配置后实现SSO。</p>
<h3 id="WAS-SSO机制介绍"><a href="#WAS-SSO机制介绍" class="headerlink" title="WAS SSO机制介绍"></a><strong>WAS SSO机制介绍</strong></h3><h4 id="WAS-SSO机制原理"><a href="#WAS-SSO机制原理" class="headerlink" title="WAS SSO机制原理"></a><strong>WAS SSO机制原理</strong></h4><p>WAS使用Cookie实现单点登录的原理图如图4所示。</p>
<p><img src="/media/sso-1.jpg" alt="sso-1"></p>
<p>图 4  使用Cookie实现单点登录的原理图</p>
<ul>
<li>某个应用程序首先要发起第1次认证。第一次访问应用程序时会显示登录页面。</li>
<li>用户在登录页面中，输入用户名和密码。</li>
<li>然后应用服务器会对用户名和密码进行认证。认证本身并不是应用服务器的功能，因此，通常会引入某种认证机制。认证机制可以有很多种，例如自己写一个认证程序，或者使用一些标准的认证方法，例如LDAP或者数据库等等。在大多数情况下，会使用LDAP进行认证。这是因为LDAP在处理用户登录方面，有很多独特的优势。</li>
<li>认证通过之后，页面重定向，回到Web应用。Web应用此时就完成了成功的登录。</li>
<li>然后应用服务器会在客户端创建一个Cookie，Cookie里面保存了LTPA令牌。Cookie是在用户的客户端，而不是服务端创建一个Cookie。这个Cookie是一个加密的Cookie，其中保存了用户登录的信息。</li>
<li>如果用户此时希望进入其他Web应用程序，此时WAS不再要求用户输入用户名和密码，而是首先自动寻找Cookie，根据Cookie中保存的信息，进行登录。登录之后，WAS重定向回到用户的应用程序。<br>这样，就不再需要用户继续输入用户名和密码，从而实现了单点登录。</li>
</ul>
<p>这种单点登录体系中，并没有通过http进行密码的传递（但是有用户名的传递），因此是十分安全的。</p>
<h5 id="LDAP简介"><a href="#LDAP简介" class="headerlink" title="LDAP简介"></a><strong>LDAP简介</strong></h5><p>LDAP是英文“Lightweight Directory Access Protocol”的简称，中文翻译为轻量级目录访问协议。它是一种因特网上的访问协议，主要用于从服务器上检索信息。</p>
<p>LDAP服务器用来保存信息，中文有时候也称为目录服务。数据库使用“表”来储存数据，可以把一个数据库想象为日常生活中的“表格”。而LDAP用“树”来存储数据，可以把它想象为日常生活中的“电话号码簿页”，或者干脆把LDAP想象为大家常用的文件系统，就是由文件夹和文件组成的那种树形结构。</p>
<p>由于LDAP的结构方式不同，因此LDAP有一个很特殊的特性，就是查询数据的速度特别快，但是写数据的速度较慢。LDAP的另一个特性就是比较适合于按照层次组织信息，例如企业的组织结构等。</p>
<p>由于LDAP的查询速度比数据库快，因此经常用于诸如地址簿、用户帐号存储、组织结构信息、域名解析系统等需要大量查询的领域。</p>
<p>首先，我们可以很清楚地看到，LDAP是按照树形目录进行组织的。</p>
<p>假设公司的域名是macromedia.com，则LDAP首先使用域名作为整个树的根，并且用dc=com，dc=macromedia这样的标记来进行标注。dc的意思指“Domain Component”。LDAP中以后会大量使用这些令人费解的缩写。</p>
<p>假设某天macromedia.com这个公司和apple.com这个公司合并，按照LDAP的树形结构，只不过多了一个分叉，而不会导致整棵树需要重新组织，这就是LDAP的好处之一。</p>
<p>dc节点的后面，就是ou节点。ou是Organizational Unit的缩写，可以把ou想象为文件夹，它是用来容纳其他节点的。ou可以对应部门、组或者任何要包含其他节点的东西。</p>
<p>ou下面的节点，可以是另一个ou，也可以是cn节点。cn是“Common Name”的缩写，它是树叶节点，可以把它对比为文件系统中的文件。cn节点通常用来存储用户的信息，例如某个用户的地址等。</p>
<p>这样，各个节点按照树形组织起来，就变成了图5的样子。</p>
<p><img src="/media/sso-2.jpg" alt="sso-2"></p>
<p>图 5  LDAP结构示意图</p>
<h5 id="LTPA简介"><a href="#LTPA简介" class="headerlink" title="LTPA简介"></a><strong>LTPA简介</strong></h5><p>LTPA(Lightweight Third Party Authentication)技术是IBM的标准。当某用户访问某WebSphere URL时,系统会提示他输入用户名和口令进行登录。这时用户可以输入他的唯一标识符,通过验证后,Web服务器将把该用户的Web 浏览器中显示的Web 站点内容发送回来。在后台,WebSphere入口网站服务器将会建立包含已鉴别使用者认证的单点登录Cookie,并且会一直发送该cookie，而浏览器通常的默认设置是允许接收cookie的,因此用户的浏览器将保存这个cookie。 LTPA cookie是临时的,只在浏览器内存中存留,用户如果关闭浏览器,cookie就会被永久删除。LTPA cookie的特点如下：</p>
<p>(1)LTPA cookie是一种典型的浏览器cookie,它保存的信息表示该用户已经进行了登录。所有的浏览器cookies都有名称等标准属性。LTPA cookie特有的名称是LtpaToken。当配置 SSO时,在配置实用工具中,通常将LTPA cookie称为SSO LTPA“令牌”。LTPA cookie有一个被编码值,隐藏起cookie中包含的重要信息并且通过Internet传输。</p>
<p>(2)LTPA cookie 具有典型的浏览器cookie的相关域的信息，LTPA的实现依赖于具有域信息的浏览器cookies，因此，通常SSO环境必须部署到单一DNS域中,即每台服务器都在同一DNS域中。</p>
<p>(3)在用户已经登录并且该用户的浏览器接收到 LTPA cookie以后,在HTTP通信中不再需要进行特定的配置,浏览器运行的标准方法就是浏览器将自动发送该cookie。浏览器不断地向任何正确的DNS域中的URL目标发送HTTP请求，通过这种途径不断地向外发送LPTA cookie。当SSO服务接收到HTTP请求并且发现请求中包含了LTPA cookie时,服务器将验证cookie，随即可知道该cookie属于哪一位已经登录的用户，服务器就可以允许这个用户对这台服务器进行适当的访问。浏览器的任务就是确定在什么时候应该随同HTTP通信一起发出LTPA cookie。当用户浏览到一个不在同一DNS域中的URL时, 因为该cookie不适用于这个新的DNS域,浏览器则不会发送 LTPA cookie,新的DNS目标的接收服务器就不知道用户是谁,这时会提示用户输入他的用户名和口令。</p>
<p>(4)LTPA cookie是安全的,因为服务器在创建它时，使用一组加密密钥进行了安全加密。加密密钥用于对cookie进行编码,编码后的cookie传送到用户浏览器,而浏览器只对有加密密钥的cookie进行解码和验证cookie的完整性,并随时检测cookie是否被篡改过。在SSO环境中的所有服务器必须共享同一个加密密钥。当SSO服务器接收到HTTP请求并发现其中包含LTPA cookie时,就使用它共享的加密密钥副本验证cookie,这时有效的cookie信息就使服务器能够识别出登录的用户。</p>
<p>SSO服务器使用的安全加密确保了没有任何伪造cookie的机会。没有加密密钥,其他非法 的cookie不会通过验证,伪造的cookie将被忽略。因此，SSO服务器不会被入侵。</p>
<p>在WebSphere Portal环境中,LTPA加密密钥通常在配置SSO时由WebSphere 创建。管理员可以将密钥导出到文件中,然后转移该文件到其他的SSO服务器（例如Domino）,在那里导入密钥。系统的管理维护人员应该非常小心地处理密钥文件,把所有的副本保护好。</p>
<h5 id="LTPA生成机制"><a href="#LTPA生成机制" class="headerlink" title="LTPA生成机制"></a><strong>LTPA生成机制</strong></h5><p>LTPA由以下部分组成：</p>
<ul>
<li>LTPA token 版本（4字节）</li>
<li>创建时间（8字节）</li>
<li>过期时间（8字节）</li>
<li>用户名（可变长度）</li>
<li>LTPA 密钥（20字节）</li>
<li>接下来分别说明各部分的具体内容：</li>
<li>LTPA token 版本，例如0×0001</li>
<li>创建时间和过期时间为以十六进制方式表示的 Unix time，例如 2009-04-09 13:52:42 (GMT +8) = 1239256362 = 49DD8D2A。过期时间为 创建时间 + SSO 配置文档的过期时间（LTPA_TokenExpiration域）</li>
<li>用户名为 Names 中用户文档的 FullName 域值</li>
<li>Domino LTPA 密钥通过 Base64编码后，保存在 SSO 配置文档的 LTPA_Secret 域中。<br><img src="/media/sso-3.jpg" alt="sso-3"></li>
</ul>
<p>图 6  LTPA结构示意图</p>
<p>在这里当然不能将密钥直接发送给浏览器，所以将上述部分合并起来（如上图），计算 SHA-1 校验和。</p>
<p><img src="/media/sso-4.jpg" alt="sso-4"></p>
<p>图 7  LTPA 密钥Base64编码图</p>
<p>然后用 SHA-1 校验和替换掉 LTPA 密钥，最后再将内容通过 Base64 编码，形成最终的LTPA Token发送给浏览器（如上图）。这样如果 cookie 中的任何内容被修改，校验和就不对了，达到了防篡改的效果。</p>
<h5 id="LTPA验证机制"><a href="#LTPA验证机制" class="headerlink" title="LTPA验证机制"></a><strong>LTPA验证机制</strong></h5><p>WAS根据事先导入的密钥KEY文件，解密LTPA Token内容，验证LTPA是否有效，并判断该LTPA是否超时。</p>
<p>如果LTPA验证通过，将获取LTPA中的用户信息，并再次与LDAP服务器进行验证该用户的有效性。</p>
<h4 id="自定义认证实现方式"><a href="#自定义认证实现方式" class="headerlink" title="自定义认证实现方式"></a><strong>自定义认证实现方式</strong></h4><h5 id="实现原理-1"><a href="#实现原理-1" class="headerlink" title="实现原理"></a><strong>实现原理</strong></h5><p><img src="/media/sso-5.jpg" alt="sso-5"></p>
<p>自定义认证可以通过WAS中使用“独立定制注册表”方式实现认证。</p>
<p>通过在WAS控制台中指定实现了 com.ibm.websphere.security 包中的 UserRegistry 接口的定制注册表（需要开发自定义实现类），但要求用户自定义实现类必须实现com.ibm.websphere.security.UserRegistry的接口。</p>
<p>基于这个原理，我们可以自己编写一个java类，在接口实现中连接LDAP进行认证（可根据需要访问LDAP业务密码等信息），然后WAS再按照原先方式生成LTPA。</p>
<h5 id="配置方式"><a href="#配置方式" class="headerlink" title="配置方式"></a><strong>配置方式</strong></h5><h6 id="配置使用“独立定制注册表”"><a href="#配置使用“独立定制注册表”" class="headerlink" title="配置使用“独立定制注册表”"></a><strong>配置使用“独立定制注册表”</strong></h6><p><img src="/media/sso-6.jpg" alt="sso-6"></p>
<h6 id="配置“独立定制注册表”使用的“定制注册表类名”等信息"><a href="#配置“独立定制注册表”使用的“定制注册表类名”等信息" class="headerlink" title="配置“独立定制注册表”使用的“定制注册表类名”等信息"></a><strong>配置“独立定制注册表”使用的“定制注册表类名”等信息</strong></h6><p><img src="/media/sso-7.jpg" alt="sso-7"></p>
<h6 id="与WAS自带LDAP方式比较"><a href="#与WAS自带LDAP方式比较" class="headerlink" title="与WAS自带LDAP方式比较"></a><strong>与WAS自带LDAP方式比较</strong></h6><p>&nbsp;</p>
<p><img src="/media/284e6e10c9f9.jpg" alt=""></p>
<h4 id="配置方式-1"><a href="#配置方式-1" class="headerlink" title="配置方式"></a><strong>配置方式</strong></h4><h5 id="各业务系统端环境配置"><a href="#各业务系统端环境配置" class="headerlink" title="各业务系统端环境配置"></a><strong>各业务系统端环境配置</strong></h5><h6 id="修改web-xml"><a href="#修改web-xml" class="headerlink" title="修改web.xml"></a><strong>修改web.xml</strong></h6><p>设置应用端的web.xml，使得业务平台可以通过SSO访问资源，下例中红色部分就配置了允许访问的资源。<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;security-constraint&amp;gt;</div><div class="line">    &amp;lt;web-resource-collection&amp;gt;</div><div class="line">        &amp;lt;web-resource-name&amp;gt;sso_GUIP&amp;lt;/web-resource-name&amp;gt;</div><div class="line">        &amp;lt;url-pattern&amp;gt;/abf_comm/default4portal.jsp&amp;lt;/url-pattern&amp;gt;</div><div class="line">        &amp;lt;url-pattern&amp;gt;/abf_comm/main.jsp&amp;lt;/url-pattern&amp;gt;</div><div class="line">        &amp;lt;url-pattern&amp;gt;/abf_comm/<span class="keyword">default</span>.jsp&amp;lt;/url-pattern&amp;gt;</div><div class="line">        &amp;lt;url-pattern&amp;gt;/common/fromITC.jsp&amp;lt;/url-pattern&amp;gt;</div><div class="line">        &amp;lt;url-pattern&amp;gt;/itc_agent/agentsync/export.jsp&amp;lt;/url-pattern&amp;gt;</div><div class="line">    &amp;lt;/web-resource-collection&amp;gt;</div><div class="line">    &amp;lt;auth-constraint&amp;gt;</div><div class="line">        &amp;lt;role-name&amp;gt;AllAuthUser&amp;lt;/role-name&amp;gt;</div><div class="line">    &amp;lt;/auth-constraint&amp;gt;</div><div class="line">    &amp;lt;user-data-constraint&amp;gt;</div><div class="line">        &amp;lt;transport-guarantee&amp;gt;NONE&amp;lt;/transport-guarantee&amp;gt;</div><div class="line">    &amp;lt;/user-data-constraint&amp;gt;</div><div class="line">&amp;lt;/security-constraint&amp;gt;</div></pre></td></tr></table></figure></p>
<h5 id="业务平台端环境配置"><a href="#业务平台端环境配置" class="headerlink" title="业务平台端环境配置"></a><strong>业务平台端环境配置</strong></h5><h6 id="修改web-xml-1"><a href="#修改web-xml-1" class="headerlink" title="修改web.xml"></a><strong>修改web.xml</strong></h6><p>需要在web.xml安全认证配置部分中增加用户登录的URL，红色部分需要根据应用修改，修改为允许访问的资源<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;security-constraint&amp;gt;</div><div class="line">    &amp;lt;web-resource-collection&amp;gt;</div><div class="line">        &amp;lt;web-resource-name&amp;gt;sso_EUIF&amp;lt;/web-resource-name&amp;gt;</div><div class="line">        &amp;lt;url-pattern&amp;gt;/abf_comm/default4portal.jsp&amp;lt;/url-pattern&amp;gt;</div><div class="line">    &amp;lt;/web-resource-collection&amp;gt;</div><div class="line">    &amp;lt;auth-constraint&amp;gt;</div><div class="line">        &amp;lt;role-name&amp;gt;AllAuthUser&amp;lt;/role-name&amp;gt;</div><div class="line">    &amp;lt;/auth-constraint&amp;gt;</div><div class="line">    &amp;lt;user-data-constraint&amp;gt;</div><div class="line">        &amp;lt;transport-guarantee&amp;gt;NONE&amp;lt;/transport-guarantee&amp;gt;</div><div class="line">    &amp;lt;/user-data-constraint&amp;gt;</div><div class="line">&amp;lt;/security-constraint&amp;gt;</div><div class="line">&amp;lt;login-config&amp;gt;</div><div class="line">    &amp;lt;auth-method&amp;gt;FORM&amp;lt;/auth-method&amp;gt;</div><div class="line">    &amp;lt;form-login-config&amp;gt;</div><div class="line">        &amp;lt;form-login-page&amp;gt;/abf_comm/login4portal.jsp&amp;lt;/form-login-page&amp;gt;</div><div class="line">        &amp;lt;form-error-page&amp;gt;/abf_comm/loginfailed4portal.jsp&amp;lt;/form-error-page&amp;gt;</div><div class="line">    &amp;lt;/form-login-config&amp;gt;</div><div class="line">&amp;lt;/login-config&amp;gt;</div><div class="line">&amp;lt;security-role&amp;gt;</div><div class="line">    &amp;lt;role-name&amp;gt;AllAuthUser&amp;lt;/role-name&amp;gt;</div><div class="line">&amp;lt;/security-role&amp;gt;</div></pre></td></tr></table></figure></p>
<p>修改welcome页面配置，这页面是登陆成功后系统指向的页面。<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;welcome-file-list&amp;gt;</div><div class="line">    &amp;lt;welcome-file&amp;gt;/abf_comm/default4portal.jsp&amp;lt;/welcome-file&amp;gt;</div><div class="line">&amp;lt;/welcome-file-list&amp;gt;</div></pre></td></tr></table></figure></p>
<p><strong>重启应用服务器</strong></p>
<p>正确设置上述配置后，需要重新启动应用服务器。</p>
<h4 id="WAS环境配置（将根据WAS7版本进行更新）"><a href="#WAS环境配置（将根据WAS7版本进行更新）" class="headerlink" title="WAS环境配置（将根据WAS7版本进行更新）"></a><strong>WAS环境配置（将根据WAS7版本进行更新）</strong></h4><h5 id="设置WAS的LTPA协议"><a href="#设置WAS的LTPA协议" class="headerlink" title="设置WAS的LTPA协议"></a><strong>设置WAS的LTPA协议</strong></h5><p>进入WAS控制台，URL是<a href="http://IP:consoleport/admin,输入安装时设置的用户名密码。" target="_blank" rel="external">http://IP:consoleport/admin,输入安装时设置的用户名密码。</a></p>
<p>&nbsp;</p>
<h6 id="设置安全角色到用户-组映射"><a href="#设置安全角色到用户-组映射" class="headerlink" title="设置安全角色到用户/组映射"></a><strong>设置安全角色到用户/组映射</strong></h6><p><img src="/media/sso-8.jpg" alt="sso-8"></p>
<p><img src="/media/sso-9.jpg" alt="sso-9"></p>
<h6 id="点击进入“安全管理、应用程序和基础结构”，设置安全性"><a href="#点击进入“安全管理、应用程序和基础结构”，设置安全性" class="headerlink" title="点击进入“安全管理、应用程序和基础结构”，设置安全性"></a><strong>点击进入“安全管理、应用程序和基础结构”，设置安全性</strong></h6><p><img src="/media/sso-10.jpg" alt="sso-10"></p>
<h6 id="设置LDAP连接"><a href="#设置LDAP连接" class="headerlink" title="设置LDAP连接"></a><strong>设置LDAP连接</strong></h6><p><img src="/media/sso-11.jpg" alt="sso-11"></p>
<h6 id="设置域名"><a href="#设置域名" class="headerlink" title="设置域名"></a><strong>设置域名</strong></h6><p><img src="/media/sso-12.jpg" alt="sso-12"></p>
<h6 id="需要导入密钥文件，密钥文件可以从其他的was的控制台导出。"><a href="#需要导入密钥文件，密钥文件可以从其他的was的控制台导出。" class="headerlink" title="需要导入密钥文件，密钥文件可以从其他的was的控制台导出。"></a><strong>需要导入密钥文件，密钥文件可以从其他的was的控制台导出。</strong></h6><p><img src="/media/sso-13.jpg" alt="sso-13"></p>
<h6 id="保存配置"><a href="#保存配置" class="headerlink" title="保存配置"></a><strong>保存配置</strong></h6><p><img src="/media/sso-14.jpg" alt="sso-14"></p>
<p>注意：任何修改都需要保存到主配置才能生效。</p>
<h5 id="设置WAS的Session的cookie值"><a href="#设置WAS的Session的cookie值" class="headerlink" title="设置WAS的Session的cookie值"></a><strong>设置WAS的Session的cookie值</strong></h5><h6 id="不同应用系统配置唯一Cookie值，防止多应用集成session丢失"><a href="#不同应用系统配置唯一Cookie值，防止多应用集成session丢失" class="headerlink" title="不同应用系统配置唯一Cookie值，防止多应用集成session丢失"></a><strong>不同应用系统配置唯一Cookie值，防止多应用集成session丢失</strong></h6><p><img src="/media/sso-15.jpg" alt="sso-15"></p>
<h5 id="重启应用服务器"><a href="#重启应用服务器" class="headerlink" title="重启应用服务器"></a><strong>重启应用服务器</strong></h5><p>进入应用服务器所在目录，重新启动服务器。</p>
<p>以WAS为例，需要输入如下命令：</p>
<p>#cd /epost/was61/IBM/WebSphere/AppServer/profiles/[profileName]/bin</p>
<p>停止server</p>
<p>./stopServer.sh server1 -username wpsadmin -password password</p>
<p>启动server</p>
<p>./startServer.sh server1</p>
<h4 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a><strong>使用方式</strong></h4><h5 id="要求及条件"><a href="#要求及条件" class="headerlink" title="要求及条件"></a><strong>要求及条件</strong></h5><ul>
<li>所有系统的底层平台都是采用WebSphere</li>
<li>系统本身的认证交给WebSphere底层平台来做</li>
<li>所有系统采用同一个LDAP或数据一致的LDAP来做认证</li>
<li>所有服务器必须在同一个网络域中</li>
<li>用全域名方式访问</li>
<li>所有服务器必须保证时间一致</li>
</ul>
<h5 id="场景描述"><a href="#场景描述" class="headerlink" title="场景描述"></a><strong>场景描述</strong></h5><p><img src="/media/sso-16.jpg" alt="sso-16"></p>
<p>1) 用户成功登录新一代UI；</p>
<p>2) 在用户的浏览器cookie值中保存WAS生成SSO加密信息(LTPA令牌)；</p>
<p>3) 用户通过新一代UI系统访问其它系统资源；</p>
<p>4) 由于浏览器cookie中保存SSO加密信息，且不过期，所以用户不需要登录，而由各个系统验证LTPA令牌达到访问业务系统资源的目的。</p>
<h5 id="安全性分析"><a href="#安全性分析" class="headerlink" title="安全性分析"></a><strong>安全性分析</strong></h5><h5 id="优势"><a href="#优势" class="headerlink" title="优势"></a><strong>优势</strong></h5><ul>
<li>WAS提供的SSO解决方案中只传递用户名，不传递密码，保证了密码安全。</li>
<li>LTPA经过加密处理，不会被暴露在外部；即使token被截取，如果没有密钥和口令，也无法获取到其中的内容。</li>
<li>最新版的WAS Ltpa使用先进的加密算法：Random salt；</li>
<li>强 AES 密码；</li>
<li>对数据签名；</li>
<li>对数据加密</li>
</ul>
<h5 id="存在的风险"><a href="#存在的风险" class="headerlink" title="存在的风险"></a>存在的风险</h5><p>WAS SSO机制安全性依赖于密钥（KEY）文件、密钥口令以及有权限读取LDAP信息的帐号和密码。如果这三项全部被人获得，其即可仿造一个在WAS信任域中的系统，并仿造用户信息。</p>
<p>需要做好密钥文件及口令的保管工作，并做好LDAP访问权限的管理，可预防此类风险的发生。</p>
<p>另外，此风险在实际操作过程中难度较大，不容易出现。</p>
<h3 id="附录一：常见SSO方案介绍"><a href="#附录一：常见SSO方案介绍" class="headerlink" title="附录一：常见SSO方案介绍"></a><strong>附录一：常见SSO方案介绍</strong></h3><h4 id="使用统一单点登录机制"><a href="#使用统一单点登录机制" class="headerlink" title="使用统一单点登录机制"></a><strong>使用统一单点登录机制</strong></h4><p>前提是所有系统所使用的底层平台必须是同一家公司的，而且系统本身的认证(Authentication)会交给底层平台来做。</p>
<p>WAS的SSO方案就属于这样类型，WAS和Domino等都是IBM的产品，都基于统一的SSO机制，所以它们可以直接支持统一单点登录机制。</p>
<p><img src="/media/sso-17.jpg" alt="sso-17"></p>
<p>图 1  使用统一单点登录机制方案图</p>
<h4 id="使用第三方系统来做单点登录"><a href="#使用第三方系统来做单点登录" class="headerlink" title="使用第三方系统来做单点登录"></a><strong>使用第三方系统来做单点登录</strong></h4><p>例如IBM Tivoli Access Manager或者Netegrity iteminder。</p>
<p><img src="/media/sso-18.jpg" alt="sso-18"></p>
<p>图 2  使用第三方系统来做单点登录方案图</p>
<h4 id="利用用户名-密码映射-maping-的方式"><a href="#利用用户名-密码映射-maping-的方式" class="headerlink" title="利用用户名/密码映射(maping)的方式"></a><strong>利用用户名/密码映射(maping)的方式</strong></h4><p>如果有系统提供映射方式的单点登录功能，例如WebSphere Portal Server。</p>
<p><img src="/media/sso-19.jpg" alt="sso-19"></p>
<p>图 3  利用用户名/密码映射(mappiing)的方式方案图</p>
<h4 id="其他方式"><a href="#其他方式" class="headerlink" title="其他方式"></a><strong>其他方式</strong></h4><p>各个系统约定SSO规则，如：各系统判断cookie里面是否存在用户信息以及加密串，从而实现SSO登录。</p>
<h3 id="附录二：单点登录产品介绍"><a href="#附录二：单点登录产品介绍" class="headerlink" title="附录二：单点登录产品介绍"></a><strong>附录二：单点登录产品介绍</strong></h3><h4 id="商业SSO软件"><a href="#商业SSO软件" class="headerlink" title="商业SSO软件"></a><strong>商业SSO软件</strong></h4><p>1) 专门的SSO商业软件</p>
<p>主要有：Netgrity的Siteminder，已经被CA收购。Novell 公司的iChain。RSA公司的ClearTrust等。</p>
<p>2) 门户产品供应商自己的SSO产品，</p>
<p>如： IBM 的Tivoli Access Manager，WAS自带的SSO解决方案，BEA的WLES，Sun 公司的identity Server，Oracle公司的OID等。</p>
<p>上述商业软件一般适用于客户对SSO的需求很高，并且企业内部采用WAS、Domino、SAP、Sieble等系统比较多的情况下。单点登录产品通常需要在应用软件中增加代理模块，而商业SSO产品主要针对大型软件制作了代码模块。</p>
<h4 id="开源SSO软件"><a href="#开源SSO软件" class="headerlink" title="开源SSO软件"></a><strong>开源SSO软件</strong></h4><p>1) Opensso</p>
<p> <a href="https://opensso.dev.java.net/" target="_blank" rel="external">https://opensso.dev.java.net/</a></p>
<p> OpenSSO基于Sun Java System Access Manager，是Sun公司支持的一个开源的SSO项目。</p>
<p> OpenSSO体系结构设计合理，功能比较强大。然而缺点是客户端支持不够广泛，似乎只是对基于J2EE的应用支持的比较好。</p>
<p>2) josso</p>
<p> <a href="http://www.josso.org/" target="_blank" rel="external">http://www.josso.org/</a></p>
<p> 这是另一个Java写的单点登录产品，通常认为比OpenSSO更成熟一些。</p>
<p> JOSSO支持的客户端包括Java，PHP和ASP。</p>
<p>3) CAS</p>
<p> <a href="http://www.ja-sig.org/products/cas/" target="_blank" rel="external">http://www.ja-sig.org/products/cas/</a></p>
<p> 这是耶鲁大学开发的单点登录产品。</p>
<p> CAS的优点很多，例如设计理念先进、体系结构合理、配置简单、客户端支持广泛、技术成熟等等。以后我们还要仔细介绍。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/05/08/unified-identity-access-control-system/" itemprop="url">
                  Unified Identity & Access Control system
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-05-08T13:14:50+08:00" content="2015-05-08">
              2015-05-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Project-Architecture/" itemprop="url" rel="index">
                    <span itemprop="name">Project Architecture</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/05/08/unified-identity-access-control-system/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/05/08/unified-identity-access-control-system/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>The target of this system is to build a unified user registry, enterprise organization hierarchy tree, a centralized point for internal user logon and authentication, a flexible Role-Based access control model and an integrated SSO strategy for all other in-house application.</p>
<p>This is the big picture:</p>
<p><img src="/media/euac.jpg" alt="euac"></p>
<h3 id="user-registry-and-organization-tree"><a href="#user-registry-and-organization-tree" class="headerlink" title="user registry and organization tree"></a>user registry and organization tree</h3><p>We build a central repository for employee information except their passwords(these are stored in LDAP for convenient look-up and security). These user information includes all kinds of static attributes related to an employee, like the positions, status, department…a long list.</p>
<p>We also sort out a whole organization tree, which represent the hierarchy relations between a department and another, like upper level or subordinate. These relations are especially useful for some application like workflow which exists very commonly in some office tasks.</p>
<p>So we regard the user information and organization is the pre-condition for enterprise integration and process optimization. Yes, it’s the foundation and infrastructure for enterprise applications.</p>
<p>We maintain these information in one central place to ensure its integrity. But we share these data and synchronized them with some applications. These applications own their local copy of these information and do querying locally for performance.</p>
<h3 id="identity-autentication"><a href="#identity-autentication" class="headerlink" title="identity / autentication"></a>identity / autentication</h3><p>Because we store the user name and password in LDAP. So the identification mainly depends on this service.</p>
<p>Keeping user name and password in LDAP is because we think the security and look-up performance concern. A dedicated server for the authentication makes things simple. And this is also the traditional way to implement identification.</p>
<h3 id="RBAC-Role-Based-Access-Control"><a href="#RBAC-Role-Based-Access-Control" class="headerlink" title="RBAC(Role-Based Access Control)"></a>RBAC(Role-Based Access Control)</h3><p>Another important thing for a big enterprise is the access control. If we distribute the access control into the applications themselves, even hard-code these logic instead of configuring them in a declarative way, that will be difficult to mange and there are some risks for security issues. After all, we cannot expect all our applications to make a enough emphasis on the access control problems.</p>
<p>So we implement a centralized access control model. We configure all kinds of application-specific function control in one shared place – the management console of our system, and in the development of these applications, the developers just need to apply these rules.</p>
<p>Basically, it’s according to the stable RBAC principal. We define:</p>
<p>1. a Role has many Functions. Functions represent the operations of user, basically you can think its a URL.</p>
<p>2. a User can have many Roles and a Role can have many users.</p>
<p>3. We also define Menu for some function which is regards the entry point for some module. And the menu has a hierarchy and can form a menu tree. This is useful to organization the functions of the application.</p>
<p>All these relations are stored in one place and can be share to specified application. Internal we support multiple applications, different applications configure their own profile and synchronized their own part of data.</p>
<h3 id="SSO"><a href="#SSO" class="headerlink" title="SSO"></a>SSO</h3><p>We use the cookie-based WebSphere SSO solution. Because websphere application server is the standard application server in my previous company and nearly every J2EE web application uses it.</p>
<p>The following is the basic implementation.</p>
<p><a href="/media/sso.jpg"><img src="/media/sso.jpg" alt="sso"></a></p>
<p>&nbsp;</p>
<p>You can see from the above figure, we use LDAP for an user registry. And any application needing SSO must do some configuration in their websphere management console to get the ability of SSO.</p>
<p>Obviously, this solution has some limitations:</p>
<ol>
<li>all the application must be under the same domain and accessed by domain name.</li>
<li>all the backend application server must be websphere app server.</li>
<li>use the shared user registry is a precondition.</li>
<li>time must be synchronized so that the timeout of the logon session can be determined</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/05/07/jndi-how-to/" itemprop="url">
                  JNDI how-to
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-05-07T10:09:04+08:00" content="2015-05-07">
              2015-05-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JNDI-LDAP/" itemprop="url" rel="index">
                    <span itemprop="name">JNDI, LDAP</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/05/07/jndi-how-to/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/05/07/jndi-how-to/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>JNDI - Java Naming and Directory Interface</p>
<h3 id="Object-storing"><a href="#Object-storing" class="headerlink" title="Object storing"></a>Object storing</h3><p>There are several ways an object satisfies the condition to be bound to a JDNI context.</p>
<ul>
<li>serializable objects: <code>Serializable</code></li>
<li>referenceable objects and references: <code>Reference, ObjectFactory, Referenceable, RefAddr</code></li>
<li>objects with attributes: <code>DirContext</code></li>
<li>remote objects: <code>Remote</code><br>&nbsp;</li>
</ul>
<p>Let’s look at the real life example: how we bind DataSource and UserTransaction to a JNDI context</p>
<h4 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">package</span> com.mysql.jdbc.jdbc2.optional;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MysqlDataSource</span> <span class="keyword">extends</span> <span class="title">ConnectionPropertiesImpl</span> <span class="keyword">implements</span> <span class="title">DataSource</span>, <span class="title">Referenceable</span>, <span class="title">Serializable</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">//....</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Reference <span class="title">getReference</span><span class="params">()</span> <span class="keyword">throws</span> NamingException </span>&#123;</div><div class="line">        String factoryName = <span class="string">"com.mysql.jdbc.jdbc2.optional.MysqlDataSourceFactory"</span>;</div><div class="line">        Reference ref = <span class="keyword">new</span> Reference(<span class="keyword">this</span>.getClass().getName(), factoryName, (String)<span class="keyword">null</span>);</div><div class="line">        ref.add(<span class="keyword">new</span> StringRefAddr(<span class="string">"user"</span>, <span class="keyword">this</span>.getUser()));</div><div class="line">        ref.add(<span class="keyword">new</span> StringRefAddr(<span class="string">"password"</span>, <span class="keyword">this</span>.password));</div><div class="line">        ref.add(<span class="keyword">new</span> StringRefAddr(<span class="string">"serverName"</span>, <span class="keyword">this</span>.getServerName()));</div><div class="line">        ref.add(<span class="keyword">new</span> StringRefAddr(<span class="string">"port"</span>, <span class="string">""</span> + <span class="keyword">this</span>.getPort()));</div><div class="line">        ref.add(<span class="keyword">new</span> StringRefAddr(<span class="string">"databaseName"</span>, <span class="keyword">this</span>.getDatabaseName()));</div><div class="line">        ref.add(<span class="keyword">new</span> StringRefAddr(<span class="string">"url"</span>, <span class="keyword">this</span>.getUrl()));</div><div class="line">        ref.add(<span class="keyword">new</span> StringRefAddr(<span class="string">"explicitUrl"</span>, String.valueOf(<span class="keyword">this</span>.explicitUrl)));</div><div class="line"></div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="keyword">this</span>.storeToRef(ref);</div><div class="line">            <span class="keyword">return</span> ref;</div><div class="line">        &#125; <span class="keyword">catch</span> (SQLException var4) &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NamingException(var4.getMessage());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//....</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Yes, it implements <code>Referenceable</code>, and defines an <code>ObjectFactory</code>: <code>com.mysql.jdbc.jdbc2.optional.MysqlDataSourceFactory</code></p>
<h4 id="H2"><a href="#H2" class="headerlink" title="H2"></a>H2</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">package</span> org.h2.jdbcx;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcDataSource</span> <span class="keyword">extends</span> <span class="title">TraceObject</span> <span class="keyword">implements</span> <span class="title">XADataSource</span>, <span class="title">DataSource</span>, <span class="title">ConnectionPoolDataSource</span>, <span class="title">Serializable</span>, <span class="title">Referenceable</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">//....</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Reference <span class="title">getReference</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.debugCodeCall(<span class="string">"getReference"</span>);</div><div class="line">        String var1 = JdbcDataSourceFactory.class.getName();</div><div class="line">        Reference var2 = <span class="keyword">new</span> Reference(<span class="keyword">this</span>.getClass().getName(), var1, (String)<span class="keyword">null</span>);</div><div class="line">        var2.add(<span class="keyword">new</span> StringRefAddr(<span class="string">"url"</span>, <span class="keyword">this</span>.url));</div><div class="line">        var2.add(<span class="keyword">new</span> StringRefAddr(<span class="string">"user"</span>, <span class="keyword">this</span>.userName));</div><div class="line">        var2.add(<span class="keyword">new</span> StringRefAddr(<span class="string">"password"</span>, <span class="keyword">this</span>.convertToString(<span class="keyword">this</span>.passwordChars)));</div><div class="line">        var2.add(<span class="keyword">new</span> StringRefAddr(<span class="string">"loginTimeout"</span>, String.valueOf(<span class="keyword">this</span>.loginTimeout)));</div><div class="line">        var2.add(<span class="keyword">new</span> StringRefAddr(<span class="string">"description"</span>, <span class="keyword">this</span>.description));</div><div class="line">        <span class="keyword">return</span> var2;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//....</span></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>It also implements <code>Referenceable</code>, and defines an <code>ObjectFactory</code>: <code>org.h2.jdbcx.JdbcDataSourceFactory</code></p>
<h4 id="JBoss-JTA"><a href="#JBoss-JTA" class="headerlink" title="JBoss JTA"></a>JBoss JTA</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">package</span> com.arjuna.ats.internal.jta.transaction.arjunacore;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserTransactionImple</span> <span class="keyword">extends</span> <span class="title">BaseTransaction</span> <span class="keyword">implements</span> <span class="title">UserTransaction</span>, <span class="title">ObjectFactory</span> </span>&#123;</div><div class="line">    <span class="comment">//....</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>You can see, <code>UserTrancation</code> implmentation class <code>UserTransactionImple</code> doesn’t implement <code>Referenceable</code>, but actions as <code>ObjectFactory</code>.</p>
<p>Now, let’s look at the bind code:<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">package</span> com.arjuna.ats.jta.utils;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JNDIManager</span> </span>&#123;</div><div class="line">    <span class="comment">//....</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bindJTAUserTransactionImplementation</span><span class="params">(InitialContext initialContext)</span> <span class="keyword">throws</span> NamingException </span>&#123;</div><div class="line">        String utImplementation = getUserTransactionImplementationClassname();</div><div class="line">        Reference ref = <span class="keyword">new</span> Reference(utImplementation, utImplementation, (String)<span class="keyword">null</span>);</div><div class="line">        initialContext.rebind(getUserTransactionJNDIName(), ref);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//....</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Yes, JBoss JTA binds <code>UserTransaction</code> using Reference with its <code>ObjectFactory</code>. As said above, <code>UserTransactionImple</code> is both the bound target and the <code>ObjectFactory</code>.</p>
<h3 id="Object-binding"><a href="#Object-binding" class="headerlink" title="Object binding"></a>Object binding</h3><p>So once the object can be bound, the binding operation is simple.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">context.bind(<span class="string">"cn=favorite"</span>, fruit);</div></pre></td></tr></table></figure></p>
<h3 id="Object-lookup-list-search"><a href="#Object-lookup-list-search" class="headerlink" title="Object lookup / list / search"></a>Object lookup / list / search</h3><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">context.lookup(..)</div></pre></td></tr></table></figure>
<p>&nbsp;</p>
<p>&nbsp;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/05/05/classloader/" itemprop="url">
                  ClassLoader
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-05-05T14:20:23+08:00" content="2015-05-05">
              2015-05-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JVM/" itemprop="url" rel="index">
                    <span itemprop="name">JVM</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/05/05/classloader/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/05/05/classloader/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="class-loader"><a href="#class-loader" class="headerlink" title="class loader"></a>class loader</h3><h4 id="Delegation-Principal"><a href="#Delegation-Principal" class="headerlink" title="Delegation Principal"></a>Delegation Principal</h4><blockquote>
<p>Class loaders request their parent to load the class first before attempting to load it themselves.<br><img src="/media/classloader1.jpg" alt="classloader1">           <img src="/media/classloader2.jpg" alt="classloader2"></p>
</blockquote>
<h4 id="Visibility-Principal"><a href="#Visibility-Principal" class="headerlink" title="Visibility Principal"></a>Visibility Principal</h4><blockquote>
<p>Classes loaded by the parent class loaders have visibility into classes loaded by its children down the hierarchy, but the reverse is not true<br><img src="/media/classloader3.jpg" alt="classloader3"></p>
</blockquote>
<h4 id="Uniqueness-Principal"><a href="#Uniqueness-Principal" class="headerlink" title="Uniqueness Principal"></a>Uniqueness Principal</h4><blockquote>
<p>When a class loader loads a class, the child class loaders in the hierarchy will never reload the class again. Hence uniqueness is maintained.<br>&nbsp;</p>
</blockquote>
<p>Although this, you are easy to violate this by manually loading the class. Thus, in a classloader hierarchy, there exists two Class with the same qualified name but loaded by different classloaders.</p>
<p>Then if you cast them, a ClassCastException will be thrown.</p>
<p>&nbsp;</p>
<h3 id="class-loading-ways"><a href="#class-loading-ways" class="headerlink" title="class loading ways"></a>class loading ways</h3><ul>
<li>explicitly invoke new XXX()</li>
<li>load its subclass, then the parent class will be also loaded</li>
<li>dynamically load class: Class.forName(“com.ss.xx.XXX”)<br>&nbsp;</li>
</ul>
<p>&nbsp;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/04/29/html-5/" itemprop="url">
                  HTML 5
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-04-28T23:27:29+08:00" content="2015-04-28">
              2015-04-28
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/HTML5/" itemprop="url" rel="index">
                    <span itemprop="name">HTML5</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/04/29/html-5/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/04/29/html-5/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="new-elements"><a href="#new-elements" class="headerlink" title="new elements"></a>new elements</h3><h4 id="amp-lt-figure-amp-gt-and-lt-figcaption-amp-gt"><a href="#amp-lt-figure-amp-gt-and-lt-figcaption-amp-gt" class="headerlink" title="&amp;lt;figure&amp;gt; and &lt;figcaption&amp;gt;"></a><code>&amp;lt;figure&amp;gt;</code> and &lt;<code>figcaption&amp;gt;</code></h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;figure id=<span class="string">"fig1"</span>&amp;gt;</div><div class="line">    &amp;lt;figcaption&amp;gt;Fig.1 Screen Reader Support <span class="keyword">for</span> WAI-ARIA&amp;lt;/figcaption&amp;gt;</div><div class="line">    &amp;lt;img src=<span class="string">"http://img2.cache.netease.com/cnews/2015/4/28/201504281107026599c.jpg"</span> alt=<span class="string">"JAWS: Landmarks 1/1, Forms 4/5 … "</span>&amp;gt;</div><div class="line">&amp;lt;/figure&amp;gt;</div></pre></td></tr></table></figure>
<h4 id="amp-lt-mark-amp-gt"><a href="#amp-lt-mark-amp-gt" class="headerlink" title="&amp;lt;mark&amp;gt;"></a><code>&amp;lt;mark&amp;gt;</code></h4><p>This tag is very useful for the highlight of searching result.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;h1&amp;gt;Yes, You Can Use &amp;lt;mark&amp;gt;HTML5&amp;lt;/mark&amp;gt; Today!&amp;lt;/h1&amp;gt;</div></pre></td></tr></table></figure></p>
<h4 id="amp-lt-progress-amp-gt-and-lt-meter-amp-gt"><a href="#amp-lt-progress-amp-gt-and-lt-meter-amp-gt" class="headerlink" title="&amp;lt;progress&amp;gt; and &lt;meter&amp;gt;"></a><code>&amp;lt;progress&amp;gt;</code> and &lt;<code>meter&amp;gt;</code></h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;progress max=<span class="string">"100"</span> value=<span class="string">"0"</span>&amp;gt;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;meter value=<span class="string">"50"</span> min=<span class="string">"0"</span> max=<span class="string">"400"</span> low=<span class="string">"60"</span> high=<span class="string">"300"</span> title=<span class="string">"gigabytes"</span>&amp;gt;</div><div class="line">&amp;lt;meter value=<span class="string">"150"</span> min=<span class="string">"0"</span> max=<span class="string">"400"</span> low=<span class="string">"60"</span> high=<span class="string">"300"</span> title=<span class="string">"gigabytes"</span>&amp;gt;</div><div class="line">&amp;lt;meter value=<span class="string">"350"</span> min=<span class="string">"0"</span> max=<span class="string">"400"</span> low=<span class="string">"60"</span> high=<span class="string">"300"</span> title=<span class="string">"gigabytes"</span>&amp;gt;</div></pre></td></tr></table></figure>
<p>the low and high are the thresholds. When in the range, the color is green, otherwise the color is yellow.</p>
<h4 id="lt-time-gt"><a href="#lt-time-gt" class="headerlink" title="&lt;time&gt;"></a>&lt;time&gt;</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;time datetime=<span class="string">"2015-10-12"</span>&amp;gt;<span class="number">12</span> October of <span class="keyword">this</span> year&amp;lt;/time&amp;gt;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;!-- month --&amp;gt;</div><div class="line">&amp;lt;time&amp;gt;<span class="number">2015</span>-<span class="number">11</span>&amp;lt;/time&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;!-- date --&amp;gt;</div><div class="line">&amp;lt;time&amp;gt;<span class="number">2015</span>-<span class="number">11</span>-<span class="number">12</span>&amp;lt;/time&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;!-- yearless date --&amp;gt;</div><div class="line">&amp;lt;time&amp;gt;<span class="number">11</span>-<span class="number">12</span>&amp;lt;/time&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;!-- time --&amp;gt;</div><div class="line">&amp;lt;time&amp;gt;<span class="number">14</span>:<span class="number">54</span>:<span class="number">39</span>&amp;lt;/time&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;!-- floating date and time --&amp;gt;</div><div class="line">&amp;lt;time&amp;gt;<span class="number">2015</span>-<span class="number">11</span>-<span class="number">12</span>T14:<span class="number">54</span>:<span class="number">39</span>&amp;lt;/time&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;!-- time-zone offset --&amp;gt;</div><div class="line">&amp;lt;time&amp;gt;-<span class="number">0800</span>&amp;lt;/time&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;!-- global date and time --&amp;gt;</div><div class="line">&amp;lt;time&amp;gt;<span class="number">2015</span>-<span class="number">11</span>-<span class="number">12</span>T06:<span class="number">54</span>:<span class="number">39.929</span>-<span class="number">0800</span>&amp;lt;/time&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;!-- week --&amp;gt;</div><div class="line">&amp;lt;time&amp;gt;<span class="number">2015</span>-W46&amp;lt;/time&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;!-- duration --&amp;gt;</div><div class="line">&amp;lt;time&amp;gt;<span class="number">4</span>h <span class="number">18</span>m <span class="number">3</span>s&amp;lt;/time&amp;gt;</div></pre></td></tr></table></figure>
<h4 id="lt-dl-gt-lt-dt-gt-lt-dd-gt"><a href="#lt-dl-gt-lt-dt-gt-lt-dd-gt" class="headerlink" title="&lt;dl&gt; &lt;dt&gt; &lt;dd&gt;"></a>&lt;dl&gt; &lt;dt&gt; &lt;dd&gt;</h4><p>This is called “description lists” or “association lists.”<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;dl&amp;gt;</div><div class="line">  &amp;lt;dt&amp;gt;Selector:&amp;lt;/dt&amp;gt;</div><div class="line">  &amp;lt;dd&amp;gt;<span class="function">The <span class="title">element</span><span class="params">(s)</span> targeted.&amp;lt</span>;/dd&amp;gt;</div><div class="line">  &amp;lt;dt&amp;gt;Property:&amp;lt;/dd&amp;gt;</div><div class="line">  &amp;lt;dd&amp;gt;The feature used to add styling to the targeted element, defined before a colon.&amp;lt;/dd&amp;gt;</div><div class="line">  &amp;lt;dt&amp;gt;Value:&amp;lt;/dd&amp;gt;</div><div class="line">  &amp;lt;dd&amp;gt;The value given to the specified property, declared after the colon.&amp;lt;/dd&amp;gt;</div><div class="line">&amp;lt;/dl&amp;gt;</div></pre></td></tr></table></figure></p>
<h4 id="lt-details-gt"><a href="#lt-details-gt" class="headerlink" title="&lt;details&gt;"></a>&lt;details&gt;</h4><p>This tag is very useful to implement initially hidden “see more” .<br><figure class="highlight"><table><tr><td class="code"><pre><div class="line">&amp;lt;details&amp;gt;</div><div class="line">  &amp;lt;summary&amp;gt;Some Magazines of Note&amp;lt;/summary&amp;gt;</div><div class="line">  &amp;lt;ul&amp;gt;</div><div class="line">    &amp;lt;li&amp;gt;&amp;lt;cite&amp;gt;Bird Watcher's Digest&amp;lt;/cite&amp;gt;&amp;lt;/li&amp;gt;</div><div class="line">    &amp;lt;li&amp;gt;&amp;lt;cite&amp;gt;Rower's Weekly&amp;lt;/cite&amp;gt;&amp;lt;/li&amp;gt;</div><div class="line">    &amp;lt;li&amp;gt;&amp;lt;cite&amp;gt;Fishing Monthly&amp;lt;/cite&amp;gt;&amp;lt;/li&amp;gt;</div><div class="line">  &amp;lt;/ul&amp;gt;</div><div class="line">&amp;lt;/details&amp;gt;</div></pre></td></tr></table></figure></p>
<h4 id="lt-ol-reversed-start-”3”-gt"><a href="#lt-ol-reversed-start-”3”-gt" class="headerlink" title="&lt;ol reversed start=”3”&gt;"></a>&lt;ol reversed start=”3”&gt;</h4><figure class="highlight"><table><tr><td class="code"><pre><div class="line">&amp;lt;ol reversed&amp;gt;</div><div class="line">    &amp;lt;li&amp;gt;&amp;lt;cite&amp;gt;Bird Watcher's Digest&amp;lt;/cite&amp;gt;&amp;lt;/li&amp;gt;</div><div class="line">    &amp;lt;li&amp;gt;&amp;lt;cite&amp;gt;Rower's Weekly&amp;lt;/cite&amp;gt;&amp;lt;/li&amp;gt;</div><div class="line">    &amp;lt;li&amp;gt;&amp;lt;cite&amp;gt;Fishing Monthly&amp;lt;/cite&amp;gt;&amp;lt;/li&amp;gt;</div><div class="line">&amp;lt;/ol&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;ol start="4"&amp;gt;</div><div class="line">    &amp;lt;li&amp;gt;&amp;lt;cite&amp;gt;Bird Watcher's Digest&amp;lt;/cite&amp;gt;&amp;lt;/li&amp;gt;</div><div class="line">    &amp;lt;li&amp;gt;&amp;lt;cite&amp;gt;Rower's Weekly&amp;lt;/cite&amp;gt;&amp;lt;/li&amp;gt;</div><div class="line">    &amp;lt;li&amp;gt;&amp;lt;cite&amp;gt;Fishing Monthly&amp;lt;/cite&amp;gt;&amp;lt;/li&amp;gt;</div><div class="line">&amp;lt;/ol&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;ol start="4" reversed&amp;gt;</div><div class="line">    &amp;lt;li&amp;gt;&amp;lt;cite&amp;gt;Bird Watcher's Digest&amp;lt;/cite&amp;gt;&amp;lt;/li&amp;gt;</div><div class="line">    &amp;lt;li&amp;gt;&amp;lt;cite&amp;gt;Rower's Weekly&amp;lt;/cite&amp;gt;&amp;lt;/li&amp;gt;</div><div class="line">    &amp;lt;li&amp;gt;&amp;lt;cite&amp;gt;Fishing Monthly&amp;lt;/cite&amp;gt;&amp;lt;/li&amp;gt;</div><div class="line">&amp;lt;/ol&amp;gt;</div></pre></td></tr></table></figure>
<h4 id="Scoped-Styles"><a href="#Scoped-Styles" class="headerlink" title="Scoped Styles"></a>Scoped Styles</h4><p>The scoped style is only valid for the specified element and its children.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;h1&amp;gt;Page Title&amp;lt;/h1&amp;gt;</div><div class="line">&amp;lt;article&amp;gt;</div><div class="line">  &amp;lt;style scoped&amp;gt;</div><div class="line">    h1 &#123;</div><div class="line">      color: blue;</div><div class="line">    &#125;</div><div class="line">  &amp;lt;/style&amp;gt;</div><div class="line">  &amp;lt;h1&amp;gt;Article Title&amp;lt;/h1&amp;gt;</div><div class="line">  &amp;lt;p&amp;gt;Article content.&amp;lt;/p&amp;gt;</div><div class="line">&amp;lt;/article&amp;gt;</div></pre></td></tr></table></figure></p>
<h4 id="the-deley-and-async-attribute-of-Scripts"><a href="#the-deley-and-async-attribute-of-Scripts" class="headerlink" title="the deley and async attribute of Scripts"></a>the <code>deley</code> and <code>async</code> attribute of Scripts</h4><p>Using <code>defer</code> specifies that the browser should wait until the page’s markup is parsed before loading the script.</p>
<p>The new <code>async</code> attribute allows you to specify that a script should load asynchronously.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;script type=<span class="string">"text/javascript"</span> src=<span class="string">"xxx.js"</span> async&amp;gt;&amp;lt;/script&amp;gt;</div></pre></td></tr></table></figure></p>
<h4 id="responsive-image"><a href="#responsive-image" class="headerlink" title="responsive image"></a>responsive image</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;picture src=<span class="string">""</span> srcset=<span class="string">""</span> sizes=<span class="string">""</span> &amp;gt;</div><div class="line"></div><div class="line">&amp;lt;img src=<span class="string">""</span> srcset=<span class="string">""</span> size=<span class="string">""</span> &amp;gt;</div></pre></td></tr></table></figure>
<h4 id="others"><a href="#others" class="headerlink" title="others"></a>others</h4><ul>
<li>&lt;dialog&gt;</li>
<li>&lt;a href=”1.pdf” dowload&gt;download this document&lt;/a&gt;</li>
<li>&lt;iframe sandbox seemless&gt;&lt;/iframe&gt;</li>
<li>&lt;menu&gt; &lt;menulist&gt;</li>
<li>&lt;address&gt;</li>
</ul>
<h3 id="HTML5-form"><a href="#HTML5-form" class="headerlink" title="HTML5 form"></a>HTML5 form</h3><h4 id="lt-input-required-gt"><a href="#lt-input-required-gt" class="headerlink" title="&lt;input required&gt;"></a>&lt;input required&gt;</h4><h4 id="lt-input-placeholder-””-gt"><a href="#lt-input-placeholder-””-gt" class="headerlink" title="&lt;input placeholder=””&gt;"></a>&lt;input placeholder=””&gt;</h4><h4 id="lt-input-pattern-””-gt"><a href="#lt-input-pattern-””-gt" class="headerlink" title="&lt;input pattern=””&gt;"></a>&lt;input pattern=””&gt;</h4><h4 id="lt-input-disabled-gt"><a href="#lt-input-disabled-gt" class="headerlink" title="&lt;input disabled&gt;"></a>&lt;input disabled&gt;</h4><h4 id="lt-input-readonly-gt"><a href="#lt-input-readonly-gt" class="headerlink" title="&lt;input readonly&gt;"></a>&lt;input readonly&gt;</h4><h4 id="lt-datalist-gt"><a href="#lt-datalist-gt" class="headerlink" title="&lt;datalist&gt;"></a>&lt;datalist&gt;</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;input type=<span class="string">"color"</span> list=<span class="string">"colors"</span> id=<span class="string">"favcolor"</span> name=<span class="string">"favcolor"</span>/&amp;gt;</div><div class="line">&amp;lt;datalist id=<span class="string">"colors"</span>&amp;gt;</div><div class="line">    &amp;lt;option value=<span class="string">"#0000FF"</span> label=<span class="string">"blue"</span>/&amp;gt;</div><div class="line">    &amp;lt;option value=<span class="string">"#008000"</span> label=<span class="string">"green"</span>/&amp;gt;</div><div class="line">    &amp;lt;option value=<span class="string">"#ff0000"</span> label=<span class="string">"red"</span>/&amp;gt;</div><div class="line">    &amp;lt;option value=<span class="string">"#663399"</span> label=<span class="string">"RebeccaPurple"</span>/&amp;gt;</div><div class="line">&amp;lt;/datalist&amp;gt;</div></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h4 id="autofocus-Attribute"><a href="#autofocus-Attribute" class="headerlink" title="autofocus Attribute"></a><code>autofocus</code> Attribute</h4><h4 id="new-input-type"><a href="#new-input-type" class="headerlink" title="new input type"></a>new input type</h4><ul>
<li><code>search</code></li>
<li><code>email</code></li>
<li><code>url</code></li>
<li><code>tel</code></li>
<li><code>date</code></li>
<li><code>time</code></li>
<li><code>number</code></li>
<li><code>range</code></li>
<li><code>color</code></li>
</ul>
<h4 id="lt-form-novalidate-amp-gt"><a href="#lt-form-novalidate-amp-gt" class="headerlink" title="&lt;form novalidate&amp;gt;"></a>&lt;form <code>novalidate&amp;gt;</code></h4>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/04/28/git-basics/" itemprop="url">
                  Git basics
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-04-28T13:50:15+08:00" content="2015-04-28">
              2015-04-28
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Version-Control/" itemprop="url" rel="index">
                    <span itemprop="name">Version Control</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/04/28/git-basics/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/04/28/git-basics/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><a href="http://think-like-a-git.net/" target="_blank" rel="external">http://think-like-a-git.net/</a></li>
<li><a href="http://marklodato.github.io/visual-git-guide/index-en.html" target="_blank" rel="external">http://marklodato.github.io/visual-git-guide/index-en.html</a></li>
<li><a href="https://www.atlassian.com/git/tutorials/" target="_blank" rel="external">https://www.atlassian.com/git/tutorials/</a></li>
</ul>
<h3 id="local-repository"><a href="#local-repository" class="headerlink" title="local repository"></a>local repository</h3><h4 id="checkout"><a href="#checkout" class="headerlink" title="checkout"></a>checkout</h4><h5 id="checkout-lt-branch-gt"><a href="#checkout-lt-branch-gt" class="headerlink" title="checkout &lt;branch&gt;"></a>checkout &lt;branch&gt;</h5><blockquote>
<p>switch branch<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">git checkout dev</div></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="/media/checkout-branch.png" alt="checkout-branch"></p>
<h5 id="checkout-lt-commit-gt-files"><a href="#checkout-lt-commit-gt-files" class="headerlink" title="checkout &lt;commit&gt; [files]"></a>checkout &lt;commit&gt; [files]</h5><blockquote>
<p>&lt;commit&gt; is HEAD by default. The current branch doesn’t change, without moving the HEAD pointer location.</p>
<p>copy the &lt;commit&gt; tree to index tree and working tree.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">git checkout HEAD</div><div class="line">git checkout HEAD^</div><div class="line">git checkout HEAD~<span class="number">3</span> <span class="number">1</span>.txt</div><div class="line">git checkout a47c3</div></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="/media/chckout-files.png" alt="chckout-files"></p>
<h4 id="reset"><a href="#reset" class="headerlink" title="reset"></a>reset</h4><h5 id="reset-lt-commit-gt-files"><a href="#reset-lt-commit-gt-files" class="headerlink" title="reset &lt;commit&gt; [files]"></a>reset &lt;commit&gt; [files]</h5><blockquote>
<p>move the HEAD, and copying &lt;commit&gt; tree to index or working tree.</p>
<p>three mode:</p>
<p>–soft: no copy. move HEAD</p>
<p>–mixed: copy to index only. move HEAD   = reverse <code>git add</code></p>
<p>–hard: copy to index and working tree. move HEAD<br>&nbsp;<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">git reset HEAD^<span class="number">3</span></div><div class="line">git reset HEAD <span class="number">1</span>.txt  = reset -- <span class="number">1</span>.txt</div><div class="line">git reset HEAD^ <span class="number">1</span>.txt</div></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="/media/reset-commit.png" alt="reset-commit"></p>
<h4 id="diff"><a href="#diff" class="headerlink" title="diff"></a>diff</h4><h5 id="git-diff"><a href="#git-diff" class="headerlink" title="git diff"></a>git diff</h5><p>working &lt;=&gt; index</p>
<h5 id="git-diff-–cache"><a href="#git-diff-–cache" class="headerlink" title="git diff –cache"></a>git diff –cache</h5><p>index &lt;=&gt; HEAD</p>
<h5 id="git-diff-HEAD"><a href="#git-diff-HEAD" class="headerlink" title="git diff HEAD"></a>git diff HEAD</h5><p>working &lt;=&gt; HEAD</p>
<h5 id="git-diff-HEAD-1"><a href="#git-diff-HEAD-1" class="headerlink" title="git diff HEAD^^"></a>git diff HEAD^^</h5><p>working &lt;=&gt; HEAD^^</p>
<h5 id="git-diff-da985-b325c"><a href="#git-diff-da985-b325c" class="headerlink" title="git diff da985 b325c"></a>git diff da985 b325c</h5><p>da985 &lt;=&gt; b325c</p>
<h5 id="git-diff-lt-branch-gt"><a href="#git-diff-lt-branch-gt" class="headerlink" title="git diff &lt;branch&gt;"></a>git diff &lt;branch&gt;</h5><p>working &lt;=&gt; &lt;branch&gt; HEAD</p>
<p><img src="/media/git-diff.png" alt="git-diff"></p>
<h4 id="merge"><a href="#merge" class="headerlink" title="merge"></a>merge</h4><h5 id="fast-forward-merge"><a href="#fast-forward-merge" class="headerlink" title="fast-forward merge"></a>fast-forward merge</h5><p><img src="/media/ff-merge.png" alt="ff-merge"></p>
<h5 id="3-way-merge"><a href="#3-way-merge" class="headerlink" title="3-way merge"></a>3-way merge</h5><p><img src="/media/3-way-merge.png" alt="3-way-merge"></p>
<h4 id="cherry-pick-and-rebase"><a href="#cherry-pick-and-rebase" class="headerlink" title="cherry-pick and rebase"></a>cherry-pick and rebase</h4><p><img src="/media/cherry-pick.png" alt="cherry-pick"></p>
<p><img src="/media/rebase.png" alt="rebase"></p>
<h3 id="remote-repository"><a href="#remote-repository" class="headerlink" title="remote repository"></a>remote repository</h3><h4 id="remote"><a href="#remote" class="headerlink" title="remote"></a>remote</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">remote</div><div class="line">remote -v</div><div class="line"></div><div class="line">remote add &amp;lt;remote_repo_name&amp;gt; &amp;lt;url&amp;gt;</div><div class="line">git remote add origin git<span class="meta">@github</span>.com:richdyang/<span class="number">1</span>.git</div></pre></td></tr></table></figure>
<h4 id="push"><a href="#push" class="headerlink" title="push"></a>push</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">push -u &amp;lt;remote_repo_name&amp;gt; &amp;lt;branch&amp;gt;</div><div class="line">push</div></pre></td></tr></table></figure>
<h4 id="pull"><a href="#pull" class="headerlink" title="pull"></a>pull</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">git pull</div></pre></td></tr></table></figure>
<p>&nbsp;</p>
<p>&nbsp;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/04/26/spring-framework-context-services/" itemprop="url">
                  Spring framework - context services
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-04-25T20:17:32+08:00" content="2015-04-25">
              2015-04-25
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Spring/" itemprop="url" rel="index">
                    <span itemprop="name">Spring</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/04/26/spring-framework-context-services/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/04/26/spring-framework-context-services/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Bean-Lifecycle-Mangement"><a href="#Bean-Lifecycle-Mangement" class="headerlink" title="Bean Lifecycle Mangement"></a>Bean Lifecycle Mangement</h3><p>&nbsp;</p>
<p><img src="/media/spring-bean-lifecycle.jpg" alt="spring-bean-lifecycle"><br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">package</span> context.lifecycle;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.springframework.beans.BeansException;</div><div class="line"><span class="keyword">import</span> org.springframework.beans.factory.BeanClassLoaderAware;</div><div class="line"><span class="keyword">import</span> org.springframework.beans.factory.BeanNameAware;</div><div class="line"><span class="keyword">import</span> org.springframework.beans.factory.DisposableBean;</div><div class="line"><span class="keyword">import</span> org.springframework.beans.factory.InitializingBean;</div><div class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</div><div class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContextAware;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.annotation.PostConstruct;</div><div class="line"><span class="keyword">import</span> javax.annotation.PreDestroy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LifecycleExposureBean</span> <span class="keyword">implements</span> <span class="title">BeanNameAware</span>, <span class="title">BeanClassLoaderAware</span>, <span class="title">ApplicationContextAware</span>, <span class="title">InitializingBean</span>, <span class="title">DisposableBean</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> String injectedProperty;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setInjectedProperty</span><span class="params">(String injectedProperty)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Injection: injectedProperty = ["</span> + injectedProperty + <span class="string">"]"</span>);</div><div class="line">        <span class="keyword">this</span>.injectedProperty = injectedProperty;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//----------------context aware-------------------------</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBeanName</span><span class="params">(String beanName)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"BeanNameAware: beanName = ["</span> + beanName + <span class="string">"]"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBeanClassLoader</span><span class="params">(ClassLoader classLoader)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"BeanClassLoaderAware: classLoader = ["</span> + classLoader + <span class="string">"]"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException </span>&#123;</div><div class="line">        System.out.println(<span class="string">"ApplicationAware: applicationContext = ["</span> + applicationContext + <span class="string">"]"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//----------------initialization hook-------------------------</span></div><div class="line"></div><div class="line">    <span class="meta">@PostConstruct</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postContructCallBack</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"@PostContruc: Post contruct invocation"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        System.out.println(<span class="string">"IntializingBean: afterPropertiesSet() called"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initMethod</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"init-method: called"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//----------------destroy hook-------------------------</span></div><div class="line">    <span class="meta">@PreDestroy</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">preDestroy</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"@PreDestory: called"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        System.out.println(<span class="string">"DisposableBean: destroy() called"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroyMethod</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"destroy-method: called"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        GenericXmlApplicationContext context = <span class="keyword">new</span> GenericXmlApplicationContext(<span class="string">"classpath:spring-lifecycle.xml"</span>);</div><div class="line"></div><div class="line">        context.destroy();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&amp;gt;</div><div class="line">&amp;lt;beans xmlns=<span class="string">"http://www.springframework.org/schema/beans"</span></div><div class="line">       xmlns:p=<span class="string">"http://www.springframework.org/schema/p"</span></div><div class="line">       xmlns:xsi=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       xsi:schemaLocation=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&amp;gt;</div><div class="line"></div><div class="line">       &amp;lt;bean <span class="class"><span class="keyword">class</span></span>=<span class="string">"context.lifecycle.LifecycleExposureBean"</span> init-method=<span class="string">"initMethod"</span> destroy-method=<span class="string">"destroyMethod"</span>&amp;gt;</div><div class="line">              &amp;lt;property name=<span class="string">"injectedProperty"</span> value=<span class="string">"This is the value of injected property"</span> /&amp;gt;</div><div class="line">       &amp;lt;/bean&amp;gt;</div><div class="line">&amp;lt;/beans&amp;gt;</div></pre></td></tr></table></figure>
<blockquote>
<p>Injection: injectedProperty = [This is the value of injected property]</p>
<p>BeanNameAware: beanName = [context.lifecycle.LifecycleExposureBean#0]</p>
<p>BeanClassLoaderAware: classLoader = [sun.misc.Launcher$AppClassLoader@330bedb4]</p>
<p>ApplicationAware: applicationContext = [org.springframework.context.support.GenericXmlApplicationContext@18769467: startup date [Sat Apr 25 19:38:10 CST 2015]; root of context hierarchy]</p>
<p>IntializingBean: afterPropertiesSet() called</p>
<p>init-method: called</p>
<p>DisposableBean: destroy() called</p>
<p>destroy-method: called</p>
</blockquote>
<h3 id="FactoryBean"><a href="#FactoryBean" class="headerlink" title="FactoryBean"></a>FactoryBean</h3><p>When a bean depends on some beans which cannot be simply intialized by using <code>new</code></p>
<ul>
<li>implement <code>FactoryBean&amp;lt;T&amp;gt;</code></li>
<li>specify <code>&lt;span class=&quot;FontName1&quot;&gt;factory-bean&lt;/span&gt;</code> and <code>&lt;span class=&quot;FontName1&quot;&gt;factory-method&lt;/span&gt;</code></li>
</ul>
<h3 id="PropertyEditor"><a href="#PropertyEditor" class="headerlink" title="PropertyEditor"></a>PropertyEditor</h3><p>In String, PropertyEditior is mainly used as a kind of converter from String to POJO JavaBean.</p>
<p>You implement your custom PropertyEditor for the specified JavaBean class, and then configure it using <code>org.springframework.beans.factory.config.CustomEditorConfigurer</code><br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomBean</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String firstName;</div><div class="line">    <span class="keyword">private</span> String lastName;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomBean</span><span class="params">(String firstName, String lastName)</span> </span>&#123;</div><div class="line">    	<span class="keyword">this</span>.firstName = firstName;</div><div class="line">    	<span class="keyword">this</span>.lastName = lastName;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">    	<span class="keyword">return</span> <span class="string">"First name: "</span> + firstName + <span class="string">", last name: "</span> + lastName;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomBeanEditor</span> <span class="keyword">extends</span> <span class="title">PropertyEditorSupport</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAsText</span><span class="params">(String text)</span> </span>&#123;</div><div class="line">        String[] segs = text.split(<span class="string">" "</span>);</div><div class="line">        CustomBean customBean = <span class="keyword">new</span> CustomBean(segs[<span class="number">0</span>], segs[<span class="number">1</span>]);</div><div class="line"></div><div class="line">        setValue(customBean);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;bean id=<span class="string">"customEditorConfigurer"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"org.springframework.beans.factory.config.CustomEditorConfigurer"</span>&amp;gt;</div><div class="line">	&amp;lt;property name=<span class="string">"customEditors"</span>&amp;gt;</div><div class="line">		&amp;lt;map&amp;gt;</div><div class="line">			&amp;lt;entry key=<span class="string">"context.propertyeditor.CustomBean"</span> value=<span class="string">"context.propertyeditor.CustomBeanEditor"</span> /&amp;gt;</div><div class="line">		&amp;lt;/map&amp;gt;</div><div class="line">	&amp;lt;/property&amp;gt;</div><div class="line">&amp;lt;/bean&amp;gt;</div></pre></td></tr></table></figure>
<h3 id="ApplicationContext-capabilities"><a href="#ApplicationContext-capabilities" class="headerlink" title="ApplicationContext capabilities"></a>ApplicationContext capabilities</h3><p>Basically, AppliationContext has more extra capabilities than BeanFactory.</p>
<p>You can regard ApplicationContext as a <code>MessageSource</code>, an <code>ApplicationEventPublisher</code>, a <code>ResourceLoader</code>.</p>
<h4 id="MessageSource"><a href="#MessageSource" class="headerlink" title="MessageSource"></a>MessageSource</h4><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">&amp;lt;bean id=<span class="string">"messageSource"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"org.springframework.context.support.ResourceBundleMessageSource"</span>&amp;gt;</div><div class="line">    &amp;lt;property name=<span class="string">"basenames"</span>&amp;gt;</div><div class="line">        &amp;lt;list&amp;gt;</div><div class="line">            &amp;lt;value&amp;gt;message&amp;lt;/value&amp;gt;</div><div class="line">        &amp;lt;/list&amp;gt;</div><div class="line">    &amp;lt;/property&amp;gt;</div><div class="line">&amp;lt;/bean&amp;gt;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">GenericXmlApplicationContext context = <span class="keyword">new</span> GenericXmlApplicationContext(<span class="string">"classpath:spring-messagesource.xml"</span>);</div><div class="line"></div><div class="line">String name = <span class="string">"Richard"</span>;</div><div class="line">String greeting = context.getMessage(<span class="string">"greeting"</span>, <span class="keyword">new</span> String[]&#123;name&#125;, Locale.US);</div><div class="line">String greetingCN = context.getMessage(<span class="string">"greeting"</span>, <span class="keyword">new</span> String[]&#123;name&#125;, Locale.CHINA);</div><div class="line"></div><div class="line">System.out.println(<span class="string">"greeting = ["</span> + greeting + <span class="string">"]"</span>);</div><div class="line">System.out.println(<span class="string">"greetingCN = ["</span> + greetingCN + <span class="string">"]"</span>);</div></pre></td></tr></table></figure>
<p>Then I have two message file: message_en_US.properties and message_zh_CN<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">greeting=你好, &#123;<span class="number">0</span>&#125;！</div></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">greeting=How is it going, &#123;<span class="number">0</span>&#125;?</div></pre></td></tr></table></figure>
<p>Output:</p>
<blockquote>
<p>greeting = [How is it going, Richard?]</p>
<p>greetingCN = [你好, Richard！]</p>
</blockquote>
<h4 id="Application-Events"><a href="#Application-Events" class="headerlink" title="Application Events"></a>Application Events</h4><p><code>ApplicationEvent</code>  – derive from java.util.<code>EventObject</code></p>
<p><code>ApplicationListener&amp;lt;T&amp;gt;</code> interface</p>
<p><code>ApplicationEventPublisher.publishEvent()</code></p>
<p><code>ApplicationContext</code> implements <code>ApplicationEventPublisher</code> interface</p>
<h4 id="resource-accessing"><a href="#resource-accessing" class="headerlink" title="resource accessing"></a>resource accessing</h4><p>org.springframework.core.io.Resource</p>
<p>ResourceLoader</p>
<p>ApplicationContext implements ResourceLoader</p>
<h4 id="Environment-and-PropertySource-Abstraction"><a href="#Environment-and-PropertySource-Abstraction" class="headerlink" title="Environment and PropertySource Abstraction"></a>Environment and PropertySource Abstraction</h4><p>Environment –&gt; PropertySource<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">ConfigurableEnvironment env =&amp;amp;nbsp;ctx.getEnvironment();</div><div class="line">MutablePropertySources propertySources =&amp;amp;nbsp;env.getPropertySources();</div><div class="line"></div><div class="line">Map appMap =&amp;amp;nbsp;<span class="keyword">new</span> HashMap();</div><div class="line">appMap.put(<span class="string">"application.home"</span>, <span class="string">"application_home"</span>);</div><div class="line"></div><div class="line">propertySources.addLast(<span class="keyword">new</span> MapPropertySource(<span class="string">"application_properties"</span>, appMap));</div></pre></td></tr></table></figure></p>
<p>For the <span class="FontName1">PropertySource</span> abstraction, Spring will access the properties in the following default order:<a id="cXXX.328"></a></p>
<ul>
<li>System properties for the running JVM (-Dxxxx)</li>
<li>Environment variables (like JAVA_HOME, Path)</li>
<li>Application-defined properties<br>Most of time, we use PropertyPlaceHolder<figure class="highlight"><table><tr><td class="code"><pre><div class="line">&amp;lt;beans xmlns="http://www.springframework.org/schema/beans"</div><div class="line">    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</div><div class="line">    xmlns:context="http://www.springframework.org/schema/context"</div><div class="line">    xsi:schemaLocation="http://www.springframework.org/schema/beans</div><div class="line">        http://www.springframework.org/schema/beans/spring-beans.xsd</div><div class="line">        http://www.springframework.org/schema/context</div><div class="line">        http://www.springframework.org/schema/context/spring-context.xsd"&amp;gt;</div><div class="line"></div><div class="line">    &amp;lt;context:property-placeholder location="classpath:application.properties"/&amp;gt;</div><div class="line"></div><div class="line">    &amp;lt;bean id="somebean" class="com.apress.prospring4.ch4.AppProperty"&amp;gt;</div><div class="line">        &amp;lt;property name="applicationHome" value="$&#123;application.home&#125;"/&amp;gt;</div><div class="line">        &amp;lt;property name="userHome" value="$&#123;user.home&#125;"&amp;gt;&amp;lt;/property&amp;gt;</div><div class="line">    &amp;lt;/bean&amp;gt;</div><div class="line">&amp;lt;/beans&amp;gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>You can see, once you get the properties, you can use them in configuration files using <code>{....}</code></p>
<p>&nbsp;</p>
<h3 id="Profiles"><a href="#Profiles" class="headerlink" title="Profiles"></a>Profiles</h3><p>Basically, a <em>profile</em> instructs Spring to configure only the<span class="FontName1">ApplicationContext</span> that was defined when the specified profile was active.</p>
<ul>
<li>How to associated with a profile?<figure class="highlight"><table><tr><td class="code"><pre><div class="line">&amp;lt;beans xmlns="http://www.springframework.org/schema/beans"</div><div class="line">    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</div><div class="line">    xsi:schemaLocation="http://www.springframework.org/schema/beans</div><div class="line">        http://www.springframework.org/schema/beans/spring-beans.xsd"</div><div class="line">        profile="devProfile"&amp;gt;</div><div class="line">...</div><div class="line">&amp;lt;/bean&amp;gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>Those beans in the file should be instantiated only when the specified profile is <span class="FontName1">active. If its profile is not active, actually these beans will not be initialized.</span></p>
<ul>
<li>How to activate</li>
</ul>
<ol>
<li>JVM argument <span class="FontName1">-Dspring.profiles.active=”devProfile”</span></li>
<li>ctx.getEnvironment().setActiveProfiles(“devProfile”)</li>
</ol>
<p>### </p>
<p>&nbsp;</p>
<p>&nbsp;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/04/23/whats-the-difference-between-getname-getsimplename-getcanonicalname-of-class/" itemprop="url">
                  what's the difference between getName(), getSimpleName(), getCanonicalName() of Class?
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-04-23T19:02:25+08:00" content="2015-04-23">
              2015-04-23
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Q-A/" itemprop="url" rel="index">
                    <span itemprop="name">Q/A</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/04/23/whats-the-difference-between-getname-getsimplename-getcanonicalname-of-class/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/04/23/whats-the-difference-between-getname-getsimplename-getcanonicalname-of-class/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="comment">//primitive</span></div><div class="line">System.out.println(<span class="keyword">int</span>.class.getName());</div><div class="line">System.out.println(<span class="keyword">int</span>.class.getCanonicalName());</div><div class="line">System.out.println(<span class="keyword">int</span>.class.getSimpleName());</div><div class="line"></div><div class="line">System.out.println();</div><div class="line"></div><div class="line"><span class="comment">//class</span></div><div class="line">System.out.println(String.class.getName());</div><div class="line">System.out.println(String.class.getCanonicalName());</div><div class="line">System.out.println(String.class.getSimpleName());</div><div class="line"></div><div class="line">System.out.println();</div><div class="line"></div><div class="line"><span class="comment">//inner class</span></div><div class="line">System.out.println(HashMap.SimpleEntry.class.getName());</div><div class="line">System.out.println(HashMap.SimpleEntry.class.getCanonicalName());</div><div class="line">System.out.println(HashMap.SimpleEntry.class.getSimpleName());</div><div class="line"></div><div class="line">System.out.println();</div><div class="line"></div><div class="line"><span class="comment">//anonymous inner class</span></div><div class="line">System.out.println(<span class="keyword">new</span> Serializable()&#123;&#125;.getClass().getName());</div><div class="line">System.out.println(<span class="keyword">new</span> Serializable()&#123;&#125;.getClass().getCanonicalName());</div><div class="line">System.out.println(<span class="keyword">new</span> Serializable()&#123;&#125;.getClass().getSimpleNam());</div></pre></td></tr></table></figure>
<p>&nbsp;</p>
<p>Prints:</p>
<blockquote>
<p>int</p>
<p>int</p>
<p>int</p>
<p>java.lang.String</p>
<p>java.lang.String</p>
<p>String</p>
<p>java.util.AbstractMap$SimpleEntry</p>
<p>java.util.AbstractMap.SimpleEntry</p>
<p>SimpleEntry</p>
<p>ClassnameTest$1</p>
<p>null<br>There’s an empty line in the last block where getSimpleName returns an empty string.</p>
</blockquote>
<p>The upshot looking at this is:</p>
<p>the name is the name that you’d use to dynamically load the class with, for example, a call to Class.forName with the default classloader.<br>the canonical name is the name that would be used in an import statement and uniquely identifies the class. Might be useful during toString or logging operations.<br>the simple name loosely identifies the class, again might be useful during toString or logging operations but is not guaranteed to be unique.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/04/23/whats-the-difference-between-getpath-getabsolutepath-and-getcanonicalpath/" itemprop="url">
                  What's the difference between getPath(), getAbsolutePath(), and getCanonicalPath()?
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-04-23T18:56:07+08:00" content="2015-04-23">
              2015-04-23
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Q-A/" itemprop="url" rel="index">
                    <span itemprop="name">Q/A</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/04/23/whats-the-difference-between-getpath-getabsolutepath-and-getcanonicalpath/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/04/23/whats-the-difference-between-getpath-getabsolutepath-and-getcanonicalpath/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Consider these filenames:</p>
<ul>
<li>C:\temp\file.txt - This is a path, an absolute path, and a canonical path.</li>
<li>.\file.txt - This is a path. It’s neither an absolute path nor a canonical path.</li>
<li>C:\temp\myapp\bin..\..\file.txt - This is a path and an absolute path. It’s not a canonical path.<br>A canonical path is always an absolute path.</li>
</ul>
<p>Converting from a path to a canonical path makes it absolute (usually tack on the current working directory so e.g. ./file.txt becomes c:/temp/file.txt). The canonical path of a file just “purifies” the path, removing and resolving stuff like ..\ and resolving symlinks (on unixes).</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://qph.is.quoracdn.net/main-thumb-27403014-200-azcnfpakpayhgojvmueqcfjeyufbjpcx.jpeg"
               alt="Richard Yang" />
          <p class="site-author-name" itemprop="name">Richard Yang</p>
          <p class="site-description motion-element" itemprop="description">Nothing seek, nothing find</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">133</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">48</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="http://linkedin.com/in/richdyang" target="_blank" title="Linkedin">
                  
                    <i class="fa fa-fw fa-linkedin"></i>
                  
                  Linkedin
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://github.com/richdyang" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-github-alt"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://bitbucket.org/richdyang" target="_blank" title="Bitbucket">
                  
                    <i class="fa fa-fw fa-bitbucket"></i>
                  
                  Bitbucket
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://stackoverflow.com/users/4344443/richard" target="_blank" title="Stackoverflow">
                  
                    <i class="fa fa-fw fa-stack-overflow"></i>
                  
                  Stackoverflow
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://twitter.com/richdyang" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2013 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Richard Yang</span>
</div>

<!--div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div-->

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'richyang';
      var disqus_identifier = 'page/4/index.html';
      var disqus_title = '';

      function run_disqus_script(disqus_script) {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');

      

    </script>
  




  
  

  

  

  
  

  
  
  
  <link rel="stylesheet" href="/vendors/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/vendors/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.0"></script>



</body>
</html>
