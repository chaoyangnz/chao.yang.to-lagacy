<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Richard Yang, Java Developer, Senior software engineer" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="IntroductionFive forms of method invocation in Java:

invokevirtual
invokeinterface
invokestatic
invokespecial
invokedynamic

invokestatic and invokevirtualOf these, invokestatic and invokevirtual are">
<meta property="og:type" content="article">
<meta property="og:title" content="How JVM handle method invocation">
<meta property="og:url" content="https://richyang.me/2016/08/22/how-jvm-handle-method-invocation/index.html">
<meta property="og:site_name" content="Richard Yang">
<meta property="og:description" content="IntroductionFive forms of method invocation in Java:

invokevirtual
invokeinterface
invokestatic
invokespecial
invokedynamic

invokestatic and invokevirtualOf these, invokestatic and invokevirtual are">
<meta property="og:updated_time" content="2016-09-09T08:32:24.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How JVM handle method invocation">
<meta name="twitter:description" content="IntroductionFive forms of method invocation in Java:

invokevirtual
invokeinterface
invokestatic
invokespecial
invokedynamic

invokestatic and invokevirtualOf these, invokestatic and invokevirtual are">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    },
    algolia: {
      applicationID: 'X0H1P7HDKY',
      apiKey: 'ddc0af00a6e07c9b1be9f4da4cf5b9d9',
      indexName: 'richyang.me',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>




  <title> How JVM handle method invocation | Richard Yang </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <!--span class="logo-line-before"><i></i></span-->
      <span class="site-title">Richard Yang</span>
      <!--span class="logo-line-after"><i></i></span-->
    </a>
  </div>
  <p class="site-subtitle">Full-stack software engineer mainly focusing on Java-based technologies and web front-end</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            Home
          </a>
        </li>
        
      
        
        
        <li class="menu-item menu-item-books">
          <a href="https://www.gitbook.com/@richdyang" rel="section">
            
            Books
          </a>
        </li>
        
      
        
        
        <li class="menu-item menu-item-showcase">
          <a href="/showcase" rel="section">
            
            Showcase
          </a>
        </li>
        
      
        
        
        <li class="menu-item menu-item-resume">
          <a href="http://linkedin.com/in/richdyang" rel="section">
            
            Résumé
          </a>
        </li>
        
      
        
        
      
        
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
            About
          </a>
        </li>
        
      
        
        
      
        
        
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
            <i class="menu-item-icon fa fa-search fa-lg"></i>Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>

<div class="social-links" style="float: right; padding-left: 50px; margin-right: 10px">
      
        
          <span class="links-of-author-item">
            <a href="http://linkedin.com/in/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-linkedin"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://github.com/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-github-alt"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://bitbucket.org/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-bitbucket"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://stackoverflow.com/users/4344443/richard" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-stack-overflow"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://twitter.com/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-twitter"></i>
                </span>
                 
              
            </a>
          </span>
        
      
  </div>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                How JVM handle method invocation
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-08-22T18:39:25+12:00" content="2016-08-22">
              2016-08-22
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/22/how-jvm-handle-method-invocation/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/08/22/how-jvm-handle-method-invocation/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Five forms of method invocation in Java:</p>
<ul>
<li><code>invokevirtual</code></li>
<li><code>invokeinterface</code></li>
<li><code>invokestatic</code></li>
<li><code>invokespecial</code></li>
<li><code>invokedynamic</code></li>
</ul>
<h1 id="invokestatic-and-invokevirtual"><a href="#invokestatic-and-invokevirtual" class="headerlink" title="invokestatic and invokevirtual"></a>invokestatic and invokevirtual</h1><p>Of these, <code>invokestatic</code> and <code>invokevirtual</code> are easy to understand.<br><code>invokevirtual</code> is the default behaviour when we invoke an instance method.<br><code>invokestatic</code> is used to invoke the class method based on the type of the reference, not the class of the object when we invoke the static method through the instance rather than the class name.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Superclass</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">interestingMethod</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Superclass's interesting method."</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Subclass</span> <span class="keyword">extends</span> <span class="title">Superclass</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">interestingMethod</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Subclass's interesting method."</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span>&#123;</div><div class="line">        Subclass sub = <span class="keyword">new</span> Subclass();</div><div class="line">        sub.interestingMethod();</div><div class="line"></div><div class="line">        Superclass sub1 = <span class="keyword">new</span> Subclass();</div><div class="line">        sub1.interestingMethod();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>It will print:<br>Subclass’s interesting method.<br>Superclass’s interesting method.<br><a id="more"></a></p>
<h1 id="invokespecial"><a href="#invokespecial" class="headerlink" title="invokespecial"></a>invokespecial</h1><p>Now let’s see where <code>invokespecial</code> is used.</p>
<ul>
<li>invocation of instance initialization (<code>&lt;init&gt;</code>) methods</li>
<li>invocation of methods using the <code>super</code> keyword</li>
<li>invocation of <code>private</code> methods</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Superclass</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">interestingMethod</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Superclass's interesting method."</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">exampleMethod</span><span class="params">()</span> </span>&#123;</div><div class="line">        interestingMethod(); <span class="comment">// invokespecial</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Subclass</span> <span class="keyword">extends</span> <span class="title">Superclass</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">interestingMethod</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Subclass's interesting method."</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span>&#123;</div><div class="line">        Subclass me = <span class="keyword">new</span> Subclass();</div><div class="line">        me.exampleMethod();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This code snippet will print: Superclass’s interesting method.</p>
<p>Now we just change <code>Superclass#interestingMethod()</code> to <code>package</code> or <code>protected</code> modifier. Then, it will print: Subclass’s interesting method.</p>
<h1 id="invokeinterface-vs-invokevirtual"><a href="#invokeinterface-vs-invokevirtual" class="headerlink" title="invokeinterface vs. invokevirtual"></a>invokeinterface vs. invokevirtual</h1><p><code>invokeinterface</code> opcode performs the same function as <code>invokevirtual</code>. The only difference is that <code>invokeinterface</code> is used when the reference is of an interface type.</p>
<h2 id="difference-explanation"><a href="#difference-explanation" class="headerlink" title="difference explanation"></a>difference explanation</h2><p>But why we need a different opcode: <code>invokevirtual</code> vs. <code>invokeinterface</code>?<br>The essential idea is that <code>invokevirtual</code> makes it possible for JVM to cache methods resolution results.</p>
<p>This is an explanation from Stackoverflow.</p>
<hr>
<blockquote>
<p>Each Java class is associated with a virtual method table that contains “links” to the bytecode of each method of a class. That table is inherited from the superclass of a particular class and extended with regard to the new methods of a subclass. E.g.,</p>
<p>class BaseClass {<br>    public void method1() { }<br>    public void method2() { }<br>    public void method3() { }<br>}</p>
<p>class NextClass extends BaseClass {<br>    public void method2() { } // overridden from BaseClass<br>    public void method4() { }<br>}<br>results in the tables</p>
<p>BaseClass</p>
<ol>
<li>BaseClass/method1()</li>
<li>BaseClass/method2()</li>
<li>BaseClass/method3()</li>
</ol>
<p>NextClass</p>
<ol>
<li>BaseClass/method1()</li>
<li>NextClass/method2()</li>
<li>BaseClass/method3()</li>
<li>NextClass/method4()<br>Note, how the virtual method table of NextClass retains the order of entries of the table of BaseClass and just overwrites the “link” of method2() which it overrides.</li>
</ol>
<p>An implementation of the JVM can thus optimize a call to invokevirtual by remembering that BaseClass/method3() will always be the third entry in the virtual method table of any object this method will ever be invoked on.</p>
<p>With invokeinterface this optimization is not possible. E.g.,</p>
<p>interface MyInterface {<br>    void ifaceMethod();<br>}</p>
<p>class AnotherClass extends NextClass implements MyInterface {<br>    public void method4() { } // overridden from NextClass<br>    public void ifaceMethod() { }<br>}</p>
<p>class MyClass implements MyInterface {<br>    public void method5() { }<br>    public void ifaceMethod() { }<br>}<br>This class hierarchy results in the virtual method tables</p>
<p>AnotherClass</p>
<ol>
<li>BaseClass/method1()</li>
<li>NextClass/method2()</li>
<li>BaseClass/method3()</li>
<li>AnotherClass/method4()</li>
<li>MyInterface/ifaceMethod()</li>
</ol>
<p>MyClass</p>
<ol>
<li>MyClass/method5()</li>
<li>MyInterface/ifaceMethod()<br>As you can see, AnotherClass contains the interface’s method in its fifth entry and MyClass contains it in its second entry. To actually find the correct entry in the virtual method table, a call to a method with invokeinterface will always have to search the complete table without a chance for the style of optimization that invokevirtual does.</li>
</ol>
<p>There are additional differences like the fact, that invokeinterface can be used together with object references that do not actually implement the interface. Therefore, invokeinterface will have to check at runtime whether a method exists in the table and potentially throw an exception. If you want to dive deeper into the topic, I suggest, e.g., “Efficient Implementation of Java Interfaces: Invokeinterface Considered Harmless”.</p>
</blockquote>
<h2 id="vitual-interface-dispatching-performance-benchmark"><a href="#vitual-interface-dispatching-performance-benchmark" class="headerlink" title="vitual / interface dispatching performance benchmark"></a>vitual / interface dispatching performance benchmark</h2><p>A benchmark code to compare invokevirtual with invokeinterface performance. invokeinterface is 38% slower. If volatile modifier is removed from <code>aand i</code> (and it becomes possible for JVM to cache methods resolution results), the performance becomes comparable for both cases and the code runs ~10x faster than with volatile variables.<br>A background in essence is “interfaces do not exist in runtime” so virtual dispatching can’t be applied to interface methods. The idea is very well explained above.<br>Below is a benchmark to compare <code>invokevirtual</code> with <code>invokeinterface</code> performance. Prevents JVM from optimizing out <code>invokeinterface</code> by declaring target object volatile.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InvokevirtualVsInvokeinterface</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">interface</span> <span class="title">I</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getInteger</span> <span class="params">()</span></span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">implements</span> <span class="title">I</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getInteger</span> <span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="number">0</span>; &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123; &#125;</div><div class="line"></div><div class="line">  <span class="keyword">static</span> <span class="keyword">volatile</span> I i = <span class="keyword">new</span> B();</div><div class="line">  <span class="keyword">static</span> <span class="keyword">volatile</span> A a = <span class="keyword">new</span> B();</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    &#123;</div><div class="line">      <span class="keyword">long</span> tm1 = System.nanoTime();</div><div class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">100000000</span>; ++k) &#123;</div><div class="line">        a.getInteger();</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">long</span> tm2 = System.nanoTime();</div><div class="line">      System.out.println(<span class="string">"invokevirtual took "</span> + (Math.abs(tm2 - tm1) / <span class="number">1000</span>) + <span class="string">" us"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    &#123;</div><div class="line">      <span class="keyword">long</span> tm1 = System.nanoTime();</div><div class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">100000000</span>; ++k) &#123;</div><div class="line">        i.getInteger();</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">long</span> tm2 = System.nanoTime();</div><div class="line">      System.out.println(<span class="string">"invokeinterface took "</span> + (Math.abs(tm2 - tm1) / <span class="number">1000</span>) + <span class="string">" us"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// Output on Intel Xeon X5570 @ 2.93GHz:</span></div><div class="line">    <span class="comment">// invokevirtual took 41170 us</span></div><div class="line">    <span class="comment">// invokeinterface took 66305 us</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>and the corresponding bytecode (the output of “javap -c”)</p>
<figure class="highlight plain"><figcaption><span>Compiled from "InvokevirtualVsInvokeinterface.java"</span></figcaption><table><tr><td class="code"><pre><div class="line">public class InvokevirtualVsInvokeinterface extends java.lang.Object&#123;</div><div class="line">static volatile InvokevirtualVsInvokeinterface$I i;</div><div class="line"></div><div class="line">static volatile InvokevirtualVsInvokeinterface$A a;</div><div class="line"></div><div class="line">public InvokevirtualVsInvokeinterface();</div><div class="line">  Code:</div><div class="line">   0:	aload_0</div><div class="line">   1:	invokespecial	#1; //Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</div><div class="line">   4:	return</div><div class="line"></div><div class="line">public static void main(java.lang.String[]);</div><div class="line">  Code:</div><div class="line">   0:	invokestatic	#2; //Method java/lang/System.nanoTime:()J</div><div class="line">   3:	lstore_1</div><div class="line">   4:	iconst_0</div><div class="line">   5:	istore_3</div><div class="line">   6:	iload_3</div><div class="line">   7:	ldc	#3; //int 100000000</div><div class="line">   9:	if_icmpge	25</div><div class="line">   12:	getstatic	#4; //Field a:LInvokevirtualVsInvokeinterface$A;</div><div class="line">   15:	invokevirtual	#5; //Method InvokevirtualVsInvokeinterface$A.getInteger:()I</div><div class="line">   18:	pop</div><div class="line">   19:	iinc	3, 1</div><div class="line">   22:	goto	6</div><div class="line">   25:	invokestatic	#2; //Method java/lang/System.nanoTime:()J</div><div class="line">   28:	lstore_3</div><div class="line">   29:	getstatic	#6; //Field java/lang/System.out:Ljava/io/PrintStream;</div><div class="line">   32:	new	#7; //class java/lang/StringBuilder</div><div class="line">   35:	dup</div><div class="line">   36:	invokespecial	#8; //Method java/lang/StringBuilder.&quot;&lt;init&gt;&quot;:()V</div><div class="line">   39:	ldc	#9; //String invokevirtual took </div><div class="line">   41:	invokevirtual	#10; //Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</div><div class="line">   44:	lload_3</div><div class="line">   45:	lload_1</div><div class="line">   46:	lsub</div><div class="line">   47:	invokestatic	#11; //Method java/lang/Math.abs:(J)J</div><div class="line">   50:	ldc2_w	#12; //long 1000l</div><div class="line">   53:	ldiv</div><div class="line">   54:	invokevirtual	#14; //Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;</div><div class="line">   57:	ldc	#15; //String  us</div><div class="line">   59:	invokevirtual	#10; //Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</div><div class="line">   62:	invokevirtual	#16; //Method java/lang/StringBuilder.toString:()Ljava/lang/String;</div><div class="line">   65:	invokevirtual	#17; //Method java/io/PrintStream.println:(Ljava/lang/String;)V</div><div class="line">   68:	invokestatic	#2; //Method java/lang/System.nanoTime:()J</div><div class="line">   71:	lstore_1</div><div class="line">   72:	iconst_0</div><div class="line">   73:	istore_3</div><div class="line">   74:	iload_3</div><div class="line">   75:	ldc	#3; //int 100000000</div><div class="line">   77:	if_icmpge	95</div><div class="line">   80:	getstatic	#18; //Field i:LInvokevirtualVsInvokeinterface$I;</div><div class="line">   83:	invokeinterface	#19,  1; //InterfaceMethod InvokevirtualVsInvokeinterface$I.getInteger:()I</div><div class="line">   88:	pop</div><div class="line">   89:	iinc	3, 1</div><div class="line">   92:	goto	74</div><div class="line">   95:	invokestatic	#2; //Method java/lang/System.nanoTime:()J</div><div class="line">   98:	lstore_3</div><div class="line">   99:	getstatic	#6; //Field java/lang/System.out:Ljava/io/PrintStream;</div><div class="line">   102:	new	#7; //class java/lang/StringBuilder</div><div class="line">   105:	dup</div><div class="line">   106:	invokespecial	#8; //Method java/lang/StringBuilder.&quot;&lt;init&gt;&quot;:()V</div><div class="line">   109:	ldc	#20; //String invokeinterface took </div><div class="line">   111:	invokevirtual	#10; //Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</div><div class="line">   114:	lload_3</div><div class="line">   115:	lload_1</div><div class="line">   116:	lsub</div><div class="line">   117:	invokestatic	#11; //Method java/lang/Math.abs:(J)J</div><div class="line">   120:	ldc2_w	#12; //long 1000l</div><div class="line">   123:	ldiv</div><div class="line">   124:	invokevirtual	#14; //Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;</div><div class="line">   127:	ldc	#15; //String  us</div><div class="line">   129:	invokevirtual	#10; //Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</div><div class="line">   132:	invokevirtual	#16; //Method java/lang/StringBuilder.toString:()Ljava/lang/String;</div><div class="line">   135:	invokevirtual	#17; //Method java/io/PrintStream.println:(Ljava/lang/String;)V</div><div class="line">   138:	return</div><div class="line"></div><div class="line">static &#123;&#125;;</div><div class="line">  Code:</div><div class="line">   0:	new	#21; //class InvokevirtualVsInvokeinterface$B</div><div class="line">   3:	dup</div><div class="line">   4:	aconst_null</div><div class="line">   5:	invokespecial	#22; //Method InvokevirtualVsInvokeinterface$B.&quot;&lt;init&gt;&quot;:(LInvokevirtualVsInvokeinterface$1;)V</div><div class="line">   8:	putstatic	#18; //Field i:LInvokevirtualVsInvokeinterface$I;</div><div class="line">   11:	new	#21; //class InvokevirtualVsInvokeinterface$B</div><div class="line">   14:	dup</div><div class="line">   15:	aconst_null</div><div class="line">   16:	invokespecial	#22; //Method InvokevirtualVsInvokeinterface$B.&quot;&lt;init&gt;&quot;:(LInvokevirtualVsInvokeinterface$1;)V</div><div class="line">   19:	putstatic	#4; //Field a:LInvokevirtualVsInvokeinterface$A;</div><div class="line">   22:	return</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="vtable-and-itable-in-OpenJDK-source-code"><a href="#vtable-and-itable-in-OpenJDK-source-code" class="headerlink" title="vtable and itable in OpenJDK source code"></a>vtable and itable in OpenJDK source code</h1><p>//In Progress</p>
<h2 id="references"><a href="#references" class="headerlink" title="references"></a>references</h2><p><a href="media/oopsla01.pdf">Efficient Implementation of Java Interfaces: Invokeinterface Considered Harmless</a></p>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/08/15/dynamic-proxy-revisit/" rel="next" title="Dynamic Proxy revisit">
                <i class="fa fa-chevron-left"></i> Dynamic Proxy revisit
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/08/23/java-array-has-length-field/" rel="prev" title="Java array has length field?">
                Java array has length field? <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://qph.is.quoracdn.net/main-thumb-27403014-200-azcnfpakpayhgojvmueqcfjeyufbjpcx.jpeg"
               alt="Richard Yang" />
          <p class="site-author-name" itemprop="name">Richard Yang</p>
          <p class="site-description motion-element" itemprop="description">Nothing seek, nothing find</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">133</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">48</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="http://linkedin.com/in/richdyang" target="_blank" title="Linkedin">
                  
                    <i class="fa fa-fw fa-linkedin"></i>
                  
                  Linkedin
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://github.com/richdyang" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-github-alt"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://bitbucket.org/richdyang" target="_blank" title="Bitbucket">
                  
                    <i class="fa fa-fw fa-bitbucket"></i>
                  
                  Bitbucket
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://stackoverflow.com/users/4344443/richard" target="_blank" title="Stackoverflow">
                  
                    <i class="fa fa-fw fa-stack-overflow"></i>
                  
                  Stackoverflow
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://twitter.com/richdyang" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Introduction"><span class="nav-number">1.</span> <span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#invokestatic-and-invokevirtual"><span class="nav-number">2.</span> <span class="nav-text">invokestatic and invokevirtual</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#invokespecial"><span class="nav-number">3.</span> <span class="nav-text">invokespecial</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#invokeinterface-vs-invokevirtual"><span class="nav-number">4.</span> <span class="nav-text">invokeinterface vs. invokevirtual</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#difference-explanation"><span class="nav-number">4.1.</span> <span class="nav-text">difference explanation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#vitual-interface-dispatching-performance-benchmark"><span class="nav-number">4.2.</span> <span class="nav-text">vitual / interface dispatching performance benchmark</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#vtable-and-itable-in-OpenJDK-source-code"><span class="nav-number">5.</span> <span class="nav-text">vtable and itable in OpenJDK source code</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#references"><span class="nav-number">5.1.</span> <span class="nav-text">references</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2013 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Richard Yang</span>
</div>

<!--div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div-->

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'richyang';
      var disqus_identifier = '2016/08/22/how-jvm-handle-method-invocation/';
      var disqus_title = 'How JVM handle method invocation';

      function run_disqus_script(disqus_script) {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');

      
        run_disqus_script('embed.js');
      

    </script>
  




  
  

  

  

  
  

  
  
  
  <link rel="stylesheet" href="/vendors/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/vendors/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.0"></script>



</body>
</html>
