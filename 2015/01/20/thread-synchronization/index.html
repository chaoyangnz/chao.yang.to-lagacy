<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Richard Yang, Java Developer, Senior software engineer" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="Two questions about synchronized
mutual exclusion - shared data access among multiple threads -
coordinating activitiesSome of the Java virtual machine’s runtime data areas are shared by all threads,">
<meta property="og:type" content="article">
<meta property="og:title" content="Thread Synchronization">
<meta property="og:url" content="https://richyang.me/2015/01/20/thread-synchronization/index.html">
<meta property="og:site_name" content="Richard Yang">
<meta property="og:description" content="Two questions about synchronized
mutual exclusion - shared data access among multiple threads -
coordinating activitiesSome of the Java virtual machine’s runtime data areas are shared by all threads,">
<meta property="og:image" content="https://richyang.me/media/fig20-1.gif">
<meta property="og:image" content="https://richyang.me/media/11.gif">
<meta property="og:image" content="https://richyang.me/media/12.gif">
<meta property="og:image" content="https://richyang.me/media/13.gif">
<meta property="og:image" content="https://richyang.me/media/14.gif">
<meta property="og:image" content="https://richyang.me/media/16.gif">
<meta property="og:image" content="https://richyang.me/media/17.gif">
<meta property="og:updated_time" content="2015-12-05T04:46:35.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Thread Synchronization">
<meta name="twitter:description" content="Two questions about synchronized
mutual exclusion - shared data access among multiple threads -
coordinating activitiesSome of the Java virtual machine’s runtime data areas are shared by all threads,">
<meta name="twitter:image" content="https://richyang.me/media/fig20-1.gif">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    },
    algolia: {
      applicationID: 'X0H1P7HDKY',
      apiKey: 'ddc0af00a6e07c9b1be9f4da4cf5b9d9',
      indexName: 'richyang.me',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>




  <title> Thread Synchronization | Richard Yang </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <!--span class="logo-line-before"><i></i></span-->
      <span class="site-title">Richard Yang</span>
      <!--span class="logo-line-after"><i></i></span-->
    </a>
  </div>
  <p class="site-subtitle">Full-stack software engineer mainly focusing on Java-based technologies and web front-end</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            Home
          </a>
        </li>
        
      
        
        
        <li class="menu-item menu-item-books">
          <a href="https://www.gitbook.com/@richdyang" rel="section">
            
            Books
          </a>
        </li>
        
      
        
        
        <li class="menu-item menu-item-showcase">
          <a href="/showcase" rel="section">
            
            Showcase
          </a>
        </li>
        
      
        
        
        <li class="menu-item menu-item-resume">
          <a href="http://linkedin.com/in/richdyang" rel="section">
            
            Résumé
          </a>
        </li>
        
      
        
        
      
        
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
            About
          </a>
        </li>
        
      
        
        
      
        
        
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
            <i class="menu-item-icon fa fa-search fa-lg"></i>Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>

<div class="social-links" style="float: right; padding-left: 50px; margin-right: 10px">
      
        
          <span class="links-of-author-item">
            <a href="http://linkedin.com/in/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-linkedin"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://github.com/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-github-alt"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://bitbucket.org/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-bitbucket"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://stackoverflow.com/users/4344443/richard" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-stack-overflow"></i>
                </span>
                 
              
            </a>
          </span>
        
          <span class="links-of-author-item">
            <a href="http://twitter.com/richdyang" target="_blank" style="border-bottom: none">
              
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse fa-twitter"></i>
                </span>
                 
              
            </a>
          </span>
        
      
  </div>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Thread Synchronization
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-01-20T07:16:57+13:00" content="2015-01-20">
              2015-01-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Concurrency/" itemprop="url" rel="index">
                    <span itemprop="name">Concurrency</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Concurrency/Multithreading/" itemprop="url" rel="index">
                    <span itemprop="name">Multithreading</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/01/20/thread-synchronization/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/01/20/thread-synchronization/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h4 id="Two-questions-about-synchronized"><a href="#Two-questions-about-synchronized" class="headerlink" title="Two questions about synchronized"></a>Two questions about synchronized</h4><ol>
<li>mutual exclusion - shared data access among multiple threads -</li>
<li>coordinating activities<br>Some of the Java virtual machine’s runtime data areas are shared by all threads, others are private to individual threads.</li>
</ol>
<ul>
<li><p>The heap and method area are shared by all threads, Java programs need to coordinate multi-threaded access to two kinds of data:</p>
</li>
<li><p>b. class variables, which are stored in the method area</p>
</li>
<li><p>a. instance variables, which are stored on the heap</p>
</li>
<li><p>Programs never need to coordinate access to local variables, which reside on Java stacks, because data on the Java stack is private to the thread to which the Java stack belongs.</p>
</li>
</ul>
<h4 id="Monitors"><a href="#Monitors" class="headerlink" title="Monitors"></a>Monitors</h4><p>The mechanism that Java uses to support synchronization is the monitor, which supports two kinds of thread synchronization: mutual exclusion and cooperation.</p>
<p>Mutual exclusion, which is supported in the Java virtual machine via object locks, enables multiple threads to independently work on shared data without interfering with each other.<br>Cooperation, which is supported in the Java virtual machine via the wait and notify methods of class Object, enables threads to work together towards a common goal.</p>
<p>A monitor is like a building that contains one special room that can be occupied by only one thread at a time. The room usually contains some data. From the time a thread enters this room to the time it leaves, it has exclusive access to any data in the room. Entering the monitor building is called “entering the monitor.” Entering the special room inside the building is called “acquiring the monitor.” Occupying the room is called “owning the monitor,” and leaving the room is called “releasing the monitor.” Leaving the entire building is called “exiting the monitor.”</p>
<p>In addition to being associated with a bit of data, a monitor is associated with one or more bits of code, which in this book will be called <strong><em>monitor regions</em></strong>.</p>
<p><img src="/media/fig20-1.gif" alt="fig20-1"><br><a href="http://www.artima.com/insidejvm/ed2/threadsynch.html" target="_blank" rel="external">http://www.artima.com/insidejvm/ed2/threadsynch.html</a></p>
<p>In this figure, number 2 and number 4 acquiring monitor is unpredictable, which is scheduled by JVM and implementation-dependent. Number 3 releasing monitor can be done by invoking wait() method.</p>
<p>Because sleep() have no change with the monitor, so this can explain why sleep is the class method of Thread instead of Object.</p>
<p>How to understand?</p>
<p>An object has a monitor to protect its data (instance variables or class variables).</p>
<p>When applying <code>sychronized</code>, it basically declare two things.</p>
<ul>
<li>specify the lock associated with the synchronized object using as privilege</li>
<li>mark the code (aka. monitor region) to be monitored by that monitor associated with the synchronized object</li>
</ul>
<h4 id="Object-locking-by-intrinsic-lock-or-monitor-lock"><a href="#Object-locking-by-intrinsic-lock-or-monitor-lock" class="headerlink" title="Object locking by _intrinsic lock or monitor lock_"></a>Object locking by _intrinsic lock <em>or</em> monitor lock_</h4><p>(The API specification often refers to this lock entity simply as a “monitor.”)</p>
<p>In the Java virtual machine, <em><span style="background-color: #cccccc;">every object and class is logically associated with a monitor</span></em>. For objects, the associated monitor protects the object’s instance variables. For classes, the monitor protects the class’s class variables. If an object has no instance variables, or a class has no class variables, the associated monitor protects no data.</p>
<p>To implement the mutual exclusion capability of monitors, the Java virtual machine associates a lock (sometimes called a mutex) with each object and class. A lock is like a privilege that only one thread can “own” at any one time. Threads need not obtain a lock to access instance or class variables. If a thread does obtain a lock, however, no other thread can obtain a lock on the same data until the thread that owns the lock releases it. (To “lock an object” is to acquire the monitor associated with that object.)</p>
<p>Note that as a Java programmer, you never explicitly lock an object. Object locks are internal to the Java virtual machine. In your Java programs, you identify the monitor regions of your program by writing synchronized statements and methods. As the Java virtual machine runs your program, it automatically locks an object or class every time it encounters a monitor region.</p>
<h5 id="Reentrant"><a href="#Reentrant" class="headerlink" title="Reentrant"></a>Reentrant</h5><p>A single thread is allowed to lock the same object multiple times. For each object, the Java virtual machine maintains a count of the number of times the object has been locked. An unlocked object has a count of zero. When a thread acquires the lock for the first time, the count is again incremented to one. Each time the thread acquires a lock on the same object, the count is again incremented. (Only the thread that already owns an object’s lock is allowed to lock it again. As mentioned previously, no other thread can lock the object until the owning thread releases the lock.) Each time the thread releases the lock, the count is decremented. When the count reaches zero, the lock is released and made available to other threads.</p>
<h5 id="volatile"><a href="#volatile" class="headerlink" title="volatile "></a><em>volatile </em></h5><p>//TODO</p>
<h4 id="“Wait-and-Notify”-monitor-aka-“Signal-and-Continue”-monitor"><a href="#“Wait-and-Notify”-monitor-aka-“Signal-and-Continue”-monitor" class="headerlink" title="“Wait and Notify” monitor (aka. “Signal and Continue” monitor)"></a>“Wait and Notify” monitor (aka. “Signal and Continue” monitor)</h4><p>In this kind of monitor, a thread that currently owns the monitor can suspend itself inside the monitor by executing a <em>wait command</em>. When a thread executes a wait, it releases the monitor and enters a <em>wait set</em>. The thread will stay suspended in the wait set until some time after another thread executes a <em>notify command</em> inside the monitor. When a thread executes a notify, it continues to own the monitor until it releases the monitor of its own accord, either by executing a wait or by completing the monitor region. After the notifying thread has released the monitor, the waiting thread will be resurrected and will reacquire the monitor.</p>
<p>a. When a thread has acquired the monitor and invoke wait() on this object, this thread release its acquired monitors, and enter the waiting set.<br>b. When another thread has acquired the monitor and invoke notify() or notifyAll() on the same object, then the waiting state of one thread or all threads in the waiting area ends and the thread starts attempting to regain all the monitors. At one time there may be several threads trying to regain (or maybe gain for the first time) their monitors. If more than one threads attempt to acquire the monitor of a particular object then only one thread (selected by the JVM scheduler) is granted the monitor and all other threads are put into BLOCKED state.</p>
<p>The following pictures demonstrate the lock and wait/notify mechanism:</p>
<blockquote>
<p>Legend: Blue - BLOCKED     Green - RUNNABLE (running)       White - WAITING</p>
<p>Threads in waiting state can be interrupted, but cannot in blocked state.<br>[caption id=”attachment_209” align=”alignleft” width=”235”]<img src="/media/11.gif" alt="11"> Thread 1 acquires the lock and starts running; other threads cannot acquire the lock, so they are BLOCKED[/caption]</p>
</blockquote>
<p>[caption id=”attachment_202” align=”alignleft” width=”235”]<img src="/media/12.gif" alt="12"> Thread 1 invokes wait(), releases the lock and gets await; thread 4 acquires the lock and starts running[/caption]</p>
<p>[caption id=”attachment_203” align=”alignleft” width=”235”]<img src="/media/13.gif" alt="13"> Thread 4 also invokes wait() ; thread 3 acquire the released lock and starts running[/caption]</p>
<p>[caption id=”attachment_204” align=”alignleft” width=”235”]<img src="/media/14.gif" alt="14"> Thread 4 exits; thread 2 acquires the lock and starts running[/caption]</p>
<p>[caption id=”attachment_206” align=”alignleft” width=”235”]<img src="/media/16.gif" alt="16"> Thread 2 exits; thread 4 reacquires the lock and gets running[/caption]</p>
<p>[caption id=”attachment_207” align=”alignleft” width=”235”]<img src="/media/17.gif" alt="17"> Thread 4 exits; thread 1 reacquires the lock and goes running once again.[/caption]</p>
<h5 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h5><p>1. A typical scenario is that there is a customer account which can be deposited and fetched at the same time.<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ATM</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">final</span> <span class="keyword">static</span> CyclicBarrier cyclicBarrier = <span class="keyword">new</span> CyclicBarrier(<span class="number">4</span>);</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</div><div class="line">        <span class="keyword">final</span> Account account = <span class="keyword">new</span> Account();</div><div class="line"></div><div class="line">        ThreadGroup group = <span class="keyword">new</span> ThreadGroup(<span class="string">"group"</span>);</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">11</span>; i &amp;lt; <span class="number">13</span>; ++i) &#123;</div><div class="line">            <span class="keyword">new</span> Thread(<span class="string">"D #"</span> + i) &#123;</div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                    <span class="keyword">try</span> &#123;</div><div class="line">                        cyclicBarrier.await();</div><div class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">                        e.printStackTrace();</div><div class="line">                    &#125; <span class="keyword">catch</span> (BrokenBarrierException e) &#123;</div><div class="line">                        e.printStackTrace();</div><div class="line">                    &#125;</div><div class="line">                    account.deposit(amount());</div><div class="line">                &#125;</div><div class="line">            &#125;.start();</div><div class="line"></div><div class="line">            <span class="keyword">new</span> Thread(<span class="string">"W #"</span> + i) &#123;</div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                    <span class="keyword">try</span> &#123;</div><div class="line">                        cyclicBarrier.await();</div><div class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">                        e.printStackTrace();</div><div class="line">                    &#125; <span class="keyword">catch</span> (BrokenBarrierException e) &#123;</div><div class="line">                        e.printStackTrace();</div><div class="line">                    &#125;</div><div class="line">                    account.withdraw(amount());</div><div class="line">                &#125;</div><div class="line">            &#125;.start();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">amount</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)(Math.random() * <span class="number">100</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Account</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String id;</div><div class="line">    <span class="keyword">private</span> String customerName;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> balance = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">deposit</span><span class="params">(<span class="keyword">int</span> amount)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> oldBalance = balance;</div><div class="line">        balance += amount;</div><div class="line">        print(<span class="string">"Balance: ￥%d + ￥%d =&amp;gt; ￥%d"</span>, oldBalance, amount, balance);</div><div class="line">        notifyAll();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">withdraw</span><span class="params">(<span class="keyword">int</span> amount)</span> </span>&#123;</div><div class="line">        <span class="keyword">while</span>(balance &amp;lt; amount) &#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                print(<span class="string">"Balance: ￥%d - ￥%d =&amp;gt; FAIL"</span>, balance, amount);</div><div class="line">                wait();</div><div class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> oldBalance = balance;</div><div class="line">        balance -= amount;</div><div class="line">        print(<span class="string">"Balance: ￥%d - ￥%d =&amp;gt; ￥%d"</span>, oldBalance, amount, balance);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(String message, Object...args)</span> </span>&#123;</div><div class="line">        PrintStream ps = System.out;</div><div class="line">        ps.format(<span class="string">"%s: "</span>, Thread.currentThread().getName());</div><div class="line">        ps.format(message, args);</div><div class="line">        ps.println();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>One output is:<br>W #11: Balance: ￥0 - ￥5 =&gt; FAIL<br>W #12: Balance: ￥0 - ￥23 =&gt; FAIL<br>D #12: Balance: ￥0 + ￥30 =&gt; ￥30<br>D #11: Balance: ￥30 + ￥90 =&gt; ￥120<br>W #12: Balance: ￥120 - ￥23 =&gt; ￥97<br>W #11: Balance: ￥97 - ￥5 =&gt; ￥92</p>
<p>Another output which will be await always:<br>W #11: Balance: ￥0 - ￥54 =&gt; FAIL<br>W #12: Balance: ￥0 - ￥93 =&gt; FAIL<br>D #12: Balance: ￥0 + ￥89 =&gt; ￥89<br>D #11: Balance: ￥89 + ￥28 =&gt; ￥117<br>W #12: Balance: ￥117 - ￥93 =&gt; ￥24<br>W #11: Balance: ￥24 - ￥54 =&gt; FAIL<br>..(waiting here)..</p>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/01/19/topic-serial-threads/" rel="next" title="Java Thread Management">
                <i class="fa fa-chevron-left"></i> Java Thread Management
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/01/21/java-memory-model-atomicity-visibility-and-reordering/" rel="prev" title="JMM, Atomicity,  Visibility and Reordering">
                JMM, Atomicity,  Visibility and Reordering <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://qph.is.quoracdn.net/main-thumb-27403014-200-azcnfpakpayhgojvmueqcfjeyufbjpcx.jpeg"
               alt="Richard Yang" />
          <p class="site-author-name" itemprop="name">Richard Yang</p>
          <p class="site-description motion-element" itemprop="description">Nothing seek, nothing find</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">133</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">48</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="http://linkedin.com/in/richdyang" target="_blank" title="Linkedin">
                  
                    <i class="fa fa-fw fa-linkedin"></i>
                  
                  Linkedin
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://github.com/richdyang" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-github-alt"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://bitbucket.org/richdyang" target="_blank" title="Bitbucket">
                  
                    <i class="fa fa-fw fa-bitbucket"></i>
                  
                  Bitbucket
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://stackoverflow.com/users/4344443/richard" target="_blank" title="Stackoverflow">
                  
                    <i class="fa fa-fw fa-stack-overflow"></i>
                  
                  Stackoverflow
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://twitter.com/richdyang" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#Two-questions-about-synchronized"><span class="nav-number">1.</span> <span class="nav-text">Two questions about synchronized</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Monitors"><span class="nav-number">2.</span> <span class="nav-text">Monitors</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Object-locking-by-intrinsic-lock-or-monitor-lock"><span class="nav-number">3.</span> <span class="nav-text">Object locking by _intrinsic lock or monitor lock_</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Reentrant"><span class="nav-number">3.1.</span> <span class="nav-text">Reentrant</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#volatile"><span class="nav-number">3.2.</span> <span class="nav-text">volatile </span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#“Wait-and-Notify”-monitor-aka-“Signal-and-Continue”-monitor"><span class="nav-number">4.</span> <span class="nav-text">“Wait and Notify” monitor (aka. “Signal and Continue” monitor)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Examples"><span class="nav-number">4.1.</span> <span class="nav-text">Examples</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2013 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Richard Yang</span>
</div>

<!--div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div-->

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'richyang';
      var disqus_identifier = '2015/01/20/thread-synchronization/';
      var disqus_title = 'Thread Synchronization';

      function run_disqus_script(disqus_script) {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');

      
        run_disqus_script('embed.js');
      

    </script>
  




  
  

  

  

  
  

  
  
  
  <link rel="stylesheet" href="/vendors/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/vendors/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.0"></script>



</body>
</html>
