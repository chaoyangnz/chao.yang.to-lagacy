<!DOCTYPE HTML>
<html lang="en-us">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /> 
    <title>Java Collections Framework - Chao Yang</title>
    <meta name="keywords" content="Java, Programming, Android, JavaScript, Angular, Kotlin, Swift, iOS, Machine Learning, Big Data">
    
    <meta property="og:title" content="Java Collections Framework">
    <meta property="og:site_name" content="Chao Yang">
    <meta property="og:image" content="/img/author.jpg"> 
    <meta name="title" content="Java Collections Framework - Chao Yang" />
    <meta name="description" content="A Developer in New Zealand"> 
    
    <link rel="shortcut icon" href="http://yangchao.me/img/favicon.ico" />
    <link rel="apple-touch-icon" href="http://yangchao.me/img/apple-touch-icon.png" />
    <link rel="apple-touch-icon-precomposed" href="http://yangchao.me/img/apple-touch-icon.png" />
    <link href="http://yangchao.me/js/vendor/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />
    <link href="http://yangchao.me/js/vendor/fancybox/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />
    <link href="http://yangchao.me/css/main.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
     fancybox: true, 
    motion: true
  };
</script>
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/languages/kotlin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/languages/swift.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/languages/typescript.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

</head>
<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">
<div class="container one-collumn sidebar-position-left page-home  ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-meta  custom-logo ">

  <div class="custom-logo-site-title">
    <a href="http://yangchao.me/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Chao Yang</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Nothing seek, nothing find</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
    <ul id="menu" class="menu">
      
      
        <li class="menu-item ">
          <a href="http://yangchao.me/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://yangchao.me/books" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />Minibooks
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="https://github.com/richdyang" rel="section">
              <i class="menu-item-icon fa fa-fw fa-code"></i> <br />Showcase
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://yangchao.me/resume/richard.yang-cv20170810.pdf" rel="section">
              <i class="menu-item-icon fa fa-fw fa-linkedin"></i> <br />Résumé
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://yangchao.me/post/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archive
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://yangchao.me/about/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />About
          </a>
        </li>
      
    </ul>
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
<section id="posts" class="posts-expand">
  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
      <h1 class="post-title" itemprop="name headline">
        <a class="post-title-link" href="http://yangchao.me/post/java-collections-framework/" itemprop="url">
        Java Collections Framework
        </a>
      </h1>
      <div class="post-meta">
      <span class="post-time">
<span class="post-meta-item-icon">
    <i class="fa fa-calendar-o"></i>
</span>
<span class="post-meta-item-text">Published at:</span>
<time itemprop="dateCreated" datetime="2016-03-22T13:04:35+08:00" content="2015-06-26">
    2015-06-26
</time>
</span> 
      

  <span class="post-category" >
  &nbsp; | &nbsp;
  <span class="post-meta-item-icon">
    <i class="fa fa-folder-o"></i>
  </span>
  <span class="post-meta-item-text">Categories:</span>
  
    <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
      <a href="http://yangchao.me/categories/basics" itemprop="url" rel="index">
        <span itemprop="name">Basics</span>
      </a>
      &nbsp; 
    </span>
  
</span>


       <span>
&nbsp; | &nbsp;
<span class="post-meta-item-icon">
    <i class="fa fa-eye"></i>
</span>
<span class="post-meta-item-text">Reading:</span>
<span class="leancloud-visitors-count">397 words ~2min</span>
</span>
      </div>
    </header>
    <div class="post-body" itemprop="articleBody">
    

<h3 id="natural-ordered-structure">(natural) ordered structure</h3>

<p>Red-Black Tree implementation to maintain the natural order (Comparable)</p>

<ul>
<li>TreeSet -&gt; NavigableSet -&gt; OrderedSet</li>
<li>TreeMap -&gt; NavigableMap -&gt; OrderedMap</li>
</ul>

<h3 id="hash-structure">hash structure</h3>

<p>a bucket array, each bucket is a LinkedList; the index is computed by hashCode(), then traverse the LinkedList using equals() until finding the expected element.</p>

<ul>
<li>HashMap</li>
<li>HashSet: backed by HashMap, just the element is the key of <code>Entry&amp;lt;K,V&amp;gt; while the value is ignored.</code>
<strong>with insertion order</strong></li>
</ul>

<p>maintain the insertion order using an extra LinkedList</p>

<ul>
<li>LinkedHashSet</li>

<li><p>LinkedHashMap: as above
<strong>special map</strong></p></li>

<li><p>IdentityHashMap: compare the key using == instead of equals()</p></li>

<li><p>WeekHashMap: key is week reference</p></li>
</ul>

<pre><code class="language-java">public void test() {
    Map map = new IdentityHashMap();

    String a = new String(&quot;aa&quot;);
    String b = new String(&quot;aa&quot;);

    map.put(a, 1);
    map.put(b, 2);

    System.out.println(a == b); //false
    System.out.println(a.equals(b)); //true

    System.out.println(map.get(a)); //1
    System.out.println(map.get(b)); //2

}
</code></pre>

<h4 id="immutable-hash-key">immutable, hash key</h4>

<h4 id="capacity-load-factor-and-rehash">capacity, load factor and rehash</h4>

<h3 id="collections-arrays">Collections, Arrays</h3>

<h4 id="static-factory">static factory</h4>

<ul>
<li>Arrays.asList(..)</li>
<li>Collections.singleton(..) / singletonList(..) / singletonMap(..)</li>
<li>Collections.emptySet/ emptyList(..)  / emptyMap(..) / emptyOrderedMap(..)</li>
<li>Collections.checkedSet(..) / checkedList(..) / checkedMap(..)</li>
<li>Collections.<code>nCopies</code>(..)</li>
</ul>

<h4 id="sort-search">sort / search</h4>

<ul>
<li>sort(..) / sort(.., Comparator)</li>
<li>binarySearch(..) / binarySearch(.., Comparator)</li>
</ul>

<h4 id="unmodifiedxx">unmodifiedXX()</h4>

<h4 id="other-common-operations">other common operations</h4>

<ul>
<li>shuffle(..)</li>
<li>reverse(..)</li>
<li>rotate(.., distance)</li>
<li>fill(..)</li>
<li>swap(..)</li>
<li>copy(..)</li>
<li>replaceAll(..)</li>
<li>indexOfSubList(..)</li>
<li>min(..) / max(..)</li>
<li>disjoint(..)</li>
<li>frequency(..)</li>
</ul>

<h4 id="a-comparator">a comparator</h4>

<ul>
<li>reverseOrder(..)</li>
</ul>

<h3 id="concurrent-collection">concurrent collection</h3>

<h4 id="fail-fast-mechanism-concurrentmodificationexception-and-iterator">fail-fast mechanism, ConcurrentModificationException and Iterator</h4>

<p>Java collections use fail-fast mechanism to prevent multiple threads to modify the collection when traversing it. Even there is only one thread, you modify the collection when you traverse it in the single thread, fail-fast will also be applied.</p>

<p>That will case ConcurrentModificationException.</p>

<p>Using Interator.remove(..) method will avoid this.</p>

<h4 id="sychronizedxx-juc-collections">sychronizedXX(), JUC collections</h4>

<p>sychronizedXX() makes every method wrapped in a <code>synchronized</code> block. So the efficiency is a big problem.
<table style="height: 182px;" border="1" width="522">
<tbody>
<tr>
<td><strong>not thread-safe collections</strong></td>
<td><strong>thread-safe collections</strong></td>
</tr>
<tr>
<td>ArrayList</td>
<td>CopyOnWriteArrayList</td>
</tr>
<tr>
<td>HashSet</td>
<td>CopyOnWriteArraySet</td>
</tr>
<tr>
<td>LinkedList</td>
<td>ConcurrentLinkedQueue</td>
</tr>
<tr>
<td>HashMap</td>
<td>ConcurrentHashMap</td>
</tr>
<tr>
<td>TreeMap</td>
<td>ConcurrentSkipListMap</td>
</tr>
<tr>
<td>TreeSet</td>
<td>ConcurrentSkipListSet</td>
</tr>
</tbody>
</table></p>

<ul>
<li>CopyOnWriteArrayList
This implementation always copy the backed array and set the backed array to this new one when modifying the List.</li>
</ul>

<p>The modification operations are thread-safe by using a <code>ReentrantLock</code>.</p>

<p>So it&rsquo;s suitable for the case that writing is greatly less than reading.</p>

<p>Once an interator has been gotten, it will see a <strong>snapshot</strong> of the array.</p>

<pre><code class="language-java">public void test() {
    List&amp;lt;Integer&amp;gt; list = new CopyOnWriteArrayList&amp;lt;Integer&amp;gt;(Arrays.asList(0, 1, 2, 3, 4, 5, 6, 7));

    for(int i : list) {
        if(i == 2) {
            list.add(8, 8);
        }

        System.out.println(i);
    }

    System.out.println(list);
}

0
1
2
3
4
5
6
7
[0, 1, 2, 3, 4, 5, 6, 7, 8]
</code></pre>

<p>&nbsp;</p>

<p><a href="http://www.cnblogs.com/skywang12345/p/java_threads_category.html">http://www.cnblogs.com/skywang12345/p/java_threads_category.html</a></p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

    </div>
    <footer class="post-footer">
     

     <div class="post-nav">
    <div class="post-nav-next post-nav-item">
    
        <a href="http://yangchao.me/post/mysql-innodb-locking-and-isolation-level/" rel="next" title="MySQL InnoDB Locking and Isolation Level">
        <i class="fa fa-chevron-left"></i> MySQL InnoDB Locking and Isolation Level
        </a>
    
    </div>

    <div class="post-nav-prev post-nav-item">
    
        <a href="http://yangchao.me/post/java-serialization/" rel="prev" title="Java Serialization">
        Java Serialization <i class="fa fa-chevron-right"></i>
        </a>
    
    </div>
</div>
      
     
     
     




    </footer>
  </article>
</section>

          </div>
        </div>
        <div class="sidebar-toggle">
  <div class="sidebar-toggle-line-wrap">
    <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
    <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
    <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
  </div>
</div>
<aside id="sidebar" class="sidebar">
  <div class="sidebar-inner">

  <ul class="sidebar-nav motion-element">
    <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
      Table of Content
    </li>
    <li class="sidebar-nav-overview" data-target="site-overview">
      Site Information
    </li>
  </ul>

    <section class="site-overview sidebar-panel ">
      <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
        src="http://yangchao.me/img/author.jpg"
        alt="Chao" />
    <p class="site-author-name" itemprop="name">Chao</p>
    <p class="site-description motion-element" itemprop="description"> 
        Programmer &amp; Life explorer</p>
</div>
      <nav class="site-state motion-element">
    <div class="site-state-item site-state-posts">
      <a href="http://yangchao.me/post/">
        <span class="site-state-item-count">133</span>
        <span class="site-state-item-name">Blogs</span>
      </a>
    </div>
    <div class="site-state-item site-state-categories">    
        <a href="http://yangchao.me/categories/">       
        <span class="site-state-item-count">46</span>
        <span class="site-state-item-name">Categories</span>
        </a>
    </div>

    <div class="site-state-item site-state-tags">
        <a href="http://yangchao.me/tags/">
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">Tags</span>
        </a>
    </div>
</nav>
      
      
<div class="links-of-author motion-element">
    
        <span class="links-of-author-item">
        <a href="https://github.com/richdyang" target="_blank" title="GitHub">
            <i class="fa fa-fw fa-github"></i>
            GitHub
        </a>
        </span>
    
        <span class="links-of-author-item">
        <a href="https://linkedin.com/in/richdyang" target="_blank" title="Linkedin">
            <i class="fa fa-fw fa-linkedin"></i>
            Linkedin
        </a>
        </span>
    
</div>

      
      <div class="links-of-blogroll motion-element inline">
<script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=5b4f2ucxar6&amp;m=0&amp;s=220&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=33&amp;bv=35" async="async"></script>
</div>

    </section>
    
<section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
    <div class="post-toc">
        <div class="post-toc-content"><nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#natural-ordered-structure">(natural) ordered structure</a></li>
<li><a href="#hash-structure">hash structure</a>
<ul>
<li><a href="#immutable-hash-key">immutable, hash key</a></li>
<li><a href="#capacity-load-factor-and-rehash">capacity, load factor and rehash</a></li>
</ul></li>
<li><a href="#collections-arrays">Collections, Arrays</a>
<ul>
<li><a href="#static-factory">static factory</a></li>
<li><a href="#sort-search">sort / search</a></li>
<li><a href="#unmodifiedxx">unmodifiedXX()</a></li>
<li><a href="#other-common-operations">other common operations</a></li>
<li><a href="#a-comparator">a comparator</a></li>
</ul></li>
<li><a href="#concurrent-collection">concurrent collection</a>
<ul>
<li><a href="#fail-fast-mechanism-concurrentmodificationexception-and-iterator">fail-fast mechanism, ConcurrentModificationException and Iterator</a></li>
<li><a href="#sychronizedxx-juc-collections">sychronizedXX(), JUC collections</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav></div>
    </div>
</section>

  </div>
</aside>

      </div>
    </main>
   
    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  <span itemprop="copyrightYear">  &copy; 
   - 2017</span>
  <span class="with-love"><i class="fa fa-heart"></i></span>
  <span class="author" itemprop="copyrightHolder">Chao Yang</span>
</div>
<div class="powered-by">
  Powered by - <a class="theme-link" href="http://gohugo.io" target="_blank" title="hugo" >Hugo</a>
</div>
<div class="theme-info">
  Theme by - <a class="theme-link" href="https://github.com/xtfly/hugo-theme-next" target="_blank"> NexT
  </a>
</div>


      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  <script>
    var _hmt = _hmt || [];
    (function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?0b07433b4ab8d587dae7d34e71973839";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
    })();
</script>
<script type="text/javascript" src="http://tajs.qq.com/stats?sId=58416275" charset="UTF-8"></script> 
<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
<script type="text/javascript" src="http://yangchao.me/js/vendor/jquery/index.js?v=2.1.3"></script>
<script type="text/javascript" src="http://yangchao.me/js/vendor/fastclick/lib/fastclick.min.js?v=1.0.6"></script> 
<script type="text/javascript" src="http://yangchao.me/js/vendor/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
<script type="text/javascript" src="http://yangchao.me/js/vendor/velocity/velocity.min.js?v=1.2.1"></script>
<script type="text/javascript" src="http://yangchao.me/js/vendor/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="http://yangchao.me/js/vendor/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>

<script src="http://yangchao.me/js/vendor/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>

<script type="text/javascript" src="http://yangchao.me/js/utils.js"></script>
<script type="text/javascript" src="http://yangchao.me/js/motion.js"></script>
<script type="text/javascript" src="http://yangchao.me/js/affix.js"></script>
<script type="text/javascript" src="http://yangchao.me/js/schemes/pisces.js"></script>

<script type="text/javascript" src="http://yangchao.me/js/scrollspy.js"></script>
<script type="text/javascript" src="http://yangchao.me/js/post-details.js"></script>
<script type="text/javascript" src="http://yangchao.me/js/toc.js"></script>

<script type="text/javascript" src="http://yangchao.me/js/bootstrap.js"></script>

</body>
</html>